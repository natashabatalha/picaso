

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Creating Custom Opacity Database &mdash; picaso 4.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=9edc463e" />
      <link rel="stylesheet" type="text/css" href="../../_static/nbsphinx-code-cells.css?v=2aa19091" />

  
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=9f5556dd"></script>
      <script src="../../_static/doctools.js?v=fd6eb6e6"></script>
      <script src="../../_static/sphinx_highlight.js?v=6ffebe34"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@4/tex-mml-chtml.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="What Resampling Do I Need for My Data??" href="3_ResamplingOpacities.html" />
    <link rel="prev" title="Querying Opacities" href="1_QueryOpacities.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            picaso
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html#reference-data">Reference Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html#using-quickstart-notebook">Using Quickstart Notebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebook_workflow.html">Tutorial Workflow</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../tutorials.html">The Tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../tutorials.html#getting-data-and-setting-up-environments-after-installation">Getting Data and Setting up Environments after Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials.html#basics-of-spectral-modeling">Basics of Spectral Modeling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials.html#chemistry">Chemistry</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials.html#clouds">Clouds</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials.html#d-climate-modeling">1D Climate Modeling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials.html#d-spectra-and-phase-curves">3D Spectra and Phase Curves</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials.html#fitting-models-to-data">Fitting models to data</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../tutorials.html#opacities">Opacities</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="1_QueryOpacities.html">Query Opacites</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Opacity Factory: Creating Custom Databases</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#First-Define-Database-Specs-(min,-max-wavelength,-R)">First Define Database Specs (min, max wavelength, R)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Data-Formats">Data Formats</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Step-1:-Build-New-Database">Step 1: Build New Database</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Step-2:-Insert-Molecular-opacity">Step 2: Insert Molecular opacity</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Step-3)-Insert-Continuum-Opacity">Step 3) Insert Continuum Opacity</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="3_ResamplingOpacities.html">What Resampling do I Need?</a></li>
<li class="toctree-l3"><a class="reference internal" href="4_CorrelatedKTables.html">Using Correlated-K Tables</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials.html#radiative-transfer-techniques">Radiative Transfer Techniques</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials.html#useful-tools">Useful Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials.html#references">References</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../picaso.html">The Code</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contribution.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../workshops.html">Workshop Material</a></li>
<li class="toctree-l1"><a class="reference external" href="https://natashabatalha.github.io/picaso_dev">The Derivations</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/natashabatalha/picaso">Github</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../credit.html">What to Cite</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">picaso</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../tutorials.html">Tutorials</a></li>
      <li class="breadcrumb-item active">Creating Custom Opacity Database</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/notebooks/G_opacities/2_CreatingOpacityDb.py.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference external" href="https://github.com/natashabatalha/picaso/tree/master/docs/notebooks/G_opacities/2_CreatingOpacityDb.py">Download full notebook here</a></p>
</div>
<section id="Creating-Custom-Opacity-Database">
<h1>Creating Custom Opacity Database<a class="headerlink" href="#Creating-Custom-Opacity-Database" title="Link to this heading"></a></h1>
<p>In this notebook we will take users through how to compute an opacity database file using the full high resolution 1460 opacity grid.</p>
<p>Roxana Lupu has posted a version of this 1460 grid online on Zenodo: <a class="reference external" href="https://zenodo.org/record/6600976#.YtcFguzMI6E">https://zenodo.org/record/6600976#.YtcFguzMI6E</a></p>
<p>Roxana’s file at 1 <span class="math notranslate nohighlight">\(\mu\)</span>m is R~100k. This makes it suitable for data up to R~10K at 1 <span class="math notranslate nohighlight">\(\mu\)</span>m.</p>
<p>Coming soon, we will also be posting original LBL calculations via the MAESTRO collaboration on a MAESTRO Zenodo community and NASA hosted website.</p>
<p>In the meantime, please contact the developers for access to certain raw data.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">picaso.opacity_factory</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">opa_fac</span><span class="c1">#</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
</pre></div>
</div>
</div>
<section id="First-Define-Database-Specs-(min,-max-wavelength,-R)">
<h2>First Define Database Specs (min, max wavelength, R)<a class="headerlink" href="#First-Define-Database-Specs-(min,-max-wavelength,-R)" title="Link to this heading"></a></h2>
<p>Opacities are computed “line-by-line” (LBL) grids that are R~1e6 across a wide wavelength range (e.g. 0.3-300um). In order to make our calculations computationally feasible, we need to create databases that are a resampled subset of this full calculation.</p>
<p><strong>CAUTIONS regarding resampling</strong>: when you resample an opacity database you must resample to <strong>at least 100x higher than your expected data</strong>. For example:</p>
<p>My data is at R=100… I will need to resample to R=10000</p>
<p>My data is at R=3000… I will need to resample to R=300000</p>
<p>If you want a native line-by-line calculations you don’t need to resample. In this case you just make sure that <code class="docutils literal notranslate"><span class="pre">oldR</span></code>=<code class="docutils literal notranslate"><span class="pre">newR</span></code>.</p>
<p>The general procedure of the opacity factory is:</p>
<ol class="arabic simple">
<li><p>Interpolate the given opacity bundle to a common wavelength solution that is comparable R (<code class="docutils literal notranslate"><span class="pre">oldR</span></code> below) to the original LBL calculation</p></li>
<li><p>Resample the opacity accordingly to <code class="docutils literal notranslate"><span class="pre">newR</span></code>. For example, if <code class="docutils literal notranslate"><span class="pre">oldR</span></code>=1e6 and <code class="docutils literal notranslate"><span class="pre">newR</span></code>=1e4, then every 100th point is taken for the final opacity spectrum</p></li>
<li><p>Insert that resampled opacity to the database</p></li>
</ol>
<section id="Things-to-consider-when-choosing-minw,-maxw,-and-R">
<h3>Things to consider when choosing minw, maxw, and R<a class="headerlink" href="#Things-to-consider-when-choosing-minw,-maxw,-and-R" title="Link to this heading"></a></h3>
<p>Here are some typical file sizes to guide your choosing:</p>
<ol class="arabic simple">
<li><p>43G : all_opacities_0.3_15_R50000.db</p></li>
<li><p>28G : all_opacities_0.3_3_R30000.db</p></li>
<li><p>12G : all_opacities_0.3_5.3_R10000.db</p></li>
<li><p>565G : all_opacities_0,3_5,3_R500k.db</p></li>
<li><p>4.1G : all_opacities_5_14_R10000.db</p></li>
</ol>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#this is where your opacity file should be located if you&#39;ve set your environments correctly</span>
<span class="n">min_wavelength</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">max_wavelength</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">old_R</span><span class="o">=</span><span class="mf">1e6</span> <span class="c1">#this should be near the value of the LBL calculations</span>
<span class="c1">#the routine works by first interpolating the LBL calculations uniformly to this opacity</span>
<span class="c1">#then they are resampled to the new resolution requested by the user</span>

<span class="c1">#what molecules would you like to include</span>
<span class="c1">#Lupu et als set set includes</span>
<span class="c1">#C2H2, C2H4, C2H6, CH4, CO, CO2, CrH, Fe,</span>
<span class="c1">#FeH, H2, H3+, H2O, H2S, HCN, LiCl,</span>
<span class="c1">#LiF, LiH, MgH, N2, NH3, OCS, PH3, SiO,</span>
<span class="c1">#TiO, and VO, in addition to alkali metals (Li, Na, K, Rb, Cs)</span>

<span class="c1">#let&#39;s choose a subset of these for purposes of demonstration (note I usually include</span>
<span class="c1">#as many as are available)</span>
<span class="n">molecules_1460</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;CH4&#39;</span><span class="p">,</span> <span class="s1">&#39;CO2&#39;</span> <span class="p">,</span> <span class="s1">&#39;H2O&#39;</span> <span class="p">,</span>  <span class="s1">&#39;CO&#39;</span>  <span class="p">,</span><span class="s1">&#39;H2&#39;</span> <span class="p">,</span><span class="s1">&#39;Na&#39;</span><span class="p">,</span><span class="s1">&#39;K&#39;</span><span class="p">]</span>
<br/><br/></pre></div>
</div>
</div>
<p>There are a three additional opacities files that are used to compute the spectral database:</p>
<ul class="simple">
<li><p>Optical CH4: Cool optical CH4 is still missing from state of the art CH4 calculations. <a class="reference external" href="https://www.sciencedirect.com/science/article/abs/pii/S0019103598959139">Therefore we have to “stitch in” optical CH4 at cool temperatures from Karkoschka</a></p></li>
<li><p>Optical O3: similar to CH4, we have to stitch in the famous O3 band needed to compute Earth like planets</p></li>
<li><p>Continuum induced absorption (e.g. H2-H2, H2-He, H2-N2, H2-CH4)</p></li>
</ul>
<p>In addition to these continuum sources, the PICASO opacity factory also adds in:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/natashabatalha/picaso/blob/af8dfef83f507c27d947c93c6d09a8a87c040b98/picaso/opacity_factory.py#L253">H2-</a></p></li>
<li><p><a class="reference external" href="https://github.com/natashabatalha/picaso/blob/af8dfef83f507c27d947c93c6d09a8a87c040b98/picaso/opacity_factory.py#L292">H-bf</a></p></li>
<li><p><a class="reference external" href="https://github.com/natashabatalha/picaso/blob/af8dfef83f507c27d947c93c6d09a8a87c040b98/picaso/opacity_factory.py#L321">H-ff</a></p></li>
</ul>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#additional files, if needed</span>
<span class="c1">#these are located in the picaso_refdata folder</span>
<span class="n">dir_extras</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;picaso_refdata&#39;</span><span class="p">],</span><span class="s1">&#39;opacities&#39;</span><span class="p">)</span>

<span class="n">original_continuum</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_extras</span><span class="p">,</span><span class="s1">&#39;CIA_DS_aug_2015.dat&#39;</span><span class="p">)</span>
<span class="n">dir_kark</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_extras</span><span class="p">,</span><span class="s1">&#39;KarkCH4TempDependent.csv&#39;</span><span class="p">)</span>
<span class="n">dir_o3</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_extras</span><span class="p">,</span><span class="s1">&#39;O3_visible.txt&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
</section>
<section id="Data-Formats">
<h2>Data Formats<a class="headerlink" href="#Data-Formats" title="Link to this heading"></a></h2>
<p>There are only specific file formats that <code class="docutils literal notranslate"><span class="pre">opacity_factory</span></code> will read from. If you would like to be added to the list please contact the developers.</p>
<ol class="arabic simple">
<li><p>p_1, p_2, p_3 file formats from legacy Richard Freedman calculations</p></li>
<li><p><a class="reference external" href="https://zenodo.org/record/4458189#.Ytc6R-zMLvU">.npy file formats from Ehsan Gharib-Nezhad</a></p></li>
<li><p>Roxana Lupu .txt file formats</p></li>
</ol>
<section id="Directory-Assumption-Requirement">
<h3>Directory Assumption Requirement<a class="headerlink" href="#Directory-Assumption-Requirement" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>folder name needs to be the same as the molecule name (e.g. H2O/ would have all the opacity defined above in the molecule_1460 variable name</p></li>
</ul>
<p>For example, if each individual opacity file is <code class="docutils literal notranslate"><span class="pre">p_1</span></code>:</p>
<p><code class="docutils literal notranslate"><span class="pre">/data/weighted_cxs_1460/</span></code></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>|--&gt; H2O/
|----|--&gt; p_1
|----|--&gt; p_2
|----|--&gt; p_3
.....
|----|--&gt; p_N
|--&gt; CH4/
|----|--&gt; p_1
|----|--&gt; p_2
|----|--&gt; p_3
.....
|----|--&gt; p_N
|--&gt; NO2/
</pre></div>
</div>
</section>
<section id="For-alkalis">
<h3>For alkalis<a class="headerlink" href="#For-alkalis" title="Link to this heading"></a></h3>
<p>Historically the alkalis have come in different formats. Possible inputs for <code class="docutils literal notranslate"><span class="pre">alkali_dir</span></code> below:</p>
<ul class="simple">
<li><p>For Roxana’s Files from Zenodo: set alkalis_dir to <code class="docutils literal notranslate"><span class="pre">individual_file</span></code>, which will use the alkali name. E.g., will look for “Na” in the “Na” folder</p></li>
<li><p>For Natasha’s processed alkalis file: use <code class="docutils literal notranslate"><span class="pre">alkali</span></code> or point to the directory of the alkali folder</p></li>
</ul>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#original directory of the 1460 grid</span>
<span class="c1">#for Lupu files remember to unzip!!</span>
<span class="n">og_directory</span> <span class="o">=</span><span class="s2">&quot;/data/lupu&quot;</span>
<span class="c1">#og_directory=&#39;/data/weighted_cxs_1460/&#39;</span>
<span class="c1">#alkalis_dir = &#39;/data/weighted_cxs_1460/alkalis&#39;#this is technically the default (a folder called alkalis in og_directory) but if your alkalis are located somewhere else you can specify the full path and add it below</span>
<span class="n">alkalis_dir</span> <span class="o">=</span> <span class="s1">&#39;individual_file&#39;</span>
</pre></div>
</div>
</div>
</section>
</section>
<section id="Step-1:-Build-New-Database">
<h2>Step 1: Build New Database<a class="headerlink" href="#Step-1:-Build-New-Database" title="Link to this heading"></a></h2>
<p>Note: Do not run if you want to insert to existing database</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">opa_fac</span><span class="o">.</span><span class="n">build_skeleton</span><span class="p">(</span><span class="s1">&#39;/data/picaso_dbs/test.db&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Step-2:-Insert-Molecular-opacity">
<h2>Step 2: Insert Molecular opacity<a class="headerlink" href="#Step-2:-Insert-Molecular-opacity" title="Link to this heading"></a></h2>
<section id="Option-1:-my-data-is-low-resolution-R&lt;100">
<h3>Option 1: my data is low resolution R&lt;100<a class="headerlink" href="#Option-1:-my-data-is-low-resolution-R<100" title="Link to this heading"></a></h3>
<p>If your data is at low resolution then you can proceed with what is below by resampling the Lupu files to a lower resolution (R=10k)</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">newR</span><span class="o">=</span><span class="mi">10000</span>
<span class="c1">#new database name</span>
<span class="n">new_db</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/data/picaso_dbs/lupu_</span><span class="si">{</span><span class="n">min_wavelength</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="n">max_wavelength</span><span class="si">}</span><span class="s1">_R</span><span class="si">{</span><span class="n">newR</span><span class="si">}</span><span class="s1">.db&#39;</span>
<span class="n">opa_fac</span><span class="o">.</span><span class="n">build_skeleton</span><span class="p">(</span><span class="n">new_db</span><span class="p">)</span>
<span class="k">for</span> <span class="n">molecule</span> <span class="ow">in</span> <span class="n">molecules_1460</span><span class="p">:</span><span class="c1">#molecules_1460:</span>
    <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Inserting: &#39;</span><span class="o">+</span><span class="n">molecule</span><span class="p">)</span>
    <span class="n">new_waveno_grid</span> <span class="o">=</span> <span class="n">opa_fac</span><span class="o">.</span><span class="n">insert_molecular_1460</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="n">min_wavelength</span><span class="p">,</span> <span class="n">max_wavelength</span><span class="p">,</span> <span class="n">og_directory</span><span class="p">,</span> <span class="n">new_db</span><span class="p">,</span>
                                                    <span class="c1">#SEE CHOICE HERE!!!!</span>
                                                    <span class="n">new_R</span><span class="o">=</span><span class="n">newR</span><span class="p">,</span> <span class="c1">#new_dwno=new_dwno,</span>
                                                    <span class="n">alkali_dir</span><span class="o">=</span><span class="n">alkalis_dir</span><span class="p">,</span>
            <span class="n">dir_kark_ch4</span><span class="o">=</span><span class="n">dir_kark</span><span class="p">,</span> <span class="n">dir_optical_o3</span><span class="o">=</span><span class="n">dir_o3</span><span class="p">,</span> <span class="n">old_R</span><span class="o">=</span><span class="n">old_R</span><span class="p">)</span> <span class="c1">#these two parameters are used to hack in extra cross sections into the db</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">molecule</span><span class="o">+</span> <span class="s1">&#39; inserts finished in :&#39;</span> <span class="o">+</span><span class="nb">str</span><span class="p">((</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span><span class="p">)</span><span class="o">/</span><span class="mf">60.0</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39; minutes&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Inserting: CH4
CH4 inserts finished in :2.1 minutes
Inserting: CO2
CO2 inserts finished in :2.2 minutes
Inserting: H2O
H2O inserts finished in :2.1 minutes
Inserting: CO
CO inserts finished in :2.2 minutes
Inserting: H2
H2 inserts finished in :2.2 minutes
Inserting: Na
Na inserts finished in :2.1 minutes
Inserting: K
K inserts finished in :2.1 minutes
</pre></div></div>
</div>
</section>
<section id="Option-2:-my-data-is-at-high-resolution-R=10k">
<h3>Option 2: my data is at high resolution R=10k<a class="headerlink" href="#Option-2:-my-data-is-at-high-resolution-R=10k" title="Link to this heading"></a></h3>
<p>At high resolution you will need to use the Lupu files with their direct interpolated wavelength solution. This will not do any resampling and will just insert their opacity data into the picaso database.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">new_db</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/data/picaso_dbs/lupu_</span><span class="si">{</span><span class="n">min_wavelength</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="n">max_wavelength</span><span class="si">}</span><span class="s1">_OG_R.db&#39;</span>
<span class="n">opa_fac</span><span class="o">.</span><span class="n">build_skeleton</span><span class="p">(</span><span class="n">new_db</span><span class="p">)</span>
<span class="k">for</span> <span class="n">molecule</span> <span class="ow">in</span> <span class="n">molecules_1460</span><span class="p">:</span><span class="c1">#molecules_1460:</span>
    <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Inserting: &#39;</span><span class="o">+</span><span class="n">molecule</span><span class="p">)</span>
    <span class="n">new_waveno_grid</span> <span class="o">=</span> <span class="n">opa_fac</span><span class="o">.</span><span class="n">insert_molecular_1460</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="n">min_wavelength</span><span class="p">,</span> <span class="n">max_wavelength</span><span class="p">,</span> <span class="n">og_directory</span><span class="p">,</span> <span class="n">new_db</span><span class="p">,</span>
                                                    <span class="c1">#SEE CHOICE HERE!!!!</span>
                                                    <span class="n">insert_direct</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                                    <span class="n">alkali_dir</span><span class="o">=</span><span class="n">alkalis_dir</span><span class="p">,</span>
            <span class="n">dir_kark_ch4</span><span class="o">=</span><span class="n">dir_kark</span><span class="p">,</span> <span class="n">dir_optical_o3</span><span class="o">=</span><span class="n">dir_o3</span><span class="p">)</span> <span class="c1">#these two parameters are used to hack in extra cross sections into the db</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">molecule</span><span class="o">+</span> <span class="s1">&#39; inserts finished in :&#39;</span> <span class="o">+</span><span class="nb">str</span><span class="p">((</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span><span class="p">)</span><span class="o">/</span><span class="mf">60.0</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39; minutes&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Inserting: CH4
CH4 inserts finished in :1.2 minutes
Inserting: CO2
CO2 inserts finished in :1.2 minutes
Inserting: H2O
H2O inserts finished in :1.1 minutes
Inserting: CO
CO inserts finished in :1.1 minutes
Inserting: H2
H2 inserts finished in :1.2 minutes
Inserting: Na
Na inserts finished in :1.2 minutes
Inserting: K
K inserts finished in :1.1 minutes
</pre></div></div>
</div>
</section>
</section>
<section id="Step-3)-Insert-Continuum-Opacity">
<h2>Step 3) Insert Continuum Opacity<a class="headerlink" href="#Step-3)-Insert-Continuum-Opacity" title="Link to this heading"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">new_waveno_grid</span> <span class="o">=</span> <span class="n">opa_fac</span><span class="o">.</span><span class="n">get_molecular</span><span class="p">(</span><span class="n">new_db</span><span class="p">,[</span><span class="n">molecules_1460</span><span class="p">[</span><span class="mi">0</span><span class="p">]],[</span><span class="mi">500</span><span class="p">],[</span><span class="mi">1</span><span class="p">])[</span><span class="s1">&#39;wavenumber&#39;</span><span class="p">]</span>

<span class="n">opa_fac</span><span class="o">.</span><span class="n">restruct_continuum</span><span class="p">(</span><span class="n">original_continuum</span><span class="p">,[</span><span class="s1">&#39;wno&#39;</span><span class="p">,</span><span class="s1">&#39;H2H2&#39;</span><span class="p">,</span><span class="s1">&#39;H2He&#39;</span><span class="p">,</span><span class="s1">&#39;H2H&#39;</span><span class="p">,</span><span class="s1">&#39;H2CH4&#39;</span><span class="p">,</span><span class="s1">&#39;H2N2&#39;</span><span class="p">]</span>
                               <span class="p">,</span><span class="n">new_waveno_grid</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                               <span class="n">new_db</span> <span class="o">=</span> <span class="n">new_db</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Continuum inserts finished in :&#39;</span> <span class="o">+</span><span class="nb">str</span><span class="p">((</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span><span class="p">)</span><span class="o">/</span><span class="mf">60.0</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39; minutes&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Continuum inserts finished in :0.1 minutes
</pre></div></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="1_QueryOpacities.html" class="btn btn-neutral float-left" title="Querying Opacities" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="3_ResamplingOpacities.html" class="btn btn-neutral float-right" title="What Resampling Do I Need for My Data??" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright .</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>