

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Photochemistry with Photochem &mdash; picaso 4.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=9edc463e" />
      <link rel="stylesheet" type="text/css" href="../../_static/nbsphinx-code-cells.css?v=2aa19091" />

  
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=9f5556dd"></script>
      <script src="../../_static/doctools.js?v=fd6eb6e6"></script>
      <script src="../../_static/sphinx_highlight.js?v=6ffebe34"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@4/tex-mml-chtml.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="How clouds affect albedo spectroscopy" href="../C_clouds/1_PairingPICASOToVIRGA.html" />
    <link rel="prev" title="Adding your Own Chemistry in PICASO" href="1_ChemicalEquilibrium.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            picaso
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html#reference-data">Reference Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html#using-quickstart-notebook">Using Quickstart Notebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebook_workflow.html">Tutorial Workflow</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../tutorials.html">The Tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../tutorials.html#getting-data-and-setting-up-environments-after-installation">Getting Data and Setting up Environments after Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials.html#basics-of-spectral-modeling">Basics of Spectral Modeling</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../tutorials.html#chemistry">Chemistry</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="1_ChemicalEquilibrium.html">Adding your Own Chemistry in PICASO</a></li>
<li class="toctree-l3"><a class="reference internal" href="1_ChemicalEquilibrium.html#Comparing-Other-Ways-to-get-Chemical-Equilibrium-incl-w/-Disequilibrium-Hacks">Comparing Other Ways to get Chemical Equilibrium incl w/ Disequilibrium Hacks</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Full Kinetics/Photochemistry</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Installing-Photochem">Installing Photochem</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Choosing-a-UV-stellar-spectrum">Choosing a UV stellar spectrum</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Choosing-a-reaction-network">Choosing a reaction network</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Initializing-the-photochemical-model">Initializing the photochemical model</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Integrating-the-photochemistry-to-a-steady-state">Integrating the photochemistry to a steady-state</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Computing-the-transmission-spectrum-with-Picaso">Computing the transmission spectrum with Picaso</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials.html#clouds">Clouds</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials.html#d-climate-modeling">1D Climate Modeling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials.html#d-spectra-and-phase-curves">3D Spectra and Phase Curves</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials.html#fitting-models-to-data">Fitting models to data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials.html#opacities">Opacities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials.html#radiative-transfer-techniques">Radiative Transfer Techniques</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials.html#useful-tools">Useful Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials.html#references">References</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../picaso.html">The Code</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contribution.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../workshops.html">Workshop Material</a></li>
<li class="toctree-l1"><a class="reference external" href="https://natashabatalha.github.io/picaso_dev">The Derivations</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/natashabatalha/picaso">Github</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../credit.html">What to Cite</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">picaso</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../tutorials.html">Tutorials</a></li>
      <li class="breadcrumb-item active">Photochemistry with Photochem</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/notebooks/B_chemistry/2_Photochemistry.py.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference external" href="https://github.com/natashabatalha/picaso/tree/master/docs/notebooks/B_chemistry/2_Photochemistry.py">Download full notebook here</a></p>
</div>
<section id="Photochemistry-with-Photochem">
<h1>Photochemistry with Photochem<a class="headerlink" href="#Photochemistry-with-Photochem" title="Link to this heading"></a></h1>
<p>Gas-rich exoplanets (e.g., warm Jupiters or mini-Neptunes) often have an atmospheric composition that is out of chemical equilibrium. As gases mix from high pressures and temperature to the cooler upper atmosphere, reactions slow and can ultimately stop, failing to maintain equilibrium. Also, UV photolysis and subsequent chemical reactions can also drive disequilibrium chemistry.</p>
<p>In this tutorial you will learn the basics of simulating disequilibrium chemistry in a gas-rich exoplanet’s atmosphere with the <a class="reference external" href="https://github.com/Nicholaswogan/photochem">Photochem</a> code (<a class="reference external" href="https://doi.org/10.3847/PSJ/aced83">Wogan et al. 2023</a>). Specifically, this tutorial broadly reproduces the photochemical SO<span class="math notranslate nohighlight">\(_2\)</span> in WASP-39b’s atmosphere as described in <a class="reference external" href="https://doi.org/10.1038/s41586-023-05902-2">Tsai et al. (2023)</a> and computes the resulting transmission spectrum with
Picaso.</p>
<!--

For example, at depth in a gas-rich atmosphere (e.g., 1000 bar), the atmosphere is often hot and chemical reactions are fast, enforcing chemical equilibrium. But, as gases mix upward, chemical reactions can slow, and ultimately stop "freezing-out"


`Photochem` captures disequilibrium effects by tracking hundreds of elementary chemical reactions like,



$$\mathrm{H_2} + \mathrm{OH} \leftrightarrow \mathrm{H_2O} + \mathrm{H}$$

Each reaction has a rate constant derived experimentally or from Ab initio calculations that can depend on temperature and pressure. Reactions are often faster with increased temperature and pressure. In `Photochem`, all reactions (except photolysis reactions) are reversed using thermodynamic principles. This means that the chemical network will predict chemical equilibrium at high temperatures and pressures, and deviate from equilibrium at cooler temperatures and when UV photolysis is important. UV photons from a host star can split molecules apart (e.g., $\mathrm{H_2O} + h\nu \rightarrow \mathrm{OH} + \mathrm{H}$) in the upper atmosphere, and ultimately drive further chemistry. --><div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="mi">13</span><span class="p">})</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">IPython.display</span><span class="w"> </span><span class="kn">import</span> <span class="n">clear_output</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">astropy</span><span class="w"> </span><span class="kn">import</span> <span class="n">constants</span>

<span class="k">class</span><span class="w"> </span><span class="nc">WASP39b</span><span class="p">:</span>
    <span class="n">planet_radius</span> <span class="o">=</span> <span class="mf">1.279</span> <span class="c1"># Jupiter radii</span>
    <span class="n">planet_mass</span> <span class="o">=</span> <span class="mf">0.28</span> <span class="c1"># Jupiter masses</span>
    <span class="n">planet_Teq</span> <span class="o">=</span> <span class="mi">1166</span> <span class="c1"># Equilibrium temp (K)</span>
    <span class="n">stellar_radius</span> <span class="o">=</span> <span class="mf">0.932</span> <span class="c1"># Solar radii</span>
    <span class="n">stellar_Teff</span> <span class="o">=</span> <span class="mi">5400</span> <span class="c1"># K</span>
    <span class="n">stellar_metal</span> <span class="o">=</span> <span class="mf">0.01</span> <span class="c1"># log10(metallicity)</span>
    <span class="n">stellar_logg</span> <span class="o">=</span> <span class="mf">4.45</span> <span class="c1"># log10(gravity), in cgs units</span>
</pre></div>
</div>
</div>
<section id="Installing-Photochem">
<h2>Installing Photochem<a class="headerlink" href="#Installing-Photochem" title="Link to this heading"></a></h2>
<p>For this tutorial to work, you must install Photochem with conda: <code class="docutils literal notranslate"><span class="pre">conda</span> <span class="pre">install</span> <span class="pre">-c</span> <span class="pre">conda-forge</span> <span class="pre">photochem=0.6.7</span></code></p>
</section>
<section id="Choosing-a-UV-stellar-spectrum">
<h2>Choosing a UV stellar spectrum<a class="headerlink" href="#Choosing-a-UV-stellar-spectrum" title="Link to this heading"></a></h2>
<p>To run <code class="docutils literal notranslate"><span class="pre">photochem</span></code>, we need a stellar spectrum that includes the UV. For other spectral applications, Picaso often makes use of the “phoenix” or “ck04models” stellar models. But neither of these stellar spectra characterize the UV. The best alternative is the <a class="reference external" href="https://archive.stsci.edu/prepds/muscles/">MUSCLES</a> database of spectra. Photochem has some utilities for downloading MUSCLES spectra:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">photochem.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">stars</span>

<span class="n">stars</span><span class="o">.</span><span class="n">print_muscles_stars</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
GJ1132: {st_logg: 5.04, st_met: -0.17, st_rad: 0.22, st_teff: 3229.0}
GJ1214: {st_logg: 5.03, st_met: 0.24, st_rad: 0.22, st_teff: 3101.0}
GJ15A: {st_logg: 4.89, st_met: -0.391, st_rad: 0.38, st_teff: 3742.67}
GJ163: {st_logg: 4.82, st_met: 0.1, st_rad: 0.41, st_teff: 3399.0}
GJ176: {st_logg: 4.78, st_met: 0.147, st_rad: 0.48, st_teff: 3703.49}
GJ436: {st_logg: 4.84, st_met: 0.099, st_rad: 0.42, st_teff: 3586.11}
GJ551: {st_logg: 5.16, st_met: null, st_rad: 0.14, st_teff: 2900.0}
GJ581: {st_logg: 4.94, st_met: -0.088, st_rad: 0.32, st_teff: 3490.39}
GJ649: {st_logg: 4.76, st_met: -0.15, st_rad: 0.5, st_teff: 3734.0}
GJ667C: {st_logg: 4.69, st_met: -0.55, st_rad: null, st_teff: 3650.0}
GJ674: {st_logg: 4.86, st_met: -0.28, st_rad: 0.36, st_teff: 3451.0}
GJ676A: {st_logg: 4.62, st_met: 0.08, st_rad: 0.69, st_teff: 3734.0}
GJ699: {st_logg: 4.9, st_met: -0.56, st_rad: 0.18, st_teff: 3195.0}
GJ729: {st_logg: null, st_met: null, st_rad: null, st_teff: 3240.0}
GJ832: {st_logg: 4.7, st_met: -0.7, st_rad: 0.48, st_teff: 3657.0}
GJ849: {st_logg: 4.8, st_met: 0.09, st_rad: 0.45, st_teff: 3467.0}
GJ876: {st_logg: 4.87, st_met: 0.213, st_rad: 0.37, st_teff: 3293.74}
HAT-P-12: {st_logg: 4.61, st_met: -0.063, st_rad: 0.7, st_teff: 4652.87}
HAT-P-26: {st_logg: 4.5, st_met: 0.028, st_rad: 0.86, st_teff: 5061.9}
HD-149026: {st_logg: 4.17, st_met: 0.33, st_rad: 1.46, st_teff: 6084.0}
HD40307: {st_logg: 4.63, st_met: -0.323, st_rad: 0.72, st_teff: 4867.44}
HD85512: {st_logg: null, st_met: null, st_rad: null, st_teff: 4455.0}
L-678-39: {st_logg: 4.94, st_met: -0.12, st_rad: 0.34, st_teff: 3505.0}
L-98-59: {st_logg: 4.86, st_met: -0.46, st_rad: 0.3, st_teff: 3415.0}
L-980-5: {st_logg: null, st_met: null, st_rad: null, st_teff: 3278.0}
LHS-2686: {st_logg: null, st_met: null, st_rad: null, st_teff: 3220.0}
LP-791-18: {st_logg: 5.12, st_met: -0.09, st_rad: 0.18, st_teff: 2960.0}
TOI-193: {st_logg: 4.47, st_met: 0.25, st_rad: 0.95, st_teff: 5480.0}
TRAPPIST-1: {st_logg: 5.24, st_met: 0.053, st_rad: 0.12, st_teff: 2566.0}
V-EPS-ERI: {st_logg: 4.59, st_met: -0.044, st_rad: 0.76, st_teff: 5020.38}
WASP-127: {st_logg: 4.2, st_met: -0.193, st_rad: 1.35, st_teff: 5828.01}
WASP-17: {st_logg: 4.18, st_met: -0.07, st_rad: 1.57, st_teff: 6548.0}
WASP-43: {st_logg: 4.5, st_met: -0.01, st_rad: 0.65, st_teff: 4500.0}
WASP-77A: {st_logg: 4.48, st_met: -0.1, st_rad: 0.91, st_teff: 5617.0}

</pre></div></div>
</div>
<p>TOI-193 appears to have the closest effective temperature to WASP-39, so we will use it’s spectrum. The cell below downloads the spectrum from MUSCLES, rescales the spectrum so it has the bolometric flux appropriate for WASP-39b, then saves it to a file format that photochem will later read.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wv</span><span class="p">,</span> <span class="n">F</span> <span class="o">=</span> <span class="n">stars</span><span class="o">.</span><span class="n">muscles_spectrum</span><span class="p">(</span>
    <span class="s1">&#39;TOI-193&#39;</span><span class="p">,</span>
    <span class="n">outputfile</span><span class="o">=</span><span class="s1">&#39;TOI-193.txt&#39;</span><span class="p">,</span>
    <span class="n">Teq</span><span class="o">=</span><span class="n">WASP39b</span><span class="o">.</span><span class="n">planet_Teq</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Downloading the spectrum at the following URL: https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HLSP/muscles/v23-v24/toi-193/hlsp_muscles_multi_multi_toi-193_broadband_v24_adapt-const-res-sed.fits
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>

<span class="c1"># Plot the spectrum</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">wv</span><span class="p">,</span> <span class="n">F</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;TOI-193 (MUSCLES)&#39;</span><span class="p">)</span>

<span class="c1"># Phoenix spectrum</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">stsynphot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sts</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">astropy.units</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">u</span>
<span class="n">ST_SS</span> <span class="o">=</span> <span class="n">sts</span><span class="o">.</span><span class="n">grid_to_spec</span><span class="p">(</span><span class="s1">&#39;phoenix&#39;</span><span class="p">,</span> <span class="mi">5480</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">4.47</span><span class="p">)</span>
<span class="n">wave_star</span> <span class="o">=</span> <span class="p">(</span><span class="n">ST_SS</span><span class="o">.</span><span class="n">waveset</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">nm</span><span class="p">)</span><span class="o">.</span><span class="n">value</span>
<span class="n">flux_star</span> <span class="o">=</span> <span class="n">ST_SS</span><span class="p">(</span><span class="n">ST_SS</span><span class="o">.</span><span class="n">waveset</span><span class="p">,</span><span class="n">flux_unit</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">Unit</span><span class="p">(</span><span class="s1">&#39;erg*cm^(-2)*s^(-1)*AA^(-1)&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">value</span>

<span class="n">factor</span> <span class="o">=</span> <span class="n">stars</span><span class="o">.</span><span class="n">equilibrium_temperature_inverse</span><span class="p">(</span><span class="n">WASP39b</span><span class="o">.</span><span class="n">planet_Teq</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span><span class="o">/</span><span class="n">stars</span><span class="o">.</span><span class="n">energy_in_spectrum</span><span class="p">(</span><span class="n">wave_star</span><span class="p">,</span> <span class="n">flux_star</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">wave_star</span><span class="p">,</span> <span class="n">flux_star</span><span class="o">*</span><span class="n">factor</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Phoenix&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Flux at planet (mW/m$^2$/nm)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Wavelength (nm)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mf">1e-3</span><span class="p">,</span><span class="mf">2e6</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_B_chemistry_2_Photochemistry_6_0.png" src="../../_images/notebooks_B_chemistry_2_Photochemistry_6_0.png" />
</div>
</div>
<p>The plot above clearly shows how the phoenix model fails to capture the UV.</p>
</section>
<section id="Choosing-a-reaction-network">
<h2>Choosing a reaction network<a class="headerlink" href="#Choosing-a-reaction-network" title="Link to this heading"></a></h2>
<p>To run photochem, we also need a network of chemical reactions and thermodynamic data. We can accomplish this with the function <code class="docutils literal notranslate"><span class="pre">zahnle_rx_and_thermo_files</span></code>, which starts with the main reaction file shipped with photochem and the trims out some unnecessary chemistry. Running this next cell produces two files: <code class="docutils literal notranslate"><span class="pre">photochem_rxns.yaml</span></code> for photochemistry/kinetics and <code class="docutils literal notranslate"><span class="pre">photochem_thermo.yaml</span></code> for equilibrium chemistry calculations.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">photochem.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">zahnle_rx_and_thermo_files</span>

<span class="n">zahnle_rx_and_thermo_files</span><span class="p">(</span>
    <span class="n">atoms_names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="s1">&#39;He&#39;</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39;O&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;S&#39;</span><span class="p">],</span> <span class="c1"># We select a subset of the atoms in zahnle_earth.yaml (leave out Cl)</span>
    <span class="n">rxns_filename</span><span class="o">=</span><span class="s1">&#39;photochem_rxns.yaml&#39;</span><span class="p">,</span>
    <span class="n">thermo_filename</span><span class="o">=</span><span class="s1">&#39;photochem_thermo.yaml&#39;</span><span class="p">,</span>
    <span class="n">remove_reaction_particles</span><span class="o">=</span><span class="kc">True</span> <span class="c1"># For gas giants, we should always leave out reaction particles.</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<p>Note, fast chemistry can sometimes slow down or prevent the photochemical model from reaching a steady state. Sulfur chemistry in particular, is often problematic, but mostly for cooler planets than WASP-39b. If you have troubles reaching convergence, then perhaps remove “S3”, “S4”, “S8”, and “S8aer”, if these species are not extremely important:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">zahnle_rx_and_thermo_files</span><span class="p">(</span>
    <span class="n">atoms_names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="s1">&#39;He&#39;</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39;O&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;S&#39;</span><span class="p">],</span>
    <span class="n">rxns_filename</span><span class="o">=</span><span class="s1">&#39;photochem_rxns.yaml&#39;</span><span class="p">,</span>
    <span class="n">thermo_filename</span><span class="o">=</span><span class="s1">&#39;photochem_thermo.yaml&#39;</span><span class="p">,</span>
    <span class="n">exclude_species</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;S3&#39;</span><span class="p">,</span><span class="s1">&#39;S4&#39;</span><span class="p">,</span><span class="s1">&#39;S8&#39;</span><span class="p">,</span><span class="s1">&#39;S8aer&#39;</span><span class="p">],</span>
    <span class="n">remove_reaction_particles</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
</pre></div>
</div>
<p>If you don’t care about sulfur species at all, then just omit “S” from <code class="docutils literal notranslate"><span class="pre">atoms_names</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">zahnle_rx_and_thermo_files</span><span class="p">(</span>
    <span class="n">atoms_names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="s1">&#39;He&#39;</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39;O&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">],</span>
    <span class="n">rxns_filename</span><span class="o">=</span><span class="s1">&#39;photochem_rxns.yaml&#39;</span><span class="p">,</span>
    <span class="n">thermo_filename</span><span class="o">=</span><span class="s1">&#39;photochem_thermo.yaml&#39;</span><span class="p">,</span>
    <span class="n">remove_reaction_particles</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
</pre></div>
</div>
<p>It is possible to use reaction networks besides the ones shipped with photochem. For example, photochem has the function <code class="docutils literal notranslate"><span class="pre">vulcan2yaml</span></code> (import with <code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">photochem.utils</span> <span class="pre">import</span> <span class="pre">vulcan2yaml</span></code>), which allows Photochem to use <a class="reference external" href="https://github.com/exoclime/VULCAN">VULCAN</a> chemical networks.</p>
</section>
<section id="Initializing-the-photochemical-model">
<h2>Initializing the photochemical model<a class="headerlink" href="#Initializing-the-photochemical-model" title="Link to this heading"></a></h2>
<p>Next, we initialize the gas giant extension to <code class="docutils literal notranslate"><span class="pre">photochem</span></code>, called <code class="docutils literal notranslate"><span class="pre">EvoAtmosphereGasGiant</span></code>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">photochem.extensions</span><span class="w"> </span><span class="kn">import</span> <span class="n">gasgiants</span>

<span class="n">pc</span> <span class="o">=</span> <span class="n">gasgiants</span><span class="o">.</span><span class="n">EvoAtmosphereGasGiant</span><span class="p">(</span>
    <span class="s1">&#39;photochem_rxns.yaml&#39;</span><span class="p">,</span>
    <span class="s1">&#39;TOI-193.txt&#39;</span><span class="p">,</span>
    <span class="n">planet_mass</span><span class="o">=</span><span class="n">WASP39b</span><span class="o">.</span><span class="n">planet_mass</span><span class="o">*</span><span class="n">constants</span><span class="o">.</span><span class="n">M_jup</span><span class="o">.</span><span class="n">cgs</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
    <span class="n">planet_radius</span><span class="o">=</span><span class="n">WASP39b</span><span class="o">.</span><span class="n">planet_radius</span><span class="o">*</span><span class="n">constants</span><span class="o">.</span><span class="n">R_jup</span><span class="o">.</span><span class="n">cgs</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
    <span class="n">solar_zenith_angle</span><span class="o">=</span><span class="mi">83</span><span class="p">,</span> <span class="c1"># Used in Tsai et al. (2023). By default, 60.</span>
    <span class="n">thermo_file</span><span class="o">=</span><span class="s1">&#39;photochem_thermo.yaml&#39;</span>
<span class="p">)</span>
<span class="n">pc</span><span class="o">.</span><span class="n">gdat</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span> <span class="c1"># No printing</span>
<span class="c1"># The diurnal averaging factor. This is normally 0.5 for a global average,</span>
<span class="c1"># but we use 1 to follow Tsai et al. (2023).</span>
<span class="n">pc</span><span class="o">.</span><span class="n">var</span><span class="o">.</span><span class="n">diurnal_fac</span> <span class="o">=</span> <span class="mf">1.0</span>
</pre></div>
</div>
</div>
<p>When modeling a gas giant, researchers often assume the planet has some composition relative to the Sun (i.e., a metallicity). The <code class="docutils literal notranslate"><span class="pre">EvoAtmosphereGasGiant</span></code> extension has a <code class="docutils literal notranslate"><span class="pre">ChemEquiAnalysis</span></code> object attached to it (<code class="docutils literal notranslate"><span class="pre">pc.gdat.gas</span></code>, see <code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">photochem.equilibrate</span> <span class="pre">import</span> <span class="pre">ChemEquiAnalysis</span></code> for details) for doing equilibrium chemistry calculations at depth in the gas giant atmosphere. This object contains an estimated composition of the Sun:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">atom</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">pc</span><span class="o">.</span><span class="n">gdat</span><span class="o">.</span><span class="n">gas</span><span class="o">.</span><span class="n">atoms_names</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> </span><span class="si">%.2e</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">atom</span><span class="p">,</span><span class="n">pc</span><span class="o">.</span><span class="n">gdat</span><span class="o">.</span><span class="n">gas</span><span class="o">.</span><span class="n">molfracs_atoms_sun</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
H 9.21e-01
N 6.23e-05
O 4.51e-04
C 2.48e-04
S 1.21e-05
He 7.84e-02
</pre></div></div>
</div>
<p>The above solar composition is very reasonable, but below we change to the exact solar composition in Tsai et al. (2023) to best reproduce their results.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">molfracs_atoms_sun</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pc</span><span class="o">.</span><span class="n">gdat</span><span class="o">.</span><span class="n">gas</span><span class="o">.</span><span class="n">atoms_names</span><span class="p">))</span><span class="o">*</span><span class="mf">1e-10</span>
<span class="n">comp</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;O&#39;</span><span class="p">:</span> <span class="mf">5.37E-4</span><span class="p">,</span>
    <span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="mf">2.95E-4</span><span class="p">,</span>
    <span class="s1">&#39;N&#39;</span><span class="p">:</span> <span class="mf">7.08E-5</span><span class="p">,</span>
    <span class="s1">&#39;S&#39;</span><span class="p">:</span> <span class="mf">1.41E-5</span><span class="p">,</span>
    <span class="s1">&#39;He&#39;</span><span class="p">:</span> <span class="mf">0.0838</span><span class="p">,</span>
    <span class="s1">&#39;H&#39;</span><span class="p">:</span> <span class="mi">1</span>
<span class="p">}</span>
<span class="n">tot</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">comp</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">comp</span><span class="p">:</span>
    <span class="n">comp</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">/=</span> <span class="n">tot</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">atom</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">pc</span><span class="o">.</span><span class="n">gdat</span><span class="o">.</span><span class="n">gas</span><span class="o">.</span><span class="n">atoms_names</span><span class="p">):</span>
    <span class="n">molfracs_atoms_sun</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">comp</span><span class="p">[</span><span class="n">atom</span><span class="p">]</span>

<span class="n">pc</span><span class="o">.</span><span class="n">gdat</span><span class="o">.</span><span class="n">gas</span><span class="o">.</span><span class="n">molfracs_atoms_sun</span> <span class="o">=</span> <span class="n">molfracs_atoms_sun</span>
</pre></div>
</div>
</div>
<p>Next, we establish several key variables</p>
<ul class="simple">
<li><p>The Pressure-Temperature profile. Here, we use the “morning” profile described in Tsai et al. (2023), computed with a GCM.</p></li>
<li><p>The <span class="math notranslate nohighlight">\(K_{zz}\)</span> profile (i.e., eddy diffusion). Here, we use the same values as Tsai et al. (2023).</p></li>
<li><p>The metallicity. Like in Tsai et al. (2023), we assume a 10x solar value.</p></li>
<li><p>The C/O ratio. Following Tsai et al. (2023), we assume the solar ratio.</p></li>
</ul>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The &quot;Morning&quot; P-T profile from a GCM in Tsai et al. (2023)</span>
<span class="n">P</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.816e+08</span><span class="p">,</span> <span class="mf">1.222e+08</span><span class="p">,</span> <span class="mf">8.216e+07</span><span class="p">,</span> <span class="mf">5.526e+07</span><span class="p">,</span> <span class="mf">3.717e+07</span><span class="p">,</span> <span class="mf">2.500e+07</span><span class="p">,</span>
       <span class="mf">1.682e+07</span><span class="p">,</span> <span class="mf">1.131e+07</span><span class="p">,</span> <span class="mf">7.607e+06</span><span class="p">,</span> <span class="mf">5.117e+06</span><span class="p">,</span> <span class="mf">3.441e+06</span><span class="p">,</span> <span class="mf">2.315e+06</span><span class="p">,</span>
       <span class="mf">1.557e+06</span><span class="p">,</span> <span class="mf">1.047e+06</span><span class="p">,</span> <span class="mf">7.044e+05</span><span class="p">,</span> <span class="mf">4.738e+05</span><span class="p">,</span> <span class="mf">3.187e+05</span><span class="p">,</span> <span class="mf">2.144e+05</span><span class="p">,</span>
       <span class="mf">1.442e+05</span><span class="p">,</span> <span class="mf">9.702e+04</span><span class="p">,</span> <span class="mf">6.527e+04</span><span class="p">,</span> <span class="mf">4.392e+04</span><span class="p">,</span> <span class="mf">2.956e+04</span><span class="p">,</span> <span class="mf">1.990e+04</span><span class="p">,</span>
       <span class="mf">1.340e+04</span><span class="p">,</span> <span class="mf">9.030e+03</span><span class="p">,</span> <span class="mf">6.089e+03</span><span class="p">,</span> <span class="mf">4.111e+03</span><span class="p">,</span> <span class="mf">2.779e+03</span><span class="p">,</span> <span class="mf">1.883e+03</span><span class="p">,</span>
       <span class="mf">1.280e+03</span><span class="p">,</span> <span class="mf">8.735e+02</span><span class="p">,</span> <span class="mf">5.995e+02</span><span class="p">,</span> <span class="mf">4.146e+02</span><span class="p">,</span> <span class="mf">2.896e+02</span><span class="p">,</span> <span class="mf">2.050e+02</span><span class="p">,</span>
       <span class="mf">1.474e+02</span><span class="p">,</span> <span class="mf">1.081e+02</span><span class="p">,</span> <span class="mf">8.098e+01</span><span class="p">,</span> <span class="mf">6.216e+01</span><span class="p">,</span> <span class="mf">4.889e+01</span><span class="p">,</span> <span class="mf">3.935e+01</span><span class="p">,</span>
       <span class="mf">3.233e+01</span><span class="p">,</span> <span class="mf">2.700e+01</span><span class="p">,</span> <span class="mf">2.281e+01</span><span class="p">,</span> <span class="mf">1.939e+01</span><span class="p">,</span> <span class="mf">1.648e+01</span><span class="p">,</span> <span class="mf">1.392e+01</span><span class="p">,</span>
       <span class="mf">1.159e+01</span><span class="p">,</span> <span class="mf">9.421e+00</span><span class="p">,</span> <span class="mf">7.352e+00</span><span class="p">,</span> <span class="mf">5.349e+00</span><span class="p">])</span> <span class="c1"># dynes/cm^2</span>
<span class="n">T</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">4503.4</span><span class="p">,</span> <span class="mf">4190.6</span><span class="p">,</span> <span class="mf">3886.</span> <span class="p">,</span> <span class="mf">3589.6</span><span class="p">,</span> <span class="mf">3302.8</span><span class="p">,</span> <span class="mf">3028.7</span><span class="p">,</span> <span class="mf">2766.</span> <span class="p">,</span> <span class="mf">2505.9</span><span class="p">,</span>
       <span class="mf">2246.5</span><span class="p">,</span> <span class="mf">2024.9</span><span class="p">,</span> <span class="mf">1853.3</span><span class="p">,</span> <span class="mf">1725.7</span><span class="p">,</span> <span class="mf">1640.7</span><span class="p">,</span> <span class="mf">1576.9</span><span class="p">,</span> <span class="mf">1518.7</span><span class="p">,</span> <span class="mf">1453.3</span><span class="p">,</span>
       <span class="mf">1385.2</span><span class="p">,</span> <span class="mf">1318.5</span><span class="p">,</span> <span class="mf">1249.</span> <span class="p">,</span> <span class="mf">1180.7</span><span class="p">,</span> <span class="mf">1117.8</span><span class="p">,</span> <span class="mf">1061.5</span><span class="p">,</span> <span class="mf">1010.1</span><span class="p">,</span>  <span class="mf">959.2</span><span class="p">,</span>
        <span class="mf">909.3</span><span class="p">,</span>  <span class="mf">864.8</span><span class="p">,</span>  <span class="mf">824.3</span><span class="p">,</span>  <span class="mf">789.8</span><span class="p">,</span>  <span class="mf">759.</span> <span class="p">,</span>  <span class="mf">734.6</span><span class="p">,</span>  <span class="mf">714.9</span><span class="p">,</span>  <span class="mf">701.3</span><span class="p">,</span>
        <span class="mf">691.3</span><span class="p">,</span>  <span class="mf">686.4</span><span class="p">,</span>  <span class="mf">687.8</span><span class="p">,</span>  <span class="mf">696.3</span><span class="p">,</span>  <span class="mf">709.1</span><span class="p">,</span>  <span class="mf">723.8</span><span class="p">,</span>  <span class="mf">737.4</span><span class="p">,</span>  <span class="mf">747.2</span><span class="p">,</span>
        <span class="mf">754.9</span><span class="p">,</span>  <span class="mf">761.</span> <span class="p">,</span>  <span class="mf">765.3</span><span class="p">,</span>  <span class="mf">767.1</span><span class="p">,</span>  <span class="mf">767.2</span><span class="p">,</span>  <span class="mf">764.8</span><span class="p">,</span>  <span class="mf">761.3</span><span class="p">,</span>  <span class="mf">755.</span> <span class="p">,</span>
        <span class="mf">746.8</span><span class="p">,</span>  <span class="mf">734.7</span><span class="p">,</span>  <span class="mf">720.2</span><span class="p">,</span>  <span class="mf">703.4</span><span class="p">])</span>

<span class="c1"># Assumed Kzz (cm^2/s) in Tsai et al. (2023)</span>
<span class="n">Kzz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">P</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">P</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
    <span class="k">if</span> <span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="mf">1e6</span> <span class="o">&gt;</span> <span class="mf">5.0</span><span class="p">:</span>
        <span class="n">Kzz</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">5e7</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">Kzz</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">5e7</span><span class="o">*</span><span class="p">(</span><span class="mi">5</span><span class="o">/</span><span class="p">(</span><span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="mf">1e6</span><span class="p">))</span><span class="o">**</span><span class="mf">0.5</span>

<span class="n">metallicity</span> <span class="o">=</span> <span class="mf">10.0</span> <span class="c1"># 10x solar</span>
<span class="n">CtoO</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="c1"># 1x solar</span>
</pre></div>
</div>
</div>
<p>With these key values set, we can call <code class="docutils literal notranslate"><span class="pre">initialize_to_climate_equilibrium_PT</span></code>. This predicts an starting guess for the atmospheric composition using chemical equilibrium. The routine then builds an altitude grid for the photochemical model based on this initial chemistry.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pc</span><span class="o">.</span><span class="n">initialize_to_climate_equilibrium_PT</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">Kzz</span><span class="p">,</span> <span class="n">metallicity</span><span class="p">,</span> <span class="n">CtoO</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Integrating-the-photochemistry-to-a-steady-state">
<h2>Integrating the photochemistry to a steady-state<a class="headerlink" href="#Integrating-the-photochemistry-to-a-steady-state" title="Link to this heading"></a></h2>
<p>We can now integrate to a photochemical steady state. This can be most easily accomplished by calling <code class="docutils literal notranslate"><span class="pre">pc.find_steady_state()</span></code>, but below we instead integrate one step at a time, plotting the atmosphere as it evolves.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pc</span><span class="o">.</span><span class="n">initialize_robust_stepper</span><span class="p">(</span><span class="n">pc</span><span class="o">.</span><span class="n">wrk</span><span class="o">.</span><span class="n">usol</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">while</span> <span class="kc">True</span><span class="p">:</span>

    <span class="c1"># Plot the atmosphere</span>
    <span class="n">clear_output</span><span class="p">(</span><span class="n">wait</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">patch</span><span class="o">.</span><span class="n">set_facecolor</span><span class="p">(</span><span class="s2">&quot;w&quot;</span><span class="p">)</span>

    <span class="n">sol</span> <span class="o">=</span> <span class="n">pc</span><span class="o">.</span><span class="n">return_atmosphere</span><span class="p">()</span>
    <span class="n">soleq</span> <span class="o">=</span> <span class="n">pc</span><span class="o">.</span><span class="n">return_atmosphere</span><span class="p">(</span><span class="n">equilibrium</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">species</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;CO2&#39;</span><span class="p">,</span><span class="s1">&#39;H2S&#39;</span><span class="p">,</span><span class="s1">&#39;S&#39;</span><span class="p">,</span><span class="s1">&#39;S2&#39;</span><span class="p">,</span><span class="s1">&#39;SO&#39;</span><span class="p">,</span><span class="s1">&#39;SO2&#39;</span><span class="p">]</span>
    <span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;CO$_2$&#39;</span><span class="p">,</span><span class="s1">&#39;H$_2$S&#39;</span><span class="p">,</span><span class="s1">&#39;S&#39;</span><span class="p">,</span><span class="s1">&#39;S$_2$&#39;</span><span class="p">,</span><span class="s1">&#39;SO&#39;</span><span class="p">,</span><span class="s1">&#39;SO$_2$&#39;</span><span class="p">]</span>
    <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;C0&#39;</span><span class="p">,</span><span class="s1">&#39;C1&#39;</span><span class="p">,</span><span class="s1">&#39;gold&#39;</span><span class="p">,</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span><span class="s1">&#39;skyblue&#39;</span><span class="p">,</span><span class="s1">&#39;violet&#39;</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">sp</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">species</span><span class="p">):</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sol</span><span class="p">[</span><span class="n">sp</span><span class="p">],</span><span class="n">sol</span><span class="p">[</span><span class="s1">&#39;pressure&#39;</span><span class="p">]</span><span class="o">/</span><span class="mf">1e6</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="n">names</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">c</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="c1"># ax.plot(soleq[sp],soleq[&#39;pressure&#39;]/1e6,c=colors[i], ls=&#39;:&#39;, alpha=0.4)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mf">1e-8</span><span class="p">,</span><span class="mf">1e-3</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mf">5e-7</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">ncol</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mf">1.0</span><span class="p">),</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Mixing Ratio&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Pressure (bar)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="mf">10.0</span><span class="o">**</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="c1"># break</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">):</span>
        <span class="n">give_up</span><span class="p">,</span> <span class="n">reached_steady_state</span> <span class="o">=</span> <span class="n">pc</span><span class="o">.</span><span class="n">robust_step</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">give_up</span> <span class="ow">or</span> <span class="n">reached_steady_state</span><span class="p">:</span>
            <span class="k">break</span>
    <span class="k">if</span> <span class="n">give_up</span> <span class="ow">or</span> <span class="n">reached_steady_state</span><span class="p">:</span>
        <span class="k">break</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_B_chemistry_2_Photochemistry_22_0.png" src="../../_images/notebooks_B_chemistry_2_Photochemistry_22_0.png" />
</div>
</div>
<p>The plot broadly reproduces Fig. 1a in Tsai et al. (2023). Here, we do not use the exact same stellar spectrum as Tsai et al. (2023), so some differences are expected.</p>
</section>
<section id="Computing-the-transmission-spectrum-with-Picaso">
<h2>Computing the transmission spectrum with Picaso<a class="headerlink" href="#Computing-the-transmission-spectrum-with-Picaso" title="Link to this heading"></a></h2>
<p>Now, we can export this composition and climate to Picaso, to compute its transmission spectrum.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">picaso</span><span class="w"> </span><span class="kn">import</span> <span class="n">justdoit</span> <span class="k">as</span> <span class="n">jdi</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="c1"># For creating a Picaso input from Photochem</span>
<span class="k">def</span><span class="w"> </span><span class="nf">create_picaso_atm</span><span class="p">(</span><span class="n">pc</span><span class="p">):</span>
    <span class="n">sol</span> <span class="o">=</span> <span class="n">pc</span><span class="o">.</span><span class="n">return_atmosphere</span><span class="p">()</span>
    <span class="k">del</span> <span class="n">sol</span><span class="p">[</span><span class="s1">&#39;Kzz&#39;</span><span class="p">]</span>
    <span class="n">sol</span><span class="p">[</span><span class="s1">&#39;pressure&#39;</span><span class="p">]</span> <span class="o">/=</span> <span class="mf">1e6</span> <span class="c1"># convert to bars</span>
    <span class="n">atm</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">sol</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;pressure&#39;</span><span class="p">,</span> <span class="s1">&#39;temperature&#39;</span><span class="p">]</span> <span class="ow">or</span> <span class="s1">&#39;aer&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">key</span><span class="p">:</span>
            <span class="n">atm</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">sol</span><span class="p">[</span><span class="n">key</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">atm</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The cell below grabs some opacities, initializes the Picaso <code class="docutils literal notranslate"><span class="pre">inputs</span></code> class, and sets the gravity and stellar spectrum.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">opa</span> <span class="o">=</span> <span class="n">jdi</span><span class="o">.</span><span class="n">opannection</span><span class="p">(</span><span class="n">wave_range</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mf">5.5</span><span class="p">])</span>

<span class="n">case</span> <span class="o">=</span> <span class="n">jdi</span><span class="o">.</span><span class="n">inputs</span><span class="p">()</span>

<span class="k">case</span><span class="o">.</span><span class="n">gravity</span><span class="p">(</span>
    <span class="n">mass</span><span class="o">=</span><span class="n">WASP39b</span><span class="o">.</span><span class="n">planet_mass</span><span class="p">,</span>
    <span class="n">mass_unit</span><span class="o">=</span><span class="n">jdi</span><span class="o">.</span><span class="n">u</span><span class="o">.</span><span class="n">Unit</span><span class="p">(</span><span class="s1">&#39;M_jup&#39;</span><span class="p">),</span>
    <span class="n">radius</span><span class="o">=</span><span class="n">WASP39b</span><span class="o">.</span><span class="n">planet_radius</span><span class="p">,</span>
    <span class="n">radius_unit</span><span class="o">=</span><span class="n">jdi</span><span class="o">.</span><span class="n">u</span><span class="o">.</span><span class="n">Unit</span><span class="p">(</span><span class="s1">&#39;R_jup&#39;</span><span class="p">)</span>
<span class="p">)</span>

<span class="k">case</span><span class="o">.</span><span class="n">star</span><span class="p">(</span>
    <span class="n">opa</span><span class="p">,</span>
    <span class="n">temp</span><span class="o">=</span><span class="n">WASP39b</span><span class="o">.</span><span class="n">stellar_Teff</span><span class="p">,</span>
    <span class="n">metal</span><span class="o">=</span><span class="n">WASP39b</span><span class="o">.</span><span class="n">stellar_metal</span><span class="p">,</span>
    <span class="n">logg</span><span class="o">=</span><span class="n">WASP39b</span><span class="o">.</span><span class="n">stellar_logg</span><span class="p">,</span>
    <span class="n">radius</span><span class="o">=</span><span class="n">WASP39b</span><span class="o">.</span><span class="n">stellar_radius</span><span class="p">,</span>
    <span class="n">radius_unit</span><span class="o">=</span><span class="n">jdi</span><span class="o">.</span><span class="n">u</span><span class="o">.</span><span class="n">Unit</span><span class="p">(</span><span class="s1">&#39;R_sun&#39;</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<p>Below is a little helper function for computing spectra with different inputs, then downbinning the spectra to lower resolution.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">spectrum</span><span class="p">(</span><span class="n">opa</span><span class="p">,</span> <span class="n">case</span><span class="p">,</span> <span class="n">atm</span><span class="p">,</span> <span class="n">R</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">atmosphere_kwargs</span><span class="o">=</span><span class="p">{}):</span>

    <span class="c1"># Set atmosphere</span>
    <span class="k">case</span><span class="o">.</span><span class="n">atmosphere</span><span class="p">(</span><span class="n">atm</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">atmosphere_kwargs</span><span class="p">)</span>

    <span class="c1"># Compute spectrum</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">case</span><span class="o">.</span><span class="n">spectrum</span><span class="p">(</span><span class="n">opa</span><span class="p">,</span> <span class="n">calculation</span><span class="o">=</span><span class="s1">&#39;transmission&#39;</span><span class="p">)</span>

    <span class="c1"># Extract spectrum</span>
    <span class="n">wv_h</span> <span class="o">=</span> <span class="mf">1e4</span><span class="o">/</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;wavenumber&#39;</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">wavl_h</span> <span class="o">=</span> <span class="n">stars</span><span class="o">.</span><span class="n">make_bins</span><span class="p">(</span><span class="n">wv_h</span><span class="p">)</span>
    <span class="n">rprs2_h</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;transit_depth&#39;</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="c1"># Rebin</span>
    <span class="n">wavl</span> <span class="o">=</span> <span class="n">stars</span><span class="o">.</span><span class="n">grid_at_resolution</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">wavl_h</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">wavl_h</span><span class="p">),</span> <span class="n">R</span><span class="p">)</span>
    <span class="n">rprs2</span> <span class="o">=</span> <span class="n">stars</span><span class="o">.</span><span class="n">rebin</span><span class="p">(</span><span class="n">wavl_h</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span> <span class="n">rprs2_h</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span> <span class="n">wavl</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>

    <span class="k">return</span> <span class="n">wavl</span><span class="p">,</span> <span class="n">rprs2</span>
</pre></div>
</div>
</div>
<p>Finally, we compute the transmission spectrum several times leaving out important molecules (e.g., SO<span class="math notranslate nohighlight">\(_2\)</span>), to show their impact on the spectrum:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">6</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>

<span class="c1"># Create Picaso atmosphere from Photochem object</span>
<span class="n">atm</span> <span class="o">=</span> <span class="n">create_picaso_atm</span><span class="p">(</span><span class="n">pc</span><span class="p">)</span>

<span class="c1"># Compute and plot spectrum</span>
<span class="n">wavl</span><span class="p">,</span> <span class="n">rprs2</span> <span class="o">=</span> <span class="n">spectrum</span><span class="p">(</span><span class="n">opa</span><span class="p">,</span> <span class="n">case</span><span class="p">,</span> <span class="n">atm</span><span class="p">,</span> <span class="n">R</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">wavl</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">rprs2</span><span class="o">*</span><span class="mf">1e2</span><span class="p">,</span> <span class="n">drawstyle</span><span class="o">=</span><span class="s1">&#39;steps-pre&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>

<span class="c1"># Compute the spectrum several more times, to show the impact of different species.</span>
<span class="n">species</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;H2O&#39;</span><span class="p">,</span><span class="s1">&#39;CH4&#39;</span><span class="p">,</span><span class="s1">&#39;CO2&#39;</span><span class="p">,</span><span class="s1">&#39;SO2&#39;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">sp</span> <span class="ow">in</span> <span class="n">species</span><span class="p">:</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">rprs2_1</span> <span class="o">=</span> <span class="n">spectrum</span><span class="p">(</span><span class="n">opa</span><span class="p">,</span> <span class="n">case</span><span class="p">,</span> <span class="n">atm</span><span class="p">,</span> <span class="n">R</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">atmosphere_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;exclude_mol&#39;</span><span class="p">:[</span><span class="n">sp</span><span class="p">]})</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">wavl</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">rprs2</span><span class="o">*</span><span class="mf">1e2</span><span class="p">,</span> <span class="n">rprs2_1</span><span class="o">*</span><span class="mf">1e2</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="s1">&#39;pre&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">sp</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mf">2.7</span><span class="p">,</span><span class="mf">5.3</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Transit Depth (%)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Wavelength (microns)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_B_chemistry_2_Photochemistry_30_0.png" src="../../_images/notebooks_B_chemistry_2_Photochemistry_30_0.png" />
</div>
</div>
<p>The plot above is similar to Figure 3b in Tsai et al. (2023). Note, however, that Tsai et al. (2023) took a slightly different approach for computing WASP-39b’s transmission spectrum. They did two 1-D photochemical calculations, one each for the morning and evening terminator. They then computed the transmission spectrum of both results, and averaged them to produce Fig. 3b. For simplicity, in this tutorial, we only computed the photochemistry &amp; spectrum of the morning terminator.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="1_ChemicalEquilibrium.html" class="btn btn-neutral float-left" title="Adding your Own Chemistry in PICASO" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../C_clouds/1_PairingPICASOToVIRGA.html" class="btn btn-neutral float-right" title="How clouds affect albedo spectroscopy" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright .</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>