<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>One-Dimensional Climate Models: The Basics of Planets &mdash; picaso 3.2 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b76e3c8a" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../../_static/nbsphinx-code-cells.css?v=720011df" />

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/documentation_options.js?v=828ea960"></script>
        <script src="../../_static/doctools.js?v=888ff710"></script>
        <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="One-Dimensional Climate Models: Brown Dwarfs w/ Disequilibrium Chemistry at Solar M/H and C/O" href="12c_BrownDwarf_DEQ.html" />
    <link rel="prev" title="One-Dimensional Climate Models: The Basics of Brown Dwarfs" href="12a_BrownDwarf.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            picaso
          </a>
              <div class="version">
                3.2
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../tutorials.html">The Tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../tutorials.html#basics-of-reflected-light">Basics of Reflected Light</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials.html#basics-of-transmisison">Basics of Transmisison</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials.html#basics-of-thermal-emission">Basics of Thermal Emission</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials.html#cloud-modeling-with-virga">Cloud Modeling with <cite>Virga</cite></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials.html#moving-to-3-dimensions">Moving to 3 Dimensions</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../tutorials.html#d-climate-modeling">1D Climate Modeling</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="12a_BrownDwarf.html">Brown Dwarfs</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Planet</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Starting-up-the-Run">Starting up the Run</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Initial-T(P)-Guess">Initial T(P) Guess</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Initial-Convective-Zone-Guess">Initial Convective Zone Guess</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Run-the-Climate-Code">Run the Climate Code</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="12c_BrownDwarf_DEQ.html">Brown Dwarfs w/ Disequilibrium Chemistry</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials.html#fitting-models-to-data">Fitting models to data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials.html#model-storage-reuse">Model Storage &amp; Reuse</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials.html#opacities">Opacities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials.html#radiative-transfer-techniques">Radiative Transfer Techniques</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials.html#faqs">FAQs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials.html#code-help">Code Help</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials.html#references">References</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../picaso.html">The Code</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contribution.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../workshops.html">Workshop Material</a></li>
<li class="toctree-l1"><a class="reference external" href="https://natashabatalha.github.io/picaso_dev">The Derivations</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/natashabatalha/picaso">Github</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../credit.html">What to Cite</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">picaso</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../tutorials.html">Tutorials</a></li>
      <li class="breadcrumb-item active">One-Dimensional Climate Models: The Basics of Planets</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/notebooks/climate/12b_Exoplanet.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference external" href="https://github.com/natashabatalha/picaso/tree/master/docs/notebooks/climate/12b_Exoplanet.ipynb">Download full notebook here</a></p>
</div>
<section id="One-Dimensional-Climate-Models:-The-Basics-of-Planets">
<h1>One-Dimensional Climate Models: The Basics of Planets<a class="headerlink" href="#One-Dimensional-Climate-Models:-The-Basics-of-Planets" title="Link to this heading">¶</a></h1>
<p>In this tutorial you will learn the very basics of running 1D climate runs. For a more in depth look at the climate code check out <a class="reference external" href="https://arxiv.org/abs/2208.07836">Mukherjee et al. 2022</a> (note this should also be cited if using this code/tutorial).</p>
<p>What you should already be familiar with:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://natashabatalha.github.io/picaso/tutorials.html#basics-of-thermal-emission">basics of running/analyzing thermal spectra</a></p></li>
<li><p><a class="reference external" href="https://natashabatalha.github.io/picaso/notebooks/workshops/ERS2021/ThermalEmissionTutorial.html">how to analyze thermal emission spectra</a></p></li>
<li><p><a class="reference external" href="https://natashabatalha.github.io/picaso/notebooks/climate/12a_BrownDwarf.html">how to compute a Brown Dwarf 1D climate model</a></p></li>
</ul>
<p>What you will need to download to use this tutorial:</p>
<ol class="arabic simple">
<li><p><a class="reference external" href="https://zenodo.org/record/5590989#.Yzy2YOzMI8a">Download</a> 196 Correlated-K Tables from Roxana Lupu to be used by the climate code for opacity (if you completed the brown dwarf tutorial you should already have this)</p></li>
</ol>
<p><strong>Note</strong>: the two files above are dependent on metallicity and C/O.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">picaso.justdoit</span> <span class="k">as</span> <span class="nn">jdi</span>
<span class="kn">import</span> <span class="nn">picaso.justplotit</span> <span class="k">as</span> <span class="nn">jpi</span>
<span class="kn">import</span> <span class="nn">astropy.units</span> <span class="k">as</span> <span class="nn">u</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#1 ck tables from roxana</span>
<span class="n">mh</span> <span class="o">=</span> <span class="s1">&#39;+100&#39;</span><span class="c1">#&#39;+1.0&#39; #log metallicity, 10xSolar</span>
<span class="n">CtoO</span> <span class="o">=</span> <span class="s1">&#39;100&#39;</span><span class="c1">#&#39;1.0&#39; # CtoO ratio, Solar C/O</span>
<span class="n">ck_db</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/data/kcoeff_2020_v3/sonora_2020_feh</span><span class="si">{</span><span class="n">mh</span><span class="si">}</span><span class="s1">_co_</span><span class="si">{</span><span class="n">CtoO</span><span class="si">}</span><span class="s1">.data.196&#39;</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Notice The keyword ck is set to True because you want to use the correlated-k opacities for your calculation</span>
<span class="c1"># and not the line by line opacities</span>
<span class="n">opacity_ck</span> <span class="o">=</span> <span class="n">jdi</span><span class="o">.</span><span class="n">opannection</span><span class="p">(</span><span class="n">ck_db</span><span class="o">=</span><span class="n">ck_db</span><span class="p">)</span> <span class="c1"># grab your opacities</span>
</pre></div>
</div>
</div>
<section id="Starting-up-the-Run">
<h2>Starting up the Run<a class="headerlink" href="#Starting-up-the-Run" title="Link to this heading">¶</a></h2>
<p>You will notice that starting a run is nearly identical as running a spectrum and brown dwarf climate model. However, how we will add <code class="docutils literal notranslate"><span class="pre">climate=True</span></code> to our inputs flag. We will also specify <code class="docutils literal notranslate"><span class="pre">planet</span></code> in this case, which will turn on the irradiation the object is receiving.</p>
<p>New Parameter (was also used in the Brown Dwarf tutorial): <strong>Effective Temperature</strong>. This excerpt from <a class="reference external" href="https://arxiv.org/pdf/1804.08149.pdf">Modeling Exoplanetary Atmospheres (Fortney et al)</a> provides a thorough description and more reading, if you are interested.</p>
<blockquote>
<div><p>If the effective temperature, <span class="math notranslate nohighlight">\(T_{eff}\)</span>, is defined as the temperature of a blackbody of the same radius that would emit the equivalent flux as the real planet, <span class="math notranslate nohighlight">\(T_{eff}\)</span> and <span class="math notranslate nohighlight">\(T_{eq}\)</span> can be simply related. This relation requires the inclusion of a third temperature, <span class="math notranslate nohighlight">\(T_{int}\)</span>, the intrinsic effective temperature, that describes the flux from the planet’s interior. These temperatures are related by:</p>
</div></blockquote>
<blockquote>
<div><p><span class="math notranslate nohighlight">\(T_{eff}^4 = T_{int}^4 + T_{eq}^4\)</span></p>
<p>We then recover our limiting cases: if a planet is self-luminous (like a young giant planet) and far from its parent star, <span class="math notranslate nohighlight">\(T_{eff} \approx T_{int}\)</span>; for most rocky planets, or any planets under extreme stellar irradiation, <span class="math notranslate nohighlight">\(T_{eff} \approx T_{eq}\)</span>.</p>
</div></blockquote>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cl_run</span> <span class="o">=</span> <span class="n">jdi</span><span class="o">.</span><span class="n">inputs</span><span class="p">(</span><span class="n">calculation</span><span class="o">=</span><span class="s2">&quot;planet&quot;</span><span class="p">,</span> <span class="n">climate</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="c1"># start a calculation</span>

<span class="c1">#note you need to put the climate keyword to be True in order to do so</span>
<span class="c1"># now you need to add these parameters to your calculation</span>


<span class="n">tint</span><span class="o">=</span> <span class="mi">200</span> <span class="c1"># Intrinsic Temperature of your Planet in K</span>
<span class="n">grav</span> <span class="o">=</span> <span class="mf">4.5</span> <span class="c1"># Gravity of your Planet in m/s/s</span>

<span class="n">cl_run</span><span class="o">.</span><span class="n">gravity</span><span class="p">(</span><span class="n">gravity</span><span class="o">=</span><span class="n">grav</span><span class="p">,</span> <span class="n">gravity_unit</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">Unit</span><span class="p">(</span><span class="s1">&#39;m/(s**2)&#39;</span><span class="p">))</span> <span class="c1"># input gravity</span>
<span class="n">cl_run</span><span class="o">.</span><span class="n">effective_temp</span><span class="p">(</span><span class="n">tint</span><span class="p">)</span> <span class="c1"># input effective temperature</span>
</pre></div>
</div>
</div>
<p>Let’s now input the host-star properties</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">T_star</span> <span class="o">=</span><span class="mf">5326.6</span> <span class="c1"># K, star effective temperature</span>
<span class="n">logg</span> <span class="o">=</span><span class="mf">4.38933</span> <span class="c1">#logg , cgs</span>
<span class="n">metal</span> <span class="o">=-</span><span class="mf">0.03</span> <span class="c1"># metallicity of star</span>
<span class="n">r_star</span> <span class="o">=</span> <span class="mf">0.932</span> <span class="c1"># solar radius</span>
<span class="n">semi_major</span> <span class="o">=</span> <span class="mf">0.0486</span> <span class="c1"># star planet distance, AU</span>

<span class="n">cl_run</span><span class="o">.</span><span class="n">star</span><span class="p">(</span><span class="n">opacity_ck</span><span class="p">,</span> <span class="n">temp</span> <span class="o">=</span><span class="n">T_star</span><span class="p">,</span><span class="n">metal</span> <span class="o">=</span><span class="n">metal</span><span class="p">,</span> <span class="n">logg</span> <span class="o">=</span><span class="n">logg</span><span class="p">,</span> <span class="n">radius</span> <span class="o">=</span> <span class="n">r_star</span><span class="p">,</span>
            <span class="n">radius_unit</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">R_sun</span><span class="p">,</span><span class="n">semi_major</span><span class="o">=</span> <span class="n">semi_major</span> <span class="p">,</span> <span class="n">semi_major_unit</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">AU</span><span class="p">)</span><span class="c1">#opacity db, pysynphot database, temp, metallicity, logg</span>
<br/></pre></div>
</div>
</div>
</section>
<section id="Initial-T(P)-Guess">
<h2>Initial T(P) Guess<a class="headerlink" href="#Initial-T(P)-Guess" title="Link to this heading">¶</a></h2>
<p>Every calculation requires an initial guess of the pressure temperature profile. The code will iterate from there to find the correct solution. A few tips:</p>
<ol class="arabic simple">
<li><p>We recommend <strong>using typically 51-91 atmospheric pressure levels</strong>. Too many pressure layers increases the computational time required for convergence. Too little layers makes the atmospheric grid too coarse for an accurate calculation.</p></li>
<li><p>Start with <strong>a guess that is close to your expected solution</strong>. One easy way to get fairly close is by using the Guillot et al 2010 temperature-pressure profile approximation</p></li>
</ol>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nlevel</span> <span class="o">=</span> <span class="mi">91</span> <span class="c1"># number of plane-parallel levels in your code</span>

<span class="c1">#Lets set the max and min at 1e-4 bars and 500 bars</span>
<span class="n">Teq</span><span class="o">=</span><span class="mi">1000</span> <span class="c1"># planet equilibrium temperature</span>
<span class="n">pt</span> <span class="o">=</span> <span class="n">cl_run</span><span class="o">.</span><span class="n">guillot_pt</span><span class="p">(</span><span class="n">Teq</span><span class="p">,</span> <span class="n">nlevel</span><span class="o">=</span><span class="n">nlevel</span><span class="p">,</span> <span class="n">T_int</span> <span class="o">=</span> <span class="n">tint</span><span class="p">,</span> <span class="n">p_bottom</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">p_top</span><span class="o">=-</span><span class="mi">6</span><span class="p">)</span>
<span class="n">temp_guess</span> <span class="o">=</span> <span class="n">pt</span><span class="p">[</span><span class="s1">&#39;temperature&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">pressure</span> <span class="o">=</span> <span class="n">pt</span><span class="p">[</span><span class="s1">&#39;pressure&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
</pre></div>
</div>
</div>
</section>
<section id="Initial-Convective-Zone-Guess">
<h2>Initial Convective Zone Guess<a class="headerlink" href="#Initial-Convective-Zone-Guess" title="Link to this heading">¶</a></h2>
<p>You also need to have a crude guess of the convective zone of your atmosphere. Generally the deeper atmosphere is always convective. Again a good guess is always the published SONORA grid of models for this. But lets assume that the bottom 7 levels of the atmosphere is convective.</p>
<p><strong>New Parameters:</strong></p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">nofczns</span></code> : Number of convective zones. Though the code has functionality to solve for more than one. In this basic tutorial, let’s stick to 1 for now.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rfacv</span></code>: (See Mukherjee et al Eqn. 20 <code class="docutils literal notranslate"><span class="pre">r_st</span></code>) <a class="reference external" href="https://arxiv.org/pdf/2208.07836.pdf">https://arxiv.org/pdf/2208.07836.pdf</a></p></li>
</ol>
<p>Non-zero values of rst (aka “rfacv” legacy terminology) is only relevant when the external irradiation on the atmosphere is non-zero. In the scenario when a user is computing a planet-wide average T(P) profile, the stellar irradiation is contributing to 50% (one hemisphere) of the planet and as a result rst = 0.5. If instead the goal is to compute a night-side average atmospheric state, rst is set to be 0. On the other extreme, to compute the day-side atmospheric state of a tidally locked planet
rst should be set at 1.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nofczns</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1"># number of convective zones initially. Let&#39;s not play with this for now.</span>

<span class="n">nstr_upper</span> <span class="o">=</span> <span class="mi">85</span> <span class="c1"># top most level of guessed convective zone</span>
<span class="n">nstr_deep</span> <span class="o">=</span> <span class="n">nlevel</span> <span class="o">-</span><span class="mi">2</span> <span class="c1"># this is always the case. Dont change this</span>
<span class="n">nstr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="n">nstr_upper</span><span class="p">,</span><span class="n">nstr_deep</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># initial guess of convective zones</span>

<span class="c1"># Here are some other parameters needed for the code.</span>
<span class="n">rfacv</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="c1">#we are focused on a brown dwarf so let&#39;s keep this as is</span>
</pre></div>
</div>
</div>
<p>Now we would use the inputs_climate function to input everything together to our cl_run we started.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cl_run</span><span class="o">.</span><span class="n">inputs_climate</span><span class="p">(</span><span class="n">temp_guess</span><span class="o">=</span> <span class="n">temp_guess</span><span class="p">,</span> <span class="n">pressure</span><span class="o">=</span> <span class="n">pressure</span><span class="p">,</span>
                      <span class="n">nstr</span> <span class="o">=</span> <span class="n">nstr</span><span class="p">,</span> <span class="n">nofczns</span> <span class="o">=</span> <span class="n">nofczns</span> <span class="p">,</span> <span class="n">rfacv</span> <span class="o">=</span> <span class="n">rfacv</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Run-the-Climate-Code">
<h2>Run the Climate Code<a class="headerlink" href="#Run-the-Climate-Code" title="Link to this heading">¶</a></h2>
<p>The actual climate code can be run with the cl_run.run command. The save_all_profiles is set to True to save the T(P) profile at all steps. The code will now iterate from your guess to reach the correct atmospheric solution for your brown dwarf of interest.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">out</span> <span class="o">=</span> <span class="n">cl_run</span><span class="o">.</span><span class="n">climate</span><span class="p">(</span><span class="n">opacity_ck</span><span class="p">,</span> <span class="n">save_all_profiles</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">with_spec</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Iteration number  0 , min , max temp  859.054155942838 2289.478427903662 , flux balance  -46.15847181591005
Iteration number  1 , min , max temp  835.3574006260803 2777.6878509379635 , flux balance  17.82965190850441
Iteration number  2 , min , max temp  834.2722222145496 2653.4220211996176 , flux balance  0.2594411932152453
Iteration number  3 , min , max temp  834.2651124752114 2639.2957580270786 , flux balance  0.0012104268509236513
Iteration number  4 , min , max temp  834.2650775441722 2639.0924332789596 , flux balance  5.499585765882438e-06
In t_start: Converged Solution in iterations  4
Big iteration is  834.2650775441722 0
Iteration number  0 , min , max temp  834.0393684187401 2734.9589459834865 , flux balance  -3.660621966940465
Iteration number  1 , min , max temp  833.7618986334929 2823.879709982079 , flux balance  0.12744719833424106
Iteration number  2 , min , max temp  833.7602101385852 2819.106469079621 , flux balance  0.0007067647384675832
In t_start: Converged Solution in iterations  2
Big iteration is  833.7602101385852 1
Iteration number  0 , min , max temp  834.6507021802025 2930.3758747219267 , flux balance  -0.14424565099125855
Iteration number  1 , min , max temp  834.7484053262953 2933.850480135399 , flux balance  -0.0002867399420656116
In t_start: Converged Solution in iterations  1
Big iteration is  834.7484053262953 2
Iteration number  0 , min , max temp  835.3849918816801 3018.1228722038486 , flux balance  -0.0001937036980519201
Iteration number  1 , min , max temp  835.3874378060507 3014.557263577295 , flux balance  2.4716598291939565e-07
In t_start: Converged Solution in iterations  1
Profile converged before itmx
Iteration number  0 , min , max temp  835.7816725005212 3070.631061776754 , flux balance  8.60778296513762e-05
Iteration number  1 , min , max temp  835.7834656038983 3069.1460884516528 , flux balance  3.740806372413759e-07
In t_start: Converged Solution in iterations  1
Big iteration is  835.7834656038983 0
Iteration number  0 , min , max temp  836.0058826361692 3105.051279473138 , flux balance  4.2639690072613516e-05
Iteration number  1 , min , max temp  836.0069497529855 3104.474012120312 , flux balance  1.8151256338186683e-07
In t_start: Converged Solution in iterations  1
Profile converged before itmx
Move up two levels
Iteration number  0 , min , max temp  836.1272490822133 2814.4533222676664 , flux balance  5.112756588168638e-06
In t_start: Converged Solution in iterations  0
Big iteration is  836.1272490822133 0
Iteration number  0 , min , max temp  836.1924392218433 2814.4531485178004 , flux balance  -8.640664528425539e-07
In t_start: Converged Solution in iterations  0
Profile converged before itmx
final [ 0 83 89  0  0  0]
Iteration number  0 , min , max temp  836.2271503391952 2814.453648097963 , flux balance  -1.987533884891869e-06
In t_start: Converged Solution in iterations  0
Big iteration is  836.2271503391952 0
Iteration number  0 , min , max temp  836.2456450333358 2814.4538672423496 , flux balance  -1.4208921069493005e-06
In t_start: Converged Solution in iterations  0
Profile converged before itmx
YAY ! ENDING WITH CONVERGENCE
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">base_case</span> <span class="o">=</span> <span class="n">jdi</span><span class="o">.</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">jdi</span><span class="o">.</span><span class="n">HJ_pt</span><span class="p">(),</span> <span class="n">delim_whitespace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Pressure [Bars]&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Temperature [K]&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span><span class="mf">1e-4</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span><span class="mi">3000</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">out</span><span class="p">[</span><span class="s1">&#39;temperature&#39;</span><span class="p">],</span><span class="n">out</span><span class="p">[</span><span class="s1">&#39;pressure&#39;</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;Our Run&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">base_case</span><span class="p">[</span><span class="s1">&#39;temperature&#39;</span><span class="p">],</span><span class="n">base_case</span><span class="p">[</span><span class="s1">&#39;pressure&#39;</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;WASP-39 b ERS Run&quot;</span><span class="p">)</span>


<span class="n">plt</span><span class="o">.</span><span class="n">minorticks_on</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span><span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span><span class="n">length</span> <span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">direction</span><span class="o">=</span><span class="s1">&#39;in&#39;</span><span class="p">,</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">23</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span><span class="n">which</span><span class="o">=</span><span class="s1">&#39;minor&#39;</span><span class="p">,</span><span class="n">length</span> <span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">direction</span><span class="o">=</span><span class="s1">&#39;in&#39;</span><span class="p">,</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">23</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;T$_{\rm eff}$= 1000 K, log(g)=5.0&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>
<br/><br/></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0.5, 1.0, &#39;T$_{\\rm eff}$= 1000 K, log(g)=5.0&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_climate_12b_Exoplanet_18_1.png" src="../../_images/notebooks_climate_12b_Exoplanet_18_1.png" />
</div>
</div>
<section id="Brightness-Temperature">
<h3>Brightness Temperature<a class="headerlink" href="#Brightness-Temperature" title="Link to this heading">¶</a></h3>
<p>Checking the brightness temperature serves many useful purposes:</p>
<ol class="arabic simple">
<li><p>Intuition building. Allows you to see what corresponding temperature are you sensitive to at each wavelength</p></li>
</ol>
<p>Note that this temperature doesn’t need to be the physical temperature of your atmosphere but if you can find the physical converged atmospheric temperature closest to this brightness temperature you can also get an idea of the atmospheric pressure from where the flux you are seeing is originating from.</p>
<ol class="arabic simple" start="2">
<li><p>Determining if your choice in bottom boundary pressure grid was correct.</p></li>
</ol>
<p>If your brightness temperature is such that you bottom out at the temperature corresponding to the highest pressure, you have not extended your grid to high enough pressures.</p>
<p>Brightness Temperature Equation:</p>
<p><span class="math notranslate nohighlight">\(T_{\rm bright}=\dfrac{a}{{\lambda}log\left(\dfrac{{b}}{F(\lambda){\lambda}^5}+1\right)}\)</span></p>
<p>where a = 1.43877735$:nbsphinx-math:<cite>times</cite><span class="math notranslate nohighlight">\(10\)</span>^{-2}$ m.K and b = 11.91042952$:nbsphinx-math:<cite>times</cite><span class="math notranslate nohighlight">\(10\)</span>^{-17}$ m<span class="math notranslate nohighlight">\(^4\)</span>kg/s<span class="math notranslate nohighlight">\(^3\)</span></p>
<p>Let’s calculate the brigthness temperature of our current run and check if our pressure grid was okay.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">brightness_temp</span><span class="p">,</span> <span class="n">figure</span><span class="o">=</span> <span class="n">jpi</span><span class="o">.</span><span class="n">brightness_temperature</span><span class="p">(</span><span class="n">out</span><span class="p">[</span><span class="s1">&#39;spectrum_output&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_climate_12b_Exoplanet_21_0.png" src="../../_images/notebooks_climate_12b_Exoplanet_21_0.png" />
</div>
</div>
</section>
<section id="Check-Adiabat">
<h3>Check Adiabat<a class="headerlink" href="#Check-Adiabat" title="Link to this heading">¶</a></h3>
<p>This plot and datareturn is helpful to check that there have been no issues with where the code has found the location of the convective zone(s). See below, dTdP never exceeds the adiabat.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">adiabat</span><span class="p">,</span> <span class="n">dtdp</span><span class="p">,</span> <span class="n">pressure</span> <span class="o">=</span> <span class="n">jpi</span><span class="o">.</span><span class="n">pt_adiabat</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">cl_run</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_climate_12b_Exoplanet_23_0.png" src="../../_images/notebooks_climate_12b_Exoplanet_23_0.png" />
</div>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="12a_BrownDwarf.html" class="btn btn-neutral float-left" title="One-Dimensional Climate Models: The Basics of Brown Dwarfs" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="12c_BrownDwarf_DEQ.html" class="btn btn-neutral float-right" title="One-Dimensional Climate Models: Brown Dwarfs w/ Disequilibrium Chemistry at Solar M/H and C/O" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright .</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>