

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>The Code &mdash; picaso 4.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=9edc463e" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=9f5556dd"></script>
      <script src="_static/doctools.js?v=fd6eb6e6"></script>
      <script src="_static/sphinx_highlight.js?v=6ffebe34"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Contributing to PICASO" href="contribution.html" />
    <link rel="prev" title="What do I reference?" href="notebooks/References.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            picaso
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html#reference-data">Reference Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html#using-quickstart-notebook">Using Quickstart Notebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebook_workflow.html">Tutorial Workflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials.html">The Tutorials</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">The Code</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-picaso.atmsetup">picaso.atmsetup module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#picaso.atmsetup.ATMSETUP"><code class="docutils literal notranslate"><span class="pre">ATMSETUP</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#picaso.atmsetup.ATMSETUP.add_warnings"><code class="docutils literal notranslate"><span class="pre">ATMSETUP.add_warnings()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#picaso.atmsetup.ATMSETUP.as_dict"><code class="docutils literal notranslate"><span class="pre">ATMSETUP.as_dict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#picaso.atmsetup.ATMSETUP.calc_PT"><code class="docutils literal notranslate"><span class="pre">ATMSETUP.calc_PT()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#picaso.atmsetup.ATMSETUP.disect"><code class="docutils literal notranslate"><span class="pre">ATMSETUP.disect()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#picaso.atmsetup.ATMSETUP.get_altitude"><code class="docutils literal notranslate"><span class="pre">ATMSETUP.get_altitude()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#picaso.atmsetup.ATMSETUP.get_altitude_deprecate"><code class="docutils literal notranslate"><span class="pre">ATMSETUP.get_altitude_deprecate()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#picaso.atmsetup.ATMSETUP.get_clouds"><code class="docutils literal notranslate"><span class="pre">ATMSETUP.get_clouds()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#picaso.atmsetup.ATMSETUP.get_column_density"><code class="docutils literal notranslate"><span class="pre">ATMSETUP.get_column_density()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#picaso.atmsetup.ATMSETUP.get_constants"><code class="docutils literal notranslate"><span class="pre">ATMSETUP.get_constants()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#picaso.atmsetup.ATMSETUP.get_density"><code class="docutils literal notranslate"><span class="pre">ATMSETUP.get_density()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#picaso.atmsetup.ATMSETUP.get_dtdp"><code class="docutils literal notranslate"><span class="pre">ATMSETUP.get_dtdp()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#picaso.atmsetup.ATMSETUP.get_mmw"><code class="docutils literal notranslate"><span class="pre">ATMSETUP.get_mmw()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#picaso.atmsetup.ATMSETUP.get_needed_continuum"><code class="docutils literal notranslate"><span class="pre">ATMSETUP.get_needed_continuum()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#picaso.atmsetup.ATMSETUP.get_profile"><code class="docutils literal notranslate"><span class="pre">ATMSETUP.get_profile()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#picaso.atmsetup.ATMSETUP.get_profile_3d"><code class="docutils literal notranslate"><span class="pre">ATMSETUP.get_profile_3d()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#picaso.atmsetup.ATMSETUP.get_surf_reflect"><code class="docutils literal notranslate"><span class="pre">ATMSETUP.get_surf_reflect()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#picaso.atmsetup.ATMSETUP.get_weights"><code class="docutils literal notranslate"><span class="pre">ATMSETUP.get_weights()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.atmsetup.convert_to_simple"><code class="docutils literal notranslate"><span class="pre">convert_to_simple()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.atmsetup.separate_molecule_name"><code class="docutils literal notranslate"><span class="pre">separate_molecule_name()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.atmsetup.separate_string_number"><code class="docutils literal notranslate"><span class="pre">separate_string_number()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-picaso.build_3d_input">picaso.build_3d_input module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#picaso.build_3d_input.lon_lat_to_cartesian"><code class="docutils literal notranslate"><span class="pre">lon_lat_to_cartesian()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.build_3d_input.make_3d_cld_input"><code class="docutils literal notranslate"><span class="pre">make_3d_cld_input()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.build_3d_input.make_3d_pt_input"><code class="docutils literal notranslate"><span class="pre">make_3d_pt_input()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.build_3d_input.rebin_mitgcm_cld"><code class="docutils literal notranslate"><span class="pre">rebin_mitgcm_cld()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.build_3d_input.rebin_mitgcm_pt"><code class="docutils literal notranslate"><span class="pre">rebin_mitgcm_pt()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.build_3d_input.regrid_xarray"><code class="docutils literal notranslate"><span class="pre">regrid_xarray()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.build_3d_input.variable_pressure_example"><code class="docutils literal notranslate"><span class="pre">variable_pressure_example()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-picaso.disco">picaso.disco module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#picaso.disco.compress_disco"><code class="docutils literal notranslate"><span class="pre">compress_disco()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.disco.compress_thermal"><code class="docutils literal notranslate"><span class="pre">compress_thermal()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.disco.compute_disco"><code class="docutils literal notranslate"><span class="pre">compute_disco()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.disco.get_angles_1d"><code class="docutils literal notranslate"><span class="pre">get_angles_1d()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.disco.get_angles_3d"><code class="docutils literal notranslate"><span class="pre">get_angles_3d()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-picaso.elements">picaso.elements module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#requirements">Requirements</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-picaso.fluxes">picaso.fluxes module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#picaso.fluxes.blackbody"><code class="docutils literal notranslate"><span class="pre">blackbody()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.fluxes.blackbody_climate_deprecate"><code class="docutils literal notranslate"><span class="pre">blackbody_climate_deprecate()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.fluxes.blackbody_integrated"><code class="docutils literal notranslate"><span class="pre">blackbody_integrated()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.fluxes.calculate_flux"><code class="docutils literal notranslate"><span class="pre">calculate_flux()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.fluxes.chapman"><code class="docutils literal notranslate"><span class="pre">chapman()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.fluxes.get_reflected_1d"><code class="docutils literal notranslate"><span class="pre">get_reflected_1d()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.fluxes.get_reflected_1d_deprecate"><code class="docutils literal notranslate"><span class="pre">get_reflected_1d_deprecate()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.fluxes.get_reflected_1d_gfluxv_deprecate"><code class="docutils literal notranslate"><span class="pre">get_reflected_1d_gfluxv_deprecate()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.fluxes.get_reflected_3d"><code class="docutils literal notranslate"><span class="pre">get_reflected_3d()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.fluxes.get_reflected_SH"><code class="docutils literal notranslate"><span class="pre">get_reflected_SH()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.fluxes.get_thermal_1d"><code class="docutils literal notranslate"><span class="pre">get_thermal_1d()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.fluxes.get_thermal_1d_deprecate"><code class="docutils literal notranslate"><span class="pre">get_thermal_1d_deprecate()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.fluxes.get_thermal_1d_gfluxi_deprecate"><code class="docutils literal notranslate"><span class="pre">get_thermal_1d_gfluxi_deprecate()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.fluxes.get_thermal_3d"><code class="docutils literal notranslate"><span class="pre">get_thermal_3d()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.fluxes.get_thermal_SH"><code class="docutils literal notranslate"><span class="pre">get_thermal_SH()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.fluxes.get_transit_1d"><code class="docutils literal notranslate"><span class="pre">get_transit_1d()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.fluxes.get_transit_3d"><code class="docutils literal notranslate"><span class="pre">get_transit_3d()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.fluxes.legP"><code class="docutils literal notranslate"><span class="pre">legP()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.fluxes.mat_dot"><code class="docutils literal notranslate"><span class="pre">mat_dot()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.fluxes.numba_cumsum"><code class="docutils literal notranslate"><span class="pre">numba_cumsum()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.fluxes.pent_diag_solve"><code class="docutils literal notranslate"><span class="pre">pent_diag_solve()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.fluxes.planck_cgs_deprecate"><code class="docutils literal notranslate"><span class="pre">planck_cgs_deprecate()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.fluxes.planck_rad_deprecate"><code class="docutils literal notranslate"><span class="pre">planck_rad_deprecate()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.fluxes.set_bb_deprecate"><code class="docutils literal notranslate"><span class="pre">set_bb_deprecate()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.fluxes.setup_2_stream_fluxes"><code class="docutils literal notranslate"><span class="pre">setup_2_stream_fluxes()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.fluxes.setup_4_stream_fluxes"><code class="docutils literal notranslate"><span class="pre">setup_4_stream_fluxes()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.fluxes.setup_pent_diag"><code class="docutils literal notranslate"><span class="pre">setup_pent_diag()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.fluxes.setup_tri_diag"><code class="docutils literal notranslate"><span class="pre">setup_tri_diag()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.fluxes.slice_eq"><code class="docutils literal notranslate"><span class="pre">slice_eq()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.fluxes.slice_gt"><code class="docutils literal notranslate"><span class="pre">slice_gt()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.fluxes.slice_lt"><code class="docutils literal notranslate"><span class="pre">slice_lt()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.fluxes.slice_lt_cond"><code class="docutils literal notranslate"><span class="pre">slice_lt_cond()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.fluxes.slice_lt_cond_arr"><code class="docutils literal notranslate"><span class="pre">slice_lt_cond_arr()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.fluxes.slice_rav"><code class="docutils literal notranslate"><span class="pre">slice_rav()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.fluxes.solve_4_stream_banded"><code class="docutils literal notranslate"><span class="pre">solve_4_stream_banded()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.fluxes.spline_deprecate"><code class="docutils literal notranslate"><span class="pre">spline_deprecate()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.fluxes.tidal_flux"><code class="docutils literal notranslate"><span class="pre">tidal_flux()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.fluxes.tri_diag_solve"><code class="docutils literal notranslate"><span class="pre">tri_diag_solve()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.fluxes.vec_dot"><code class="docutils literal notranslate"><span class="pre">vec_dot()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-picaso.io_utils">picaso.io_utils module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#picaso.io_utils.read_hdf"><code class="docutils literal notranslate"><span class="pre">read_hdf()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.io_utils.read_json"><code class="docutils literal notranslate"><span class="pre">read_json()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.io_utils.read_visscher_2121"><code class="docutils literal notranslate"><span class="pre">read_visscher_2121()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.io_utils.write_all_profiles"><code class="docutils literal notranslate"><span class="pre">write_all_profiles()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-picaso.justdoit">picaso.justdoit module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#picaso.justdoit.HJ_cld"><code class="docutils literal notranslate"><span class="pre">HJ_cld()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.justdoit.HJ_pt"><code class="docutils literal notranslate"><span class="pre">HJ_pt()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.justdoit.HJ_pt_3d"><code class="docutils literal notranslate"><span class="pre">HJ_pt_3d()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.justdoit.SH_calculate_fluxes_options"><code class="docutils literal notranslate"><span class="pre">SH_calculate_fluxes_options()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.justdoit.SH_psingle_form_options"><code class="docutils literal notranslate"><span class="pre">SH_psingle_form_options()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.justdoit.SH_rayleigh_options"><code class="docutils literal notranslate"><span class="pre">SH_rayleigh_options()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.justdoit.SH_scattering_options"><code class="docutils literal notranslate"><span class="pre">SH_scattering_options()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.justdoit.all_planets"><code class="docutils literal notranslate"><span class="pre">all_planets()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.justdoit.brown_dwarf_cld"><code class="docutils literal notranslate"><span class="pre">brown_dwarf_cld()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.justdoit.brown_dwarf_pt"><code class="docutils literal notranslate"><span class="pre">brown_dwarf_pt()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.justdoit.check_units"><code class="docutils literal notranslate"><span class="pre">check_units()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.justdoit.convert_flux_units"><code class="docutils literal notranslate"><span class="pre">convert_flux_units()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.justdoit.evolution_track"><code class="docutils literal notranslate"><span class="pre">evolution_track()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.justdoit.find_press"><code class="docutils literal notranslate"><span class="pre">find_press()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.justdoit.get_contribution"><code class="docutils literal notranslate"><span class="pre">get_contribution()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.justdoit.get_targets"><code class="docutils literal notranslate"><span class="pre">get_targets()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.justdoit.input_xarray"><code class="docutils literal notranslate"><span class="pre">input_xarray()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.justdoit.inputs"><code class="docutils literal notranslate"><span class="pre">inputs</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#picaso.justdoit.inputs.phase_angle"><code class="docutils literal notranslate"><span class="pre">inputs.phase_angle</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#picaso.justdoit.inputs.gravity"><code class="docutils literal notranslate"><span class="pre">inputs.gravity</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#picaso.justdoit.inputs.star"><code class="docutils literal notranslate"><span class="pre">inputs.star</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#picaso.justdoit.inputs.atmosphere"><code class="docutils literal notranslate"><span class="pre">inputs.atmosphere</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#picaso.justdoit.inputs.clouds"><code class="docutils literal notranslate"><span class="pre">inputs.clouds</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#picaso.justdoit.inputs.approx"><code class="docutils literal notranslate"><span class="pre">inputs.approx</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#picaso.justdoit.inputs.spectrum"><code class="docutils literal notranslate"><span class="pre">inputs.spectrum</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#picaso.justdoit.inputs.TP_line_earth"><code class="docutils literal notranslate"><span class="pre">inputs.TP_line_earth()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#picaso.justdoit.inputs.T_eff"><code class="docutils literal notranslate"><span class="pre">inputs.T_eff()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#picaso.justdoit.inputs.add_pt"><code class="docutils literal notranslate"><span class="pre">inputs.add_pt()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#picaso.justdoit.inputs.adjust_quench_chemistry"><code class="docutils literal notranslate"><span class="pre">inputs.adjust_quench_chemistry()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id0"><code class="docutils literal notranslate"><span class="pre">inputs.approx()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id7"><code class="docutils literal notranslate"><span class="pre">inputs.atmosphere()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#picaso.justdoit.inputs.atmosphere_3d"><code class="docutils literal notranslate"><span class="pre">inputs.atmosphere_3d()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#picaso.justdoit.inputs.atmosphere_4d"><code class="docutils literal notranslate"><span class="pre">inputs.atmosphere_4d()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#picaso.justdoit.inputs.channon_grid_low"><code class="docutils literal notranslate"><span class="pre">inputs.channon_grid_low()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#picaso.justdoit.inputs.chem_interp"><code class="docutils literal notranslate"><span class="pre">inputs.chem_interp()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#picaso.justdoit.inputs.chemeq_3d"><code class="docutils literal notranslate"><span class="pre">inputs.chemeq_3d()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#picaso.justdoit.inputs.chemeq_visscher"><code class="docutils literal notranslate"><span class="pre">inputs.chemeq_visscher()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#picaso.justdoit.inputs.chemeq_visscher_1060"><code class="docutils literal notranslate"><span class="pre">inputs.chemeq_visscher_1060()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#picaso.justdoit.inputs.chemeq_visscher_2121"><code class="docutils literal notranslate"><span class="pre">inputs.chemeq_visscher_2121()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#picaso.justdoit.inputs.chemistry_handler"><code class="docutils literal notranslate"><span class="pre">inputs.chemistry_handler()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#picaso.justdoit.inputs.climate"><code class="docutils literal notranslate"><span class="pre">inputs.climate()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id10"><code class="docutils literal notranslate"><span class="pre">inputs.clouds()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#picaso.justdoit.inputs.clouds_3d"><code class="docutils literal notranslate"><span class="pre">inputs.clouds_3d()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#picaso.justdoit.inputs.clouds_4d"><code class="docutils literal notranslate"><span class="pre">inputs.clouds_4d()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#picaso.justdoit.inputs.clouds_reset"><code class="docutils literal notranslate"><span class="pre">inputs.clouds_reset()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#picaso.justdoit.inputs.cold_trap"><code class="docutils literal notranslate"><span class="pre">inputs.cold_trap()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#picaso.justdoit.inputs.effective_temp"><code class="docutils literal notranslate"><span class="pre">inputs.effective_temp()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#picaso.justdoit.inputs.energy_injection"><code class="docutils literal notranslate"><span class="pre">inputs.energy_injection()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#picaso.justdoit.inputs.find_kzz"><code class="docutils literal notranslate"><span class="pre">inputs.find_kzz()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id15"><code class="docutils literal notranslate"><span class="pre">inputs.gravity()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#picaso.justdoit.inputs.guillot_pt"><code class="docutils literal notranslate"><span class="pre">inputs.guillot_pt()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#picaso.justdoit.inputs.inputs_climate"><code class="docutils literal notranslate"><span class="pre">inputs.inputs_climate()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#picaso.justdoit.inputs.interpret_run"><code class="docutils literal notranslate"><span class="pre">inputs.interpret_run()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id16"><code class="docutils literal notranslate"><span class="pre">inputs.phase_angle()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#picaso.justdoit.inputs.phase_curve"><code class="docutils literal notranslate"><span class="pre">inputs.phase_curve()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#picaso.justdoit.inputs.phase_curve_geometry"><code class="docutils literal notranslate"><span class="pre">inputs.phase_curve_geometry()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#picaso.justdoit.inputs.photochem_init"><code class="docutils literal notranslate"><span class="pre">inputs.photochem_init()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#picaso.justdoit.inputs.premix_3d"><code class="docutils literal notranslate"><span class="pre">inputs.premix_3d()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#picaso.justdoit.inputs.premix_atmosphere"><code class="docutils literal notranslate"><span class="pre">inputs.premix_atmosphere()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#picaso.justdoit.inputs.premix_atmosphere_diseq_deprecate"><code class="docutils literal notranslate"><span class="pre">inputs.premix_atmosphere_diseq_deprecate()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#picaso.justdoit.inputs.premix_atmosphere_photochem"><code class="docutils literal notranslate"><span class="pre">inputs.premix_atmosphere_photochem()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#picaso.justdoit.inputs.premix_atmosphere_photochem_deprecate"><code class="docutils literal notranslate"><span class="pre">inputs.premix_atmosphere_photochem_deprecate()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#picaso.justdoit.inputs.pressure_grid"><code class="docutils literal notranslate"><span class="pre">inputs.pressure_grid()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#picaso.justdoit.inputs.setup_climate"><code class="docutils literal notranslate"><span class="pre">inputs.setup_climate()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#picaso.justdoit.inputs.setup_nostar"><code class="docutils literal notranslate"><span class="pre">inputs.setup_nostar()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#picaso.justdoit.inputs.sonora"><code class="docutils literal notranslate"><span class="pre">inputs.sonora()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id17"><code class="docutils literal notranslate"><span class="pre">inputs.spectrum()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id18"><code class="docutils literal notranslate"><span class="pre">inputs.star()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#picaso.justdoit.inputs.surface_reflect"><code class="docutils literal notranslate"><span class="pre">inputs.surface_reflect()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#picaso.justdoit.inputs.virga"><code class="docutils literal notranslate"><span class="pre">inputs.virga()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#picaso.justdoit.inputs.virga_3d"><code class="docutils literal notranslate"><span class="pre">inputs.virga_3d()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#picaso.justdoit.inputs.volatile_rainout"><code class="docutils literal notranslate"><span class="pre">inputs.volatile_rainout()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.justdoit.jupiter_cld"><code class="docutils literal notranslate"><span class="pre">jupiter_cld()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.justdoit.jupiter_pt"><code class="docutils literal notranslate"><span class="pre">jupiter_pt()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.justdoit.load_planet"><code class="docutils literal notranslate"><span class="pre">load_planet()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.justdoit.merge_xarrays"><code class="docutils literal notranslate"><span class="pre">merge_xarrays()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.justdoit.multi_phase_options"><code class="docutils literal notranslate"><span class="pre">multi_phase_options()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.justdoit.opannection"><code class="docutils literal notranslate"><span class="pre">opannection()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.justdoit.output_xarray"><code class="docutils literal notranslate"><span class="pre">output_xarray()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.justdoit.picaso"><code class="docutils literal notranslate"><span class="pre">picaso()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.justdoit.raman_options"><code class="docutils literal notranslate"><span class="pre">raman_options()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.justdoit.rt_methodology_options"><code class="docutils literal notranslate"><span class="pre">rt_methodology_options()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.justdoit.single_phase_options"><code class="docutils literal notranslate"><span class="pre">single_phase_options()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.justdoit.standard_metadata"><code class="docutils literal notranslate"><span class="pre">standard_metadata()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.justdoit.stream_options"><code class="docutils literal notranslate"><span class="pre">stream_options()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.justdoit.toon_phase_coefficients"><code class="docutils literal notranslate"><span class="pre">toon_phase_coefficients()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.justdoit.w17_data"><code class="docutils literal notranslate"><span class="pre">w17_data()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.justdoit.young_planets"><code class="docutils literal notranslate"><span class="pre">young_planets()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-picaso.justplotit">picaso.justplotit module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#picaso.justplotit.all_optics_1d"><code class="docutils literal notranslate"><span class="pre">all_optics_1d()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.justplotit.animate_convergence"><code class="docutils literal notranslate"><span class="pre">animate_convergence()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.justplotit.bin_errors"><code class="docutils literal notranslate"><span class="pre">bin_errors()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.justplotit.brightness_temperature"><code class="docutils literal notranslate"><span class="pre">brightness_temperature()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.justplotit.cloud"><code class="docutils literal notranslate"><span class="pre">cloud()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.justplotit.create_heat_map"><code class="docutils literal notranslate"><span class="pre">create_heat_map()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.justplotit.disco"><code class="docutils literal notranslate"><span class="pre">disco()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.justplotit.explore"><code class="docutils literal notranslate"><span class="pre">explore()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.justplotit.find_nearest_1d"><code class="docutils literal notranslate"><span class="pre">find_nearest_1d()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.justplotit.find_nearest_2d"><code class="docutils literal notranslate"><span class="pre">find_nearest_2d()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.justplotit.find_nearest_old"><code class="docutils literal notranslate"><span class="pre">find_nearest_old()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.justplotit.flux_at_top"><code class="docutils literal notranslate"><span class="pre">flux_at_top()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.justplotit.heatmap_taus"><code class="docutils literal notranslate"><span class="pre">heatmap_taus()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.justplotit.lon_lat_to_cartesian"><code class="docutils literal notranslate"><span class="pre">lon_lat_to_cartesian()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.justplotit.map"><code class="docutils literal notranslate"><span class="pre">map()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.justplotit.mean_regrid"><code class="docutils literal notranslate"><span class="pre">mean_regrid()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.justplotit.mixing_ratio"><code class="docutils literal notranslate"><span class="pre">mixing_ratio()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.justplotit.molecule_contribution"><code class="docutils literal notranslate"><span class="pre">molecule_contribution()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.justplotit.numba_cumsum"><code class="docutils literal notranslate"><span class="pre">numba_cumsum()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.justplotit.phase_curve"><code class="docutils literal notranslate"><span class="pre">phase_curve()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.justplotit.phase_snaps"><code class="docutils literal notranslate"><span class="pre">phase_snaps()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.justplotit.photon_attenuation"><code class="docutils literal notranslate"><span class="pre">photon_attenuation()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.justplotit.plot_cld_input"><code class="docutils literal notranslate"><span class="pre">plot_cld_input()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.justplotit.plot_errorbar"><code class="docutils literal notranslate"><span class="pre">plot_errorbar()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.justplotit.plot_evolution"><code class="docutils literal notranslate"><span class="pre">plot_evolution()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.justplotit.plot_format"><code class="docutils literal notranslate"><span class="pre">plot_format()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.justplotit.plot_multierror"><code class="docutils literal notranslate"><span class="pre">plot_multierror()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.justplotit.pt"><code class="docutils literal notranslate"><span class="pre">pt()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.justplotit.pt_adiabat"><code class="docutils literal notranslate"><span class="pre">pt_adiabat()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.justplotit.rt_heatmap"><code class="docutils literal notranslate"><span class="pre">rt_heatmap()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.justplotit.spectrum"><code class="docutils literal notranslate"><span class="pre">spectrum()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.justplotit.spectrum_hires"><code class="docutils literal notranslate"><span class="pre">spectrum_hires()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.justplotit.taumap"><code class="docutils literal notranslate"><span class="pre">taumap()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.justplotit.thermal_contribution"><code class="docutils literal notranslate"><span class="pre">thermal_contribution()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.justplotit.transmission_contribution"><code class="docutils literal notranslate"><span class="pre">transmission_contribution()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-picaso.opacity_factory">picaso.opacity_factory module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#picaso.opacity_factory.adapt_array"><code class="docutils literal notranslate"><span class="pre">adapt_array()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.opacity_factory.add_all_metadata"><code class="docutils literal notranslate"><span class="pre">add_all_metadata()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.opacity_factory.add_metadata_item"><code class="docutils literal notranslate"><span class="pre">add_metadata_item()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.opacity_factory.add_metadata_table"><code class="docutils literal notranslate"><span class="pre">add_metadata_table()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.opacity_factory.are_arrays_different"><code class="docutils literal notranslate"><span class="pre">are_arrays_different()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.opacity_factory.build_skeleton"><code class="docutils literal notranslate"><span class="pre">build_skeleton()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.opacity_factory.compute_ck_molecular"><code class="docutils literal notranslate"><span class="pre">compute_ck_molecular()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.opacity_factory.compute_sum_molecular"><code class="docutils literal notranslate"><span class="pre">compute_sum_molecular()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.opacity_factory.continuum_avail"><code class="docutils literal notranslate"><span class="pre">continuum_avail()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.opacity_factory.convert_array"><code class="docutils literal notranslate"><span class="pre">convert_array()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.opacity_factory.create_grid"><code class="docutils literal notranslate"><span class="pre">create_grid()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.opacity_factory.create_grid_minR"><code class="docutils literal notranslate"><span class="pre">create_grid_minR()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.opacity_factory.delete_molecule"><code class="docutils literal notranslate"><span class="pre">delete_molecule()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.opacity_factory.find_nearest"><code class="docutils literal notranslate"><span class="pre">find_nearest()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.opacity_factory.find_nearest_1d"><code class="docutils literal notranslate"><span class="pre">find_nearest_1d()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.opacity_factory.fit_linsky"><code class="docutils literal notranslate"><span class="pre">fit_linsky()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.opacity_factory.func_read_gas"><code class="docutils literal notranslate"><span class="pre">func_read_gas()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.opacity_factory.g_w_2gauss"><code class="docutils literal notranslate"><span class="pre">g_w_2gauss()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.opacity_factory.get_all_metadata"><code class="docutils literal notranslate"><span class="pre">get_all_metadata()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.opacity_factory.get_ck_tables"><code class="docutils literal notranslate"><span class="pre">get_ck_tables()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.opacity_factory.get_continuum"><code class="docutils literal notranslate"><span class="pre">get_continuum()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.opacity_factory.get_h2minus"><code class="docutils literal notranslate"><span class="pre">get_h2minus()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.opacity_factory.get_hminusbf"><code class="docutils literal notranslate"><span class="pre">get_hminusbf()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.opacity_factory.get_hminusff"><code class="docutils literal notranslate"><span class="pre">get_hminusff()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.opacity_factory.get_kark_CH4"><code class="docutils literal notranslate"><span class="pre">get_kark_CH4()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.opacity_factory.get_kark_CH4_noTdependence"><code class="docutils literal notranslate"><span class="pre">get_kark_CH4_noTdependence()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.opacity_factory.get_metadata_item"><code class="docutils literal notranslate"><span class="pre">get_metadata_item()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.opacity_factory.get_molecular"><code class="docutils literal notranslate"><span class="pre">get_molecular()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.opacity_factory.get_optical_o3"><code class="docutils literal notranslate"><span class="pre">get_optical_o3()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.opacity_factory.get_original_data"><code class="docutils literal notranslate"><span class="pre">get_original_data()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.opacity_factory.get_wvno_grid"><code class="docutils literal notranslate"><span class="pre">get_wvno_grid()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.opacity_factory.h2h2_overtone"><code class="docutils literal notranslate"><span class="pre">h2h2_overtone()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.opacity_factory.insert"><code class="docutils literal notranslate"><span class="pre">insert()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.opacity_factory.insert_hitran_cia"><code class="docutils literal notranslate"><span class="pre">insert_hitran_cia()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.opacity_factory.insert_molecular_1060"><code class="docutils literal notranslate"><span class="pre">insert_molecular_1060()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.opacity_factory.insert_molecular_1460"><code class="docutils literal notranslate"><span class="pre">insert_molecular_1460()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.opacity_factory.insert_wno_grid"><code class="docutils literal notranslate"><span class="pre">insert_wno_grid()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.opacity_factory.listdir"><code class="docutils literal notranslate"><span class="pre">listdir()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.opacity_factory.molecular_avail"><code class="docutils literal notranslate"><span class="pre">molecular_avail()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.opacity_factory.open_local"><code class="docutils literal notranslate"><span class="pre">open_local()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.opacity_factory.regrid"><code class="docutils literal notranslate"><span class="pre">regrid()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.opacity_factory.restruct_continuum"><code class="docutils literal notranslate"><span class="pre">restruct_continuum()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.opacity_factory.restructure_opacity"><code class="docutils literal notranslate"><span class="pre">restructure_opacity()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.opacity_factory.vectorize_rebin_mean"><code class="docutils literal notranslate"><span class="pre">vectorize_rebin_mean()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.opacity_factory.vectorize_rebin_median"><code class="docutils literal notranslate"><span class="pre">vectorize_rebin_median()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.opacity_factory.vresample_and_insert_molecular"><code class="docutils literal notranslate"><span class="pre">vresample_and_insert_molecular()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-picaso.optics">picaso.optics module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#picaso.optics.RetrieveCKs"><code class="docutils literal notranslate"><span class="pre">RetrieveCKs</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#picaso.optics.RetrieveCKs.adapt_array"><code class="docutils literal notranslate"><span class="pre">RetrieveCKs.adapt_array()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#picaso.optics.RetrieveCKs.convert_array"><code class="docutils literal notranslate"><span class="pre">RetrieveCKs.convert_array()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#picaso.optics.RetrieveCKs.get_available_continuum"><code class="docutils literal notranslate"><span class="pre">RetrieveCKs.get_available_continuum()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#picaso.optics.RetrieveCKs.get_available_rayleigh"><code class="docutils literal notranslate"><span class="pre">RetrieveCKs.get_available_rayleigh()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#picaso.optics.RetrieveCKs.get_continuum"><code class="docutils literal notranslate"><span class="pre">RetrieveCKs.get_continuum()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#picaso.optics.RetrieveCKs.get_gauss_pts_661_1460_deprecate"><code class="docutils literal notranslate"><span class="pre">RetrieveCKs.get_gauss_pts_661_1460_deprecate()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#picaso.optics.RetrieveCKs.get_h5_data"><code class="docutils literal notranslate"><span class="pre">RetrieveCKs.get_h5_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#picaso.optics.RetrieveCKs.get_legacy_data_1060"><code class="docutils literal notranslate"><span class="pre">RetrieveCKs.get_legacy_data_1060()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#picaso.optics.RetrieveCKs.get_legacy_data_1460"><code class="docutils literal notranslate"><span class="pre">RetrieveCKs.get_legacy_data_1460()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#picaso.optics.RetrieveCKs.get_mixing_indices"><code class="docutils literal notranslate"><span class="pre">RetrieveCKs.get_mixing_indices()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#picaso.optics.RetrieveCKs.get_new_wvno_grid_661"><code class="docutils literal notranslate"><span class="pre">RetrieveCKs.get_new_wvno_grid_661()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#picaso.optics.RetrieveCKs.get_opacities_deq_deprecate"><code class="docutils literal notranslate"><span class="pre">RetrieveCKs.get_opacities_deq_deprecate()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#picaso.optics.RetrieveCKs.get_opacities_deq_onfly"><code class="docutils literal notranslate"><span class="pre">RetrieveCKs.get_opacities_deq_onfly()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#picaso.optics.RetrieveCKs.get_opacities_preweighted"><code class="docutils literal notranslate"><span class="pre">RetrieveCKs.get_opacities_preweighted()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#picaso.optics.RetrieveCKs.get_pre_mix_ck"><code class="docutils literal notranslate"><span class="pre">RetrieveCKs.get_pre_mix_ck()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#picaso.optics.RetrieveCKs.get_pre_mix_ck_nearest"><code class="docutils literal notranslate"><span class="pre">RetrieveCKs.get_pre_mix_ck_nearest()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#picaso.optics.RetrieveCKs.load_kcoeff_arrays_deprecate"><code class="docutils literal notranslate"><span class="pre">RetrieveCKs.load_kcoeff_arrays_deprecate()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#picaso.optics.RetrieveCKs.load_kcoeff_arrays_first"><code class="docutils literal notranslate"><span class="pre">RetrieveCKs.load_kcoeff_arrays_first()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#picaso.optics.RetrieveCKs.mix_my_opacities_deprecate"><code class="docutils literal notranslate"><span class="pre">RetrieveCKs.mix_my_opacities_deprecate()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#picaso.optics.RetrieveCKs.mix_my_opacities_gasesfly"><code class="docutils literal notranslate"><span class="pre">RetrieveCKs.mix_my_opacities_gasesfly()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#picaso.optics.RetrieveCKs.open_local"><code class="docutils literal notranslate"><span class="pre">RetrieveCKs.open_local()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#picaso.optics.RetrieveCKs.run_cia_spline_661_deprecate"><code class="docutils literal notranslate"><span class="pre">RetrieveCKs.run_cia_spline_661_deprecate()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#picaso.optics.RetrieveCKs.run_cia_spline_deprecate"><code class="docutils literal notranslate"><span class="pre">RetrieveCKs.run_cia_spline_deprecate()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.optics.RetrieveOpacities"><code class="docutils literal notranslate"><span class="pre">RetrieveOpacities</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#picaso.optics.RetrieveOpacities.raman_db"><code class="docutils literal notranslate"><span class="pre">RetrieveOpacities.raman_db</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#picaso.optics.RetrieveOpacities.wno"><code class="docutils literal notranslate"><span class="pre">RetrieveOpacities.wno</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#picaso.optics.RetrieveOpacities.wave"><code class="docutils literal notranslate"><span class="pre">RetrieveOpacities.wave</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#picaso.optics.RetrieveOpacities.nwno"><code class="docutils literal notranslate"><span class="pre">RetrieveOpacities.nwno</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#picaso.optics.RetrieveOpacities.cia_temps"><code class="docutils literal notranslate"><span class="pre">RetrieveOpacities.cia_temps</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#picaso.optics.RetrieveOpacities.molecules"><code class="docutils literal notranslate"><span class="pre">RetrieveOpacities.molecules</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#picaso.optics.RetrieveOpacities.pt_pairs"><code class="docutils literal notranslate"><span class="pre">RetrieveOpacities.pt_pairs</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#picaso.optics.RetrieveOpacities.molecular_opa"><code class="docutils literal notranslate"><span class="pre">RetrieveOpacities.molecular_opa</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#picaso.optics.RetrieveOpacities.continuum_opa"><code class="docutils literal notranslate"><span class="pre">RetrieveOpacities.continuum_opa</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#picaso.optics.RetrieveOpacities.rayleigh_opa"><code class="docutils literal notranslate"><span class="pre">RetrieveOpacities.rayleigh_opa</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#picaso.optics.RetrieveOpacities.query_method"><code class="docutils literal notranslate"><span class="pre">RetrieveOpacities.query_method</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#picaso.optics.RetrieveOpacities.db_connect"><code class="docutils literal notranslate"><span class="pre">RetrieveOpacities.db_connect()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#picaso.optics.RetrieveOpacities.open_local"><code class="docutils literal notranslate"><span class="pre">RetrieveOpacities.open_local()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#picaso.optics.RetrieveOpacities.get_available_data"><code class="docutils literal notranslate"><span class="pre">RetrieveOpacities.get_available_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#picaso.optics.RetrieveOpacities.get_available_rayleigh"><code class="docutils literal notranslate"><span class="pre">RetrieveOpacities.get_available_rayleigh()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#picaso.optics.RetrieveOpacities.get_opacities"><code class="docutils literal notranslate"><span class="pre">RetrieveOpacities.get_opacities()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#picaso.optics.RetrieveOpacities.adapt_array"><code class="docutils literal notranslate"><span class="pre">RetrieveOpacities.adapt_array()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#picaso.optics.RetrieveOpacities.compute_stellar_shits"><code class="docutils literal notranslate"><span class="pre">RetrieveOpacities.compute_stellar_shits()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#picaso.optics.RetrieveOpacities.convert_array"><code class="docutils literal notranslate"><span class="pre">RetrieveOpacities.convert_array()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#picaso.optics.RetrieveOpacities.find_needed_pts"><code class="docutils literal notranslate"><span class="pre">RetrieveOpacities.find_needed_pts()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id20"><code class="docutils literal notranslate"><span class="pre">RetrieveOpacities.get_available_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id21"><code class="docutils literal notranslate"><span class="pre">RetrieveOpacities.get_available_rayleigh()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id22"><code class="docutils literal notranslate"><span class="pre">RetrieveOpacities.get_opacities()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#picaso.optics.RetrieveOpacities.get_opacities_nearest"><code class="docutils literal notranslate"><span class="pre">RetrieveOpacities.get_opacities_nearest()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id23"><code class="docutils literal notranslate"><span class="pre">RetrieveOpacities.open_local()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#picaso.optics.RetrieveOpacities.preload_opacities"><code class="docutils literal notranslate"><span class="pre">RetrieveOpacities.preload_opacities()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.optics.adapt_array"><code class="docutils literal notranslate"><span class="pre">adapt_array()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.optics.bin_star"><code class="docutils literal notranslate"><span class="pre">bin_star()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.optics.compute_opacity"><code class="docutils literal notranslate"><span class="pre">compute_opacity()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.optics.compute_raman"><code class="docutils literal notranslate"><span class="pre">compute_raman()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.optics.convert_array"><code class="docutils literal notranslate"><span class="pre">convert_array()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.optics.find_nearest"><code class="docutils literal notranslate"><span class="pre">find_nearest()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.optics.interp_matrix"><code class="docutils literal notranslate"><span class="pre">interp_matrix()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.optics.j_fraction"><code class="docutils literal notranslate"><span class="pre">j_fraction()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.optics.numba_cumsum"><code class="docutils literal notranslate"><span class="pre">numba_cumsum()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.optics.partition_function"><code class="docutils literal notranslate"><span class="pre">partition_function()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.optics.partition_sum"><code class="docutils literal notranslate"><span class="pre">partition_sum()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.optics.raman_pollack"><code class="docutils literal notranslate"><span class="pre">raman_pollack()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.optics.rayleigh_old"><code class="docutils literal notranslate"><span class="pre">rayleigh_old()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.optics.spline"><code class="docutils literal notranslate"><span class="pre">spline()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#picaso-test-module">picaso.test module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-picaso.wavelength">picaso.wavelength module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#picaso.wavelength.get_cld_input_grid"><code class="docutils literal notranslate"><span class="pre">get_cld_input_grid()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#picaso.wavelength.regrid"><code class="docutils literal notranslate"><span class="pre">regrid()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-picaso">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="contribution.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="workshops.html">Workshop Material</a></li>
<li class="toctree-l1"><a class="reference external" href="https://natashabatalha.github.io/picaso_dev">The Derivations</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/natashabatalha/picaso">Github</a></li>
<li class="toctree-l1"><a class="reference internal" href="credit.html">What to Cite</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">picaso</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">The Code</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/picaso.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="the-code">
<h1>The Code<a class="headerlink" href="#the-code" title="Link to this heading"></a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading"></a></h2>
</section>
<section id="module-picaso.atmsetup">
<span id="picaso-atmsetup-module"></span><h2>picaso.atmsetup module<a class="headerlink" href="#module-picaso.atmsetup" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="picaso.atmsetup.ATMSETUP">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">picaso.atmsetup.</span></span><span class="sig-name descname"><span class="pre">ATMSETUP</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.atmsetup.ATMSETUP" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Reads in default source configuration from JSON and creates a full atmosphere class.</p>
<ul class="simple">
<li><p>Gets PT profile</p></li>
<li><p>Computes mean molecular weight, density, column density, mixing ratios</p></li>
<li><p>Gets cloud profile</p></li>
<li><p>Gets stellar profile</p></li>
</ul>
<dl class="py method">
<dt class="sig sig-object py" id="picaso.atmsetup.ATMSETUP.add_warnings">
<span class="sig-name descname"><span class="pre">add_warnings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">warn</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.atmsetup.ATMSETUP.add_warnings" title="Link to this definition"></a></dt>
<dd><p>Accumulate warnings from ATMSETUP</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="picaso.atmsetup.ATMSETUP.as_dict">
<span class="sig-name descname"><span class="pre">as_dict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.atmsetup.ATMSETUP.as_dict" title="Link to this definition"></a></dt>
<dd><p>Get output into picklable dict format</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="picaso.atmsetup.ATMSETUP.calc_PT">
<span class="sig-name descname"><span class="pre">calc_PT</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logPc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logKir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logg1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.atmsetup.ATMSETUP.calc_PT" title="Link to this definition"></a></dt>
<dd><p>Calculates parameterized PT profile from Guillot. This isntance is here
primary for the retrieval scheme, so this can be updated</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>T</strong> (<em>float</em>)</p></li>
<li><p><strong>logKir</strong> (<em>float</em>)</p></li>
<li><p><strong>logg1</strong> (<em>float</em>)</p></li>
<li><p><strong>logPc</strong> (<em>float</em>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="picaso.atmsetup.ATMSETUP.disect">
<span class="sig-name descname"><span class="pre">disect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">g</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.atmsetup.ATMSETUP.disect" title="Link to this definition"></a></dt>
<dd><p>This disects the 3d input to a 1d input which is a function of a single gangle and tangle.
This makes it possible for us to get the opacities at each facet before we go into the
flux calculation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>g</strong> (<em>int</em>)  Gauss angle index</p></li>
<li><p><strong>t</strong> (<em>int</em>)  Tchebyshev angle index</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="picaso.atmsetup.ATMSETUP.get_altitude">
<span class="sig-name descname"><span class="pre">get_altitude</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p_reference</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constant_gravity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.atmsetup.ATMSETUP.get_altitude" title="Link to this definition"></a></dt>
<dd><p>Calculates z and gravity</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>p_reference</strong> (<em>float</em>)  Reference pressure for radius. (bars)</p></li>
<li><p><strong>constant_gravity</strong> (<em>bool</em>)  creates zero altitude dependence in the height</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="picaso.atmsetup.ATMSETUP.get_altitude_deprecate">
<span class="sig-name descname"><span class="pre">get_altitude_deprecate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p_reference</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constant_gravity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.atmsetup.ATMSETUP.get_altitude_deprecate" title="Link to this definition"></a></dt>
<dd><p>Calculates z and gravity</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>p_reference</strong> (<em>float</em>)  Reference pressure for radius. (bars)</p></li>
<li><p><strong>constant_gravity</strong> (<em>bool</em>)  creates zero altitude dependence in the height</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="picaso.atmsetup.ATMSETUP.get_clouds">
<span class="sig-name descname"><span class="pre">get_clouds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wno</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.atmsetup.ATMSETUP.get_clouds" title="Link to this definition"></a></dt>
<dd><p>Get cloud properties from .cld input returned from eddysed. The eddysed file should have the following specifications</p>
<ol class="arabic simple">
<li><p>Have the following column names (any order)  opd g0 w0</p></li>
<li><p>Be white space delimeted</p></li>
<li><p>Has to have values for pressure levels (N) and wwavenumbers (M). The row order should go:</p></li>
</ol>
<p>level wavenumber opd w0 g0
1.   1.    . .
1.   2.    . .
1.   3.    . .
.     .  . .
.     .  . .
1.   M.    . .
2.   1.    . .
.     .  . .
N.   .   . .</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The order of the rows is very important because each column will be transformed
into a matrix that has the size: [nlayer,nwave].</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>wno</strong> (<em>array</em>)  Array in ascending order of wavenumbers. This is used to regrid the cloud output</p>
</dd>
</dl>
<div class="admonition-todo admonition" id="id1">
<p class="admonition-title">Todo</p>
<ul class="simple">
<li><p>Take regridding out of here and add it to <cite>justdoit</cite></p></li>
</ul>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="picaso.atmsetup.ATMSETUP.get_column_density">
<span class="sig-name descname"><span class="pre">get_column_density</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.atmsetup.ATMSETUP.get_column_density" title="Link to this definition"></a></dt>
<dd><p>Calculates the column desntiy based on TP profile: LAYER
unit = g/cm2 = pressure/gravity =dyne/cm2/gravity = (g*cm/s2)/cm2/(cm/s2)=g/cm2</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="picaso.atmsetup.ATMSETUP.get_constants">
<span class="sig-name descname"><span class="pre">get_constants</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.atmsetup.ATMSETUP.get_constants" title="Link to this definition"></a></dt>
<dd><p>This function gets all conversion factors based on input units and all
constants. Goal here is to get everything to cgs and make sure we are only
call lengths of things once (e.g. number of wavelength points, number of layers etc)</p>
<p>Some stuff will be added to this in other routines (e.g. number of layers)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="picaso.atmsetup.ATMSETUP.get_density">
<span class="sig-name descname"><span class="pre">get_density</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.atmsetup.ATMSETUP.get_density" title="Link to this definition"></a></dt>
<dd><p>Calculates density of atmospheres used on TP profile: LEVEL
units of cm-3</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="picaso.atmsetup.ATMSETUP.get_dtdp">
<span class="sig-name descname"><span class="pre">get_dtdp</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.atmsetup.ATMSETUP.get_dtdp" title="Link to this definition"></a></dt>
<dd><p>Calculates density of atmospheres used on TP profile: LEVEL
units of cm-3</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="picaso.atmsetup.ATMSETUP.get_mmw">
<span class="sig-name descname"><span class="pre">get_mmw</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.atmsetup.ATMSETUP.get_mmw" title="Link to this definition"></a></dt>
<dd><p>Returns the mean molecular weight of the atmosphere</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="picaso.atmsetup.ATMSETUP.get_needed_continuum">
<span class="sig-name descname"><span class="pre">get_needed_continuum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">available_ray_mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">available_continuum</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.atmsetup.ATMSETUP.get_needed_continuum" title="Link to this definition"></a></dt>
<dd><p>This will define which molecules are needed for the continuum opacities.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>available_ray_mol</strong> (<em>list</em><em> of </em><em>str</em>)  list of available rayleigh molecules</p></li>
<li><p><strong>available_continuum</strong> (<em>list</em><em> of </em><em>str</em>)  list of available continuum molecules</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="picaso.atmsetup.ATMSETUP.get_profile">
<span class="sig-name descname"><span class="pre">get_profile</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.atmsetup.ATMSETUP.get_profile" title="Link to this definition"></a></dt>
<dd><p>Get profile from file or from user input file or direct pandas dataframe. If PT profile
is not given, use parameterization</p>
<p>Currently only needs inputs from config file</p>
<div class="admonition-todo admonition" id="id2">
<p class="admonition-title">Todo</p>
<ul class="simple">
<li><p>Add regridding to this by having users be able to set a different nlevel than the input cloud code is</p></li>
</ul>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="picaso.atmsetup.ATMSETUP.get_profile_3d">
<span class="sig-name descname"><span class="pre">get_profile_3d</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.atmsetup.ATMSETUP.get_profile_3d" title="Link to this definition"></a></dt>
<dd><p>Get profile from file or from user input file or direct pandas dataframe. If PT profile
is not given, use parameterization</p>
<p>Currently only needs inputs from config file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lat</strong> (<em>array</em>)  Array of latitudes (radians)</p></li>
<li><p><strong>lon</strong> (<em>array</em>)  Array of longitudes (radians)</p></li>
</ul>
</dd>
</dl>
<div class="admonition-todo admonition" id="id3">
<p class="admonition-title">Todo</p>
<ul class="simple">
<li><p>Add regridding to this by having users be able to set a different nlevel than the input cloud code is</p></li>
</ul>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="picaso.atmsetup.ATMSETUP.get_surf_reflect">
<span class="sig-name descname"><span class="pre">get_surf_reflect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nwno</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.atmsetup.ATMSETUP.get_surf_reflect" title="Link to this definition"></a></dt>
<dd><p>Gets the surface reflectivity from input</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="picaso.atmsetup.ATMSETUP.get_weights">
<span class="sig-name descname"><span class="pre">get_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecule</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.atmsetup.ATMSETUP.get_weights" title="Link to this definition"></a></dt>
<dd><p>Automatically gets mean molecular weights of any molecule. Requires that
user inputs case sensitive molecules i.e. TiO instead of TIO.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>molecule</strong> (<em>str</em><em> or </em><em>list</em>)  any molecule string e.g. H2O, CH4 etc TiO or [H2O, CH4]
Isotopologues should be specified with a dash separating the
elemtents. E.g. 12C-16O2 or 13C-16O2. If you only want to specify one
then you would have 12C-O2.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>molecule as keys with molecular weights as value</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.atmsetup.convert_to_simple">
<span class="sig-prename descclassname"><span class="pre">picaso.atmsetup.</span></span><span class="sig-name descname"><span class="pre">convert_to_simple</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iso_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.atmsetup.convert_to_simple" title="Link to this definition"></a></dt>
<dd><p>Converts iso name (e.g. 13C-16O2 to CO2)
Returns same name if not (e.g. CO2 gives CO2)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.atmsetup.separate_molecule_name">
<span class="sig-prename descclassname"><span class="pre">picaso.atmsetup.</span></span><span class="sig-name descname"><span class="pre">separate_molecule_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecule_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.atmsetup.separate_molecule_name" title="Link to this definition"></a></dt>
<dd><p>used for separating molecules
For example, CO2 becomes C O2</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.atmsetup.separate_string_number">
<span class="sig-prename descclassname"><span class="pre">picaso.atmsetup.</span></span><span class="sig-name descname"><span class="pre">separate_string_number</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">string</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.atmsetup.separate_string_number" title="Link to this definition"></a></dt>
<dd><p>used for separating numbers from molecules
For example, CO2 becomes C O2 in <cite>separate_molecule_name</cite>
then this function turns it into [[C],[O,2]]</p>
</dd></dl>

</section>
<section id="module-picaso.build_3d_input">
<span id="picaso-build-3d-input-module"></span><h2>picaso.build_3d_input module<a class="headerlink" href="#module-picaso.build_3d_input" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="picaso.build_3d_input.lon_lat_to_cartesian">
<span class="sig-prename descclassname"><span class="pre">picaso.build_3d_input.</span></span><span class="sig-name descname"><span class="pre">lon_lat_to_cartesian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">R</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.build_3d_input.lon_lat_to_cartesian" title="Link to this definition"></a></dt>
<dd><p>Calculates lon, lat coordinates of a point on a sphere with
radius R</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lon</strong> (<em>array</em>)  Longitude</p></li>
<li><p><strong>lat</strong> (<em>array</em>)  Latitude</p></li>
<li><p><strong>R</strong> (<em>float</em>)  radius of sphere</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>x, y, z</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.build_3d_input.make_3d_cld_input">
<span class="sig-prename descclassname"><span class="pre">picaso.build_3d_input.</span></span><span class="sig-name descname"><span class="pre">make_3d_cld_input</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ng</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase_angle</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lon_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rand_coverage</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.build_3d_input.make_3d_cld_input" title="Link to this definition"></a></dt>
<dd><p>Discontinued
Program to create 3d CLOUD input. Used to feed GCM input into disco ball.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ng</strong> (<em>int</em>)  Number of gauss angles</p></li>
<li><p><strong>nt</strong> (<em>int</em>)  Number of Tchebysehv angles</p></li>
<li><p><strong>phase_angle</strong> (<em>float</em>)  Geometry of phase angle</p></li>
<li><p><strong>input_file</strong> (<em>str</em>)  CLD input file you want to create the 3d grid from. Currently takes in a single 1d CLD profile.
Input file must be structured with the following columns in the correct order: [lvl, wv,opd,g0,w0,sigma]
input file</p></li>
<li><p><strong>output_file</strong> (<em>str</em>)  Output file location</p></li>
<li><p><strong>lat_range</strong> (<em>list</em>)  (Optional)Range of latitudes to exclude in the CLD file</p></li>
<li><p><strong>lon_range</strong> (<em>list</em>)  (Optional)Range of longitudes to exclud in the CLD file</p></li>
<li><p><strong>rand_coverage</strong> (<em>float</em>)  (Optional)Fractional cloud coverage. rand_cov=1 introduces full cloud coverage. rand_cov=0 has no
coverage.</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em>)  Key word arguments used for <cite>panads.read_csv</cite></p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Creates output file. No other returns.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Basic use of creating a 3D file:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">phase_angle</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">number_gauss_angles</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">number_tcheby_angles</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">phase_angle</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">input_file</span><span class="o">=</span><span class="n">jdi</span><span class="o">.</span><span class="n">jupiter_cld</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output_file</span><span class="o">=</span><span class="s1">&#39;jupiter3D.hdf5&#39;</span>
<span class="go">&gt;&gt;&gt;make_3d_pt_input(number_gauss_angles, number_tcheby_angles,</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">phase_angle</span><span class="p">,</span> <span class="n">input_file</span><span class="p">,</span><span class="n">output_file</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.build_3d_input.make_3d_pt_input">
<span class="sig-prename descclassname"><span class="pre">picaso.build_3d_input.</span></span><span class="sig-name descname"><span class="pre">make_3d_pt_input</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ng</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase_angle</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_file</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.build_3d_input.make_3d_pt_input" title="Link to this definition"></a></dt>
<dd><p>Discontinued
Program to create 3d PT input. Used to feed GCM input into disco ball.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ng</strong> (<em>int</em>)  Number of gauss angles</p></li>
<li><p><strong>nt</strong> (<em>int</em>)  Number of Tchebysehv angles</p></li>
<li><p><strong>phase_angle</strong> (<em>float</em>)  Geometry of phase angle</p></li>
<li><p><strong>input_file</strong> (<em>str</em>)  PT input file you want to create the 3d grid from. Currently takes in a single 1d PT profile.
Must have labeled, whitespace delimeted columns. In the columns, must have <cite>temperature</cite>,
<cite>pressure</cite>, and at least some molecular species (which are ALL case-sensitive)</p></li>
<li><p><strong>output_file</strong> (<em>str</em>)  Output file location</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Creates output file. No other returns.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Basic use of creating a 3D file:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">phase_angle</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">number_gauss_angles</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">number_tcheby_angles</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">phase_angle</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">input_file</span><span class="o">=</span><span class="n">jdi</span><span class="o">.</span><span class="n">jupiter_pt</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output_file</span><span class="o">=</span><span class="s1">&#39;jupiter3D.hdf5&#39;</span>
<span class="go">&gt;&gt;&gt;make_3d_pt_input(number_gauss_angles, number_tcheby_angles,</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">phase_angle</span><span class="p">,</span> <span class="n">input_file</span><span class="p">,</span><span class="n">output_file</span><span class="p">)</span>
</pre></div>
</div>
<p>Can also use <cite>**kwargs</cite> to control how pandas reads in input file</p>
<p>&gt;&gt;&gt;make_3d_pt_input(number_gauss_angles, number_tcheby_angles,
&gt;&gt;&gt;         phase_angle, input_file,output_file,usecols=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,20,21])</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.build_3d_input.rebin_mitgcm_cld">
<span class="sig-prename descclassname"><span class="pre">picaso.build_3d_input.</span></span><span class="sig-name descname"><span class="pre">rebin_mitgcm_cld</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ng</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase_angle</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['i',</span> <span class="pre">'j',</span> <span class="pre">'opd',</span> <span class="pre">'g0',</span> <span class="pre">'w0']</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.build_3d_input.rebin_mitgcm_cld" title="Link to this definition"></a></dt>
<dd><p>Rebin post processed GCM cloud grid to a smaller grid. This function creates a pickle file
that can be directly input into <cite>clouds_3d</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ng</strong> (<em>int</em>)  Number of gauss angles</p></li>
<li><p><strong>nt</strong> (<em>int</em>)  Number of Tchebysehv angles</p></li>
<li><p><strong>phase_angle</strong> (<em>float</em>)  Geometry of phase angle (radians)</p></li>
<li><p><strong>input_file</strong> (<em>str</em>)  PT input file you want to create the 3d grid from. Currently takes in a single 1d PT profile.
Must have labeled, whitespace delimeted columns. In the columns, must have <cite>temperature</cite>,
<cite>pressure</cite>, and at least some molecular species (which are ALL case-sensitive)</p></li>
<li><p><strong>output_file</strong> (<em>str</em>)  output file location</p></li>
<li><p><strong>names</strong> (<em>list</em><em>,</em><em>str</em><em>,</em><em>optional</em>)  List of names for the post processed file. The Default value is what generallly
comes out of A&amp;M code.. But double check before running!!</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.build_3d_input.rebin_mitgcm_pt">
<span class="sig-prename descclassname"><span class="pre">picaso.build_3d_input.</span></span><span class="sig-name descname"><span class="pre">rebin_mitgcm_pt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ng</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase_angle</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Pa'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kzz_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'m*m/s'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">run_chem</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">MH</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">CtoO</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.build_3d_input.rebin_mitgcm_pt" title="Link to this definition"></a></dt>
<dd><p>Rebin GCM grid to a smaller grid. This function creates a pickle file
that can be directly input into <cite>atmosphere_3d</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ng</strong> (<em>int</em>)  Number of gauss angles</p></li>
<li><p><strong>nt</strong> (<em>int</em>)  Number of Tchebysehv angles</p></li>
<li><p><strong>phase_angle</strong> (<em>float</em>)  Geometry of phase angle (radians)</p></li>
<li><p><strong>input_file</strong> (<em>str</em>)  PT input file you want to create the 3d grid from. Currently takes in a single 1d PT profile.
Must have labeled, whitespace delimeted columns. In the columns, must have <cite>temperature</cite>,
<cite>pressure</cite>, and at least some molecular species (which are ALL case-sensitive)</p></li>
<li><p><strong>output_file</strong> (<em>str</em>)  output file location</p></li>
<li><p><strong>p_unit</strong> (<em>str</em><em>,</em><em>optional</em>)  Pressure Unit (default Pascal)</p></li>
<li><p><strong>kzz_unit</strong> (<em>str</em><em>,</em><em>optional</em>)  Kzz Unit (default is m*m/s)</p></li>
<li><p><strong>run_chem</strong> (<em>bool</em><em> , </em><em>optional</em>)  (Optional) runs chemistry and adds to json file</p></li>
<li><p><strong>run_chem</strong>  (Optional) MIT gcm output doesnt usually come with chemistry in the files
If this is the case then you can post process chemistry by setting this to True.</p></li>
<li><p><strong>MH</strong> (<em>float</em><em> , </em><em>optional</em>)  (Optional) This is only used if run_chem is set to True. It is the Metallicity of
the planet in NON log units. MH = 1 is solar.</p></li>
<li><p><strong>CtoO</strong> (<em>float</em><em> , </em><em>optional</em>)  (Optional) This is the C/O ratio of the planet also in NON log units.
CtoO = 0.55 is solar.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.build_3d_input.regrid_xarray">
<span class="sig-prename descclassname"><span class="pre">picaso.build_3d_input.</span></span><span class="sig-name descname"><span class="pre">regrid_xarray</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xarray_original</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_gangle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_tangle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase_angle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latitude</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">longitude</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.build_3d_input.regrid_xarray" title="Link to this definition"></a></dt>
<dd><p>This regrid functionality uses the xarray and xesmf method. It requires to additional
packages that are not required by the rest of PICASO (xesmf). See
tutorial for additional tips on how to structure your xarray input.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xarray_original</strong> (<em>xarray</em>)  xarray of all 3d input you would like regridded</p></li>
<li><p><strong>num_gangle</strong> (<em>int</em>)  Number of gauss angles (not needed if directly supply lat and lons)</p></li>
<li><p><strong>num_tangle</strong> (<em>int</em>)  Number of cheychev angles (not needed if directly supply lat and lons)</p></li>
<li><p><strong>phase_angle</strong> (<em>int</em>)  Radians phase angle (not needed if directly supply lat and lons)</p></li>
<li><p><strong>latitude</strong> (<em>array</em>)  array of latitudes in degrees (not needed if supplied num_gangle, num_tangle, phase_angle)</p></li>
<li><p><strong>longitude</strong> (<em>array</em>)  array of longitudes in degrees (not needed if supplied num_gangle, num_tangle, phase_angle)</p></li>
<li><p><strong>Output</strong></p></li>
<li><p><strong>------</strong>  Dictionary of regridded data and new latitude longitude grid</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.build_3d_input.variable_pressure_example">
<span class="sig-prename descclassname"><span class="pre">picaso.build_3d_input.</span></span><span class="sig-name descname"><span class="pre">variable_pressure_example</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.build_3d_input.variable_pressure_example" title="Link to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-picaso.disco">
<span id="picaso-disco-module"></span><h2>picaso.disco module<a class="headerlink" href="#module-picaso.disco" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="picaso.disco.compress_disco">
<span class="sig-prename descclassname"><span class="pre">picaso.disco.</span></span><span class="sig-name descname"><span class="pre">compress_disco</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nwno</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cos_theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xint_at_top</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gweight</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tweight</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">F0PI</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.disco.compress_disco" title="Link to this definition"></a></dt>
<dd><p>Last step in albedo code. Integrates over phase angle based on the
Gaussian-Chebychev weights in geometry.json</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nwno</strong> (<em>int</em>)  Number of wavenumbers</p></li>
<li><p><strong>cos_theta</strong> (<em>float</em>)  Cosine of phase angle</p></li>
<li><p><strong>xint_at_top</strong> (<em>ndarray</em><em> of </em><em>floats</em>)  Planetary intensity at the top of the atmosphere with dimensions (ng, nt, nwno)</p></li>
<li><p><strong>gweight</strong> (<em>ndarray</em><em> of </em><em>floats</em>)  Gaussian weights for integration</p></li>
<li><p><strong>tweight</strong> (<em>ndarray</em><em> of </em><em>floats</em>)  Chebychev weights for integration</p></li>
<li><p><strong>F0PI</strong> (<em>ndarray</em><em> of </em><em>floats</em>)  Stellar flux</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.disco.compress_thermal">
<span class="sig-prename descclassname"><span class="pre">picaso.disco.</span></span><span class="sig-name descname"><span class="pre">compress_thermal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nwno</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flux_at_top</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gweight</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tweight</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.disco.compress_thermal" title="Link to this definition"></a></dt>
<dd><p>Last step in albedo code. Integrates over phase angle based on the
Gaussian-Chebychev weights in disco.get_angles_1d or 3d</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nwno</strong> (<em>int</em>)  Number of wavenumbers</p></li>
<li><p><strong>flux_at_top</strong> (<em>ndarray</em><em> of </em><em>floats</em>)  Thermal Flux at the top of the atmosphere with dimensions (ng, nt, nwno)
or could also be (ng,nt,nlayer,nwno)</p></li>
<li><p><strong>gweight</strong> (<em>ndarray</em><em> of </em><em>floats</em>)  Gaussian weights for integration</p></li>
<li><p><strong>tweight</strong> (<em>ndarray</em><em> of </em><em>floats</em>)  Chebychev weights for integration</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.disco.compute_disco">
<span class="sig-prename descclassname"><span class="pre">picaso.disco.</span></span><span class="sig-name descname"><span class="pre">compute_disco</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ng</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gangle</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tangle</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase_angle</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.disco.compute_disco" title="Link to this definition"></a></dt>
<dd><p>Computes ubar0, the incident angle, and ubar1, the outgoing angle from the
chebyshev angles in geometry.json</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ng</strong> (<em>int</em>)  Number of gauss angles</p></li>
<li><p><strong>nt</strong> (<em>int</em>)  Number of tchebyshev angles</p></li>
<li><p><strong>gangle</strong> (<em>float</em>)  Gaussian Angles</p></li>
<li><p><strong>tangle</strong> (<em>float</em>)  Chevychev Angles</p></li>
<li><p><strong>phase_angle</strong> (<em>float</em>)  Planetary phase angle</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>ubar0</em>  the incident angles</p></li>
<li><p><em>ubar1</em>  the outgoing angles</p></li>
<li><p><em>cos_theta</em>  Cosine of the phase angle</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.disco.get_angles_1d">
<span class="sig-prename descclassname"><span class="pre">picaso.disco.</span></span><span class="sig-name descname"><span class="pre">get_angles_1d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ngauss</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.disco.get_angles_1d" title="Link to this definition"></a></dt>
<dd><p>Computes integration over half sphere. ngauss=5 is 5 angles over half a
sphere.</p>
<p>These are taken from :
Abramowitz and Stegun Table 25.8
<a class="reference external" href="https://books.google.com/books?id=32HJ1orVXDEC&amp;pg=PA876&amp;lpg=PA876&amp;dq=Abramowitz+and+Stegun+Table+25.8&amp;source=bl&amp;ots=_eKu6k5SG8&amp;sig=ACfU3U0_piSAi8aDHOVd0itf_QSAFxcFLQ&amp;hl=en&amp;sa=X&amp;ved=2ahUKEwj5neLR2fDoAhXemHIEHUSVCjEQ6AEwD3oECAwQKQ#v=onepage&amp;q=Abramowitz%20and%20Stegun%20Table%2025.8&amp;f=false">https://books.google.com/books?id=32HJ1orVXDEC&amp;pg=PA876&amp;lpg=PA876&amp;dq=Abramowitz+and+Stegun+Table+25.8&amp;source=bl&amp;ots=_eKu6k5SG8&amp;sig=ACfU3U0_piSAi8aDHOVd0itf_QSAFxcFLQ&amp;hl=en&amp;sa=X&amp;ved=2ahUKEwj5neLR2fDoAhXemHIEHUSVCjEQ6AEwD3oECAwQKQ#v=onepage&amp;q=Abramowitz%20and%20Stegun%20Table%2025.8&amp;f=false</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ngauss</strong> (<em>int</em>)  Can only be 5, 6, 7, 8</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.disco.get_angles_3d">
<span class="sig-prename descclassname"><span class="pre">picaso.disco.</span></span><span class="sig-name descname"><span class="pre">get_angles_3d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_gangle</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_tangle</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.disco.get_angles_3d" title="Link to this definition"></a></dt>
<dd><p>Computes angles for full disco ball</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_gangles</strong> (<em>int</em>)  Number of Gauss angles</p></li>
<li><p><strong>num_tangles</strong> (<em>int</em>)  Number of Tchebychev angles desired</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Gauss Angles,Gauss Weights,Tchebyshev Angles,Tchebyshev weights</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray, np.ndarray, np.ndarray, np.ndarray</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-picaso.elements">
<span id="picaso-elements-module"></span><h2>picaso.elements module<a class="headerlink" href="#module-picaso.elements" title="Link to this heading"></a></h2>
<p>Properties of the chemical elements.</p>
<p>Each chemical element is represented as an object instance. Physicochemical
and descriptive properties of the elements are stored as instance attributes.</p>
<dl class="field-list simple">
<dt class="field-odd">Author<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="http://www.lfd.uci.edu/~gohlke/">Christoph Gohlke</a></p>
</dd>
<dt class="field-even">Version<span class="colon">:</span></dt>
<dd class="field-even"><p>2015.01.29</p>
</dd>
</dl>
<section id="requirements">
<h3>Requirements<a class="headerlink" href="#requirements" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p><a class="reference external" href="http://www.python.org">CPython 2.7 or 3.4</a></p></li>
</ul>
<p class="rubric">References</p>
<ol class="arabic simple">
<li><p><a class="reference external" href="http://physics.nist.gov/PhysRefData/Compositions/">http://physics.nist.gov/PhysRefData/Compositions/</a></p></li>
<li><p><a class="reference external" href="http://physics.nist.gov/PhysRefData/IonEnergy/tblNew.html">http://physics.nist.gov/PhysRefData/IonEnergy/tblNew.html</a></p></li>
<li><p><a class="reference external" href="http://en.wikipedia.org/wiki/%(element.name)s">http://en.wikipedia.org/wiki/%(element.name)s</a></p></li>
<li><p><a class="reference external" href="http://www.miranda.org/~jkominek/elements/elements.db">http://www.miranda.org/~jkominek/elements/elements.db</a></p></li>
</ol>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">elements</span><span class="w"> </span><span class="kn">import</span> <span class="n">ELEMENTS</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">ELEMENTS</span><span class="p">)</span>
<span class="go">109</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">str</span><span class="p">(</span><span class="n">ELEMENTS</span><span class="p">[</span><span class="mi">109</span><span class="p">])</span>
<span class="go">&#39;Meitnerium&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ele</span> <span class="o">=</span> <span class="n">ELEMENTS</span><span class="p">[</span><span class="s1">&#39;C&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ele</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="n">ele</span><span class="o">.</span><span class="n">symbol</span><span class="p">,</span> <span class="n">ele</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">ele</span><span class="o">.</span><span class="n">eleconfig</span>
<span class="go">(6, &#39;C&#39;, &#39;Carbon&#39;, &#39;[He] 2s2 2p2&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ele</span><span class="o">.</span><span class="n">eleconfig_dict</span>
<span class="go">{(1, &#39;s&#39;): 2, (2, &#39;p&#39;): 2, (2, &#39;s&#39;): 2}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">sum</span><span class="p">(</span><span class="n">ele</span><span class="o">.</span><span class="n">mass</span> <span class="k">for</span> <span class="n">ele</span> <span class="ow">in</span> <span class="n">ELEMENTS</span><span class="p">)</span>
<span class="go">14659.1115599</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">ele</span> <span class="ow">in</span> <span class="n">ELEMENTS</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">ele</span><span class="o">.</span><span class="n">validate</span><span class="p">()</span>
<span class="gp">... </span>    <span class="n">ele</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">ele</span><span class="p">))</span>
</pre></div>
</div>
</section>
</section>
<section id="module-picaso.fluxes">
<span id="picaso-fluxes-module"></span><h2>picaso.fluxes module<a class="headerlink" href="#module-picaso.fluxes" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="picaso.fluxes.blackbody">
<span class="sig-prename descclassname"><span class="pre">picaso.fluxes.</span></span><span class="sig-name descname"><span class="pre">blackbody</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.fluxes.blackbody" title="Link to this definition"></a></dt>
<dd><p>Blackbody flux in cgs units in per unit wavelength (cm)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> (<em>array</em><em>,</em><em>float</em>)  Temperature (K)</p></li>
<li><p><strong>w</strong> (<em>array</em><em>, </em><em>float</em>)  Wavelength (cm)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>ndarray with shape ntemp x numwave in units of erg/cm/s2/cm</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.fluxes.blackbody_climate_deprecate">
<span class="sig-prename descclassname"><span class="pre">picaso.fluxes.</span></span><span class="sig-name descname"><span class="pre">blackbody_climate_deprecate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wave</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmax</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.fluxes.blackbody_climate_deprecate" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.fluxes.blackbody_integrated">
<span class="sig-prename descclassname"><span class="pre">picaso.fluxes.</span></span><span class="sig-name descname"><span class="pre">blackbody_integrated</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">T</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wave</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dwave</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.fluxes.blackbody_integrated" title="Link to this definition"></a></dt>
<dd><p>This computes the total energey per wavenumber bin needed for the climate calculation
Note that this is different than the raw flux at an isolated wavenumber. Therefore this function is
different than the blackbody function in <cite>picaso.fluxes</cite> which computes blackbody in raw
cgs units.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>T</strong> (<em>float</em><em>, </em><em>array</em>)  temperature in Kelvin</p></li>
<li><p><strong>wave</strong> (<em>float</em><em>, </em><em>array</em>)  wavenumber in cm-1</p></li>
<li><p><strong>dwave</strong> (<em>float</em><em>, </em><em>array</em>)  Wavenumber bins in cm-1</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>num temperatures by num wavenumbers
units of ergs/cm*2/s/cm-1 for <em>integrated</em> bins ()</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.fluxes.calculate_flux">
<span class="sig-prename descclassname"><span class="pre">picaso.fluxes.</span></span><span class="sig-name descname"><span class="pre">calculate_flux</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">F</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">G</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.fluxes.calculate_flux" title="Link to this definition"></a></dt>
<dd><p>Calculate fluxes</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.fluxes.chapman">
<span class="sig-prename descclassname"><span class="pre">picaso.fluxes.</span></span><span class="sig-name descname"><span class="pre">chapman</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pressure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hratio</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.fluxes.chapman" title="Link to this definition"></a></dt>
<dd><p>Computes Chapman function for use in tidal routine</p>
<dl class="simple">
<dt>Parameters</dt><dd></dd>
<dt>pressure<span class="classifier">float</span></dt><dd><p>pressure</p>
</dd>
<dt>pm<span class="classifier">float</span></dt><dd><p>Some pressure (?)</p>
</dd>
<dt>hratio<span class="classifier">float</span></dt><dd><p>Ratio of Scale Height over Chapman Scale Height</p>
</dd>
<dt>Returns</dt><dd><p>Chapman function</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.fluxes.get_reflected_1d">
<span class="sig-prename descclassname"><span class="pre">picaso.fluxes.</span></span><span class="sig-name descname"><span class="pre">get_reflected_1d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nlevel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wno</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nwno</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtau</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cosb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gcos2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ftau_cld</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ftau_ray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtau_og</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau_og</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w0_og</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cosb_og</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">surf_reflect</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ubar0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ubar1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cos_theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">F0PI</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">single_phase</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multi_phase</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frac_a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frac_b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frac_c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constant_back</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constant_forward</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_toa_intensity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_lvl_flux</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">toon_coefficients</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b_top</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.fluxes.get_reflected_1d" title="Link to this definition"></a></dt>
<dd><p>Computes toon fluxes given tau and everything is 1 dimensional. This is the exact same function
as <cite>get_flux_geom_3d</cite> but is kept separately so we dont have to do unecessary indexing for fast
retrievals.
:param nlevel: Number of levels in the model
:type nlevel: int
:param wno: Wave number grid in cm -1
:type wno: array of float
:param nwno: Number of wave points
:type nwno: int
:param numg: Number of Gauss angles
:type numg: int
:param numt: Number of Chebyshev angles
:type numt: int
:param DTAU: This is the opacity contained within each individual layer (defined at midpoints of levels)</p>
<blockquote>
<div><p>WITHOUT D-Eddington Correction
Dimensions=# layer by # wave</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>TAU</strong> (<em>ndarray</em><em> of </em><em>float</em>)  This is the cumulative summed opacity
WITHOUT D-Eddington Correction
Dimensions=# level by # wave</p></li>
<li><p><strong>W0</strong> (<em>ndarray</em><em> of </em><em>float</em>)  This is the single scattering albedo, from scattering, clouds, raman, etc
WITHOUT D-Eddington Correction
Dimensions=# layer by # wave</p></li>
<li><p><strong>COSB</strong> (<em>ndarray</em><em> of </em><em>float</em>)  This is the asymmetry factor
WITHOUT D-Eddington Correction
Dimensions=# layer by # wave</p></li>
<li><p><strong>GCOS2</strong> (<em>ndarray</em><em> of </em><em>float</em>)  Parameter that allows us to directly include Rayleigh scattering
= 0.5*tau_rayleigh/(tau_rayleigh + tau_cloud)</p></li>
<li><p><strong>ftau_cld</strong> (<em>ndarray</em><em> of </em><em>float</em>)  Fraction of cloud extinction to total
= tau_cloud/(tau_rayleigh + tau_cloud)</p></li>
<li><p><strong>ftau_ray</strong> (<em>ndarray</em><em> of </em><em>float</em>)  Fraction of rayleigh extinction to total
= tau_rayleigh/(tau_rayleigh + tau_cloud)</p></li>
<li><p><strong>dtau_og</strong> (<em>ndarray</em><em> of </em><em>float</em>)  This is the opacity contained within each individual layer (defined at midpoints of levels)
WITHOUT the delta eddington correction, if it was specified by user
Dimensions=# layer by # wave</p></li>
<li><p><strong>tau_og</strong> (<em>ndarray</em><em> of </em><em>float</em>)  This is the cumulative summed opacity
WITHOUT the delta eddington correction, if it was specified by user
Dimensions=# level by # wave</p></li>
<li><p><strong>w0_og</strong> (<em>ndarray</em><em> of </em><em>float</em>)  Same as w0 but WITHOUT the delta eddington correction, if it was specified by user</p></li>
<li><p><strong>cosb_og</strong> (<em>ndarray</em><em> of </em><em>float</em>)  Same as cosbar buth WITHOUT the delta eddington correction, if it was specified by user</p></li>
<li><p><strong>surf_reflect</strong> (<em>float</em>)  Surface reflectivity</p></li>
<li><p><strong>ubar0</strong> (<em>ndarray</em><em> of </em><em>float</em>)  matrix of cosine of the incident angle from geometric.json</p></li>
<li><p><strong>ubar1</strong> (<em>ndarray</em><em> of </em><em>float</em>)  matrix of cosine of the observer angles</p></li>
<li><p><strong>cos_theta</strong> (<em>float</em>)  Cosine of the phase angle of the planet</p></li>
<li><p><strong>F0PI</strong> (<em>array</em>)  Downward incident solar radiation</p></li>
<li><p><strong>single_phase</strong> (<em>str</em>)  Single scattering phase function, default is the two-term henyey-greenstein phase function</p></li>
<li><p><strong>multi_phase</strong> (<em>str</em>)  Multiple scattering phase function, defulat is N=2 Legendre polynomial</p></li>
<li><p><strong>frac_a</strong> (<em>float</em>)  (Optional), If using the TTHG phase function. Must specify the functional form for fraction
of forward to back scattering (A + B * gcosb^C)</p></li>
<li><p><strong>frac_b</strong> (<em>float</em>)  (Optional), If using the TTHG phase function. Must specify the functional form for fraction
of forward to back scattering (A + B * gcosb^C)</p></li>
<li><p><strong>frac_c</strong> (<em>float</em>)  (Optional), If using the TTHG phase function. Must specify the functional form for fraction
of forward to back scattering (A + B * gcosb^C), Default is : 1 - gcosb^2</p></li>
<li><p><strong>constant_back</strong> (<em>float</em>)  (Optional), If using the TTHG phase function. Must specify the assymetry of back scatterer.
Remember, the output of A &amp; M code does not separate back and forward scattering.</p></li>
<li><p><strong>constant_forward</strong> (<em>float</em>)  (Optional), If using the TTHG phase function. Must specify the assymetry of forward scatterer.
Remember, the output of A &amp; M code does not separate back and forward scattering.</p></li>
<li><p><strong>get_toa_intensity</strong> (<em>int</em>)  (Optional) Default=1 is to only return the TOA intensity you would need for a 1D spectrum (1)
otherwise it will return zeros for TOA intensity</p></li>
<li><p><strong>get_lvl_flux</strong> (<em>int</em>)  (Optional) Default=0 is to only compute TOA intensity and NOT return the lvl fluxes so this needs
to be flipped on for the climate calculations</p></li>
<li><p><strong>toon_coefficients</strong> (<em>int</em>)  (Optional) 0 for quadrature (default) 1 for eddington</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>intensity at the top of the atmosphere for all the different ubar1 and ubar2</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.fluxes.get_reflected_1d_deprecate">
<span class="sig-prename descclassname"><span class="pre">picaso.fluxes.</span></span><span class="sig-name descname"><span class="pre">get_reflected_1d_deprecate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nlevel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wno</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nwno</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtau</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cosb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gcos2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ftau_cld</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ftau_ray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtau_og</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau_og</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w0_og</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cosb_og</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">surf_reflect</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ubar0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ubar1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cos_theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">F0PI</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">single_phase</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multi_phase</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frac_a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frac_b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frac_c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constant_back</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constant_forward</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">toon_coefficients</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b_top</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.fluxes.get_reflected_1d_deprecate" title="Link to this definition"></a></dt>
<dd><p>Computes toon fluxes given tau and everything is 1 dimensional. This is the exact same function
as <cite>get_flux_geom_3d</cite> but is kept separately so we dont have to do unecessary indexing for fast
retrievals.
:param nlevel: Number of levels in the model
:type nlevel: int
:param wno: Wave number grid in cm -1
:type wno: array of float
:param nwno: Number of wave points
:type nwno: int
:param numg: Number of Gauss angles
:type numg: int
:param numt: Number of Chebyshev angles
:type numt: int
:param DTAU: This is the opacity contained within each individual layer (defined at midpoints of levels)</p>
<blockquote>
<div><p>WITHOUT D-Eddington Correction
Dimensions=# layer by # wave</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>TAU</strong> (<em>ndarray</em><em> of </em><em>float</em>)  This is the cumulative summed opacity
WITHOUT D-Eddington Correction
Dimensions=# level by # wave</p></li>
<li><p><strong>W0</strong> (<em>ndarray</em><em> of </em><em>float</em>)  This is the single scattering albedo, from scattering, clouds, raman, etc
WITHOUT D-Eddington Correction
Dimensions=# layer by # wave</p></li>
<li><p><strong>COSB</strong> (<em>ndarray</em><em> of </em><em>float</em>)  This is the asymmetry factor
WITHOUT D-Eddington Correction
Dimensions=# layer by # wave</p></li>
<li><p><strong>GCOS2</strong> (<em>ndarray</em><em> of </em><em>float</em>)  Parameter that allows us to directly include Rayleigh scattering
= 0.5*tau_rayleigh/(tau_rayleigh + tau_cloud)</p></li>
<li><p><strong>ftau_cld</strong> (<em>ndarray</em><em> of </em><em>float</em>)  Fraction of cloud extinction to total
= tau_cloud/(tau_rayleigh + tau_cloud)</p></li>
<li><p><strong>ftau_ray</strong> (<em>ndarray</em><em> of </em><em>float</em>)  Fraction of rayleigh extinction to total
= tau_rayleigh/(tau_rayleigh + tau_cloud)</p></li>
<li><p><strong>dtau_og</strong> (<em>ndarray</em><em> of </em><em>float</em>)  This is the opacity contained within each individual layer (defined at midpoints of levels)
WITHOUT the delta eddington correction, if it was specified by user
Dimensions=# layer by # wave</p></li>
<li><p><strong>tau_og</strong> (<em>ndarray</em><em> of </em><em>float</em>)  This is the cumulative summed opacity
WITHOUT the delta eddington correction, if it was specified by user
Dimensions=# level by # wave</p></li>
<li><p><strong>w0_og</strong> (<em>ndarray</em><em> of </em><em>float</em>)  Same as w0 but WITHOUT the delta eddington correction, if it was specified by user</p></li>
<li><p><strong>cosb_og</strong> (<em>ndarray</em><em> of </em><em>float</em>)  Same as cosbar buth WITHOUT the delta eddington correction, if it was specified by user</p></li>
<li><p><strong>surf_reflect</strong> (<em>float</em>)  Surface reflectivity</p></li>
<li><p><strong>ubar0</strong> (<em>ndarray</em><em> of </em><em>float</em>)  matrix of cosine of the incident angle from geometric.json</p></li>
<li><p><strong>ubar1</strong> (<em>ndarray</em><em> of </em><em>float</em>)  matrix of cosine of the observer angles</p></li>
<li><p><strong>cos_theta</strong> (<em>float</em>)  Cosine of the phase angle of the planet</p></li>
<li><p><strong>F0PI</strong> (<em>array</em>)  Downward incident solar radiation</p></li>
<li><p><strong>single_phase</strong> (<em>str</em>)  Single scattering phase function, default is the two-term henyey-greenstein phase function</p></li>
<li><p><strong>multi_phase</strong> (<em>str</em>)  Multiple scattering phase function, defulat is N=2 Legendre polynomial</p></li>
<li><p><strong>frac_a</strong> (<em>float</em>)  (Optional), If using the TTHG phase function. Must specify the functional form for fraction
of forward to back scattering (A + B * gcosb^C)</p></li>
<li><p><strong>frac_b</strong> (<em>float</em>)  (Optional), If using the TTHG phase function. Must specify the functional form for fraction
of forward to back scattering (A + B * gcosb^C)</p></li>
<li><p><strong>frac_c</strong> (<em>float</em>)  (Optional), If using the TTHG phase function. Must specify the functional form for fraction
of forward to back scattering (A + B * gcosb^C), Default is : 1 - gcosb^2</p></li>
<li><p><strong>constant_back</strong> (<em>float</em>)  (Optional), If using the TTHG phase function. Must specify the assymetry of back scatterer.
Remember, the output of A &amp; M code does not separate back and forward scattering.</p></li>
<li><p><strong>constant_forward</strong> (<em>float</em>)  (Optional), If using the TTHG phase function. Must specify the assymetry of forward scatterer.
Remember, the output of A &amp; M code does not separate back and forward scattering.</p></li>
<li><p><strong>toon_coefficients</strong> (<em>int</em>)  0 for quadrature (default) 1 for eddington</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>intensity at the top of the atmosphere for all the different ubar1 and ubar2</em></p></li>
<li><p><em>To Do</em></p></li>
<li><p><em></em></p></li>
<li><p><em>- F0PI Solar flux shouldnt always be 1.. Follow up to make sure that this isnt a bad</em>  hardwiring to solar, despite relative albedo</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.fluxes.get_reflected_1d_gfluxv_deprecate">
<span class="sig-prename descclassname"><span class="pre">picaso.fluxes.</span></span><span class="sig-name descname"><span class="pre">get_reflected_1d_gfluxv_deprecate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nlevel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wno</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nwno</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtau</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cosb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">surf_reflect</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b_top</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b_surface</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ubar0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">F0PI</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tridiagonal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta_approx</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.fluxes.get_reflected_1d_gfluxv_deprecate" title="Link to this definition"></a></dt>
<dd><p>Computes upwelling and downwelling layer and level toon fluxes given tau and everything is 1 dimensional. This is the exact same function
as <a href="#id4"><span class="problematic" id="id5">`</span></a>GFLUXV.f.
retrievals.
:param nlevel: Number of levels in the model
:type nlevel: int
:param wno: Wave number grid in cm -1
:type wno: array of float
:param nwno: Number of wave points
:type nwno: int
:param numg: Number of Gauss angles
:type numg: int
:param numt: Number of Chebyshev angles
:type numt: int
:param DTAU: This is the opacity contained within each individual layer (defined at midpoints of levels)</p>
<blockquote>
<div><p>WITHOUT D-Eddington Correction
Dimensions=# layer by # wave</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>TAU</strong> (<em>ndarray</em><em> of </em><em>float</em>)  This is the cumulative summed opacity
WITHOUT D-Eddington Correction
Dimensions=# level by # wave</p></li>
<li><p><strong>W0</strong> (<em>ndarray</em><em> of </em><em>float</em>)  This is the single scattering albedo, from scattering, clouds, raman, etc
WITHOUT D-Eddington Correction
Dimensions=# layer by # wave</p></li>
<li><p><strong>COSB</strong> (<em>ndarray</em><em> of </em><em>float</em>)  This is the asymmetry factor
WITHOUT D-Eddington Correction
Dimensions=# layer by # wave</p></li>
<li><p><strong>surf_reflect</strong> (<em>float</em>)  Surface reflectivity</p></li>
<li><p><strong>b_top</strong> (<em>float</em>)  Top Boundary Conditions</p></li>
<li><p><strong>b_surface</strong> (<em>float</em>)  Surface Boundary Conditions</p></li>
<li><p><strong>ubar0</strong> (<em>ndarray</em><em> of </em><em>float</em>)  matrix of cosine of the incident angle from geometric.json</p></li>
<li><p><strong>F0PI</strong> (<em>array</em>)  Downward incident solar radiation</p></li>
<li><p><strong>delta_approx</strong> (<em>int</em>)  0 for no Delta Approx, 1 for Delta Approx</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>intensity at the top of the atmosphere for all the different ubar1 and ubar2</em></p></li>
<li><p><em>To Do</em></p></li>
<li><p><em></em></p></li>
<li><p><em>- F0PI Solar flux shouldnt always be 1.. Follow up to make sure that this isnt a bad</em>  hardwiring to solar, despite relative albedo</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.fluxes.get_reflected_3d">
<span class="sig-prename descclassname"><span class="pre">picaso.fluxes.</span></span><span class="sig-name descname"><span class="pre">get_reflected_3d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nlevel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wno</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nwno</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtau_3d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau_3d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w0_3d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cosb_3d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gcos2_3d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ftau_cld_3d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ftau_ray_3d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtau_og_3d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau_og_3d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w0_og_3d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cosb_og_3d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">surf_reflect</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ubar0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ubar1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cos_theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">F0PI</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">single_phase</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multi_phase</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frac_a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frac_b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frac_c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constant_back</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constant_forward</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.fluxes.get_reflected_3d" title="Link to this definition"></a></dt>
<dd><p>Computes toon fluxes given tau and everything is 3 dimensional. This is the exact same function
as <cite>get_flux_geom_1d</cite> but is kept separately so we dont have to do unecessary indexing for
retrievals.
:param nlevel: Number of levels in the model
:type nlevel: int
:param wno: Wave number grid in cm -1
:type wno: array of float
:param nwno: Number of wave points
:type nwno: int
:param numg: Number of Gauss angles
:type numg: int
:param numt: Number of Chebyshev angles
:type numt: int
:param dtau_3d: This is the opacity contained within each individual layer (defined at midpoints of levels)</p>
<blockquote>
<div><p>WITHOUT D-Eddington Correction
Dimensions=# layer by # wave</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tau_3d</strong> (<em>ndarray</em><em> of </em><em>float</em>)  This is the cumulative summed opacity
WITHOUT D-Eddington Correction
Dimensions=# level by # wave</p></li>
<li><p><strong>w0_3d</strong> (<em>ndarray</em><em> of </em><em>float</em>)  This is the single scattering albedo, from scattering, clouds, raman, etc
WITHOUT D-Eddington Correction
Dimensions=# layer by # wave</p></li>
<li><p><strong>cosb_3d</strong> (<em>ndarray</em><em> of </em><em>float</em>)  This is the asymmetry factor
WITHOUT D-Eddington Correction
Dimensions=# layer by # wave</p></li>
<li><p><strong>gcos2_3d</strong> (<em>ndarray</em><em> of </em><em>float</em>)  Parameter that allows us to directly include Rayleigh scattering
= 0.5*tau_rayleigh/(tau_rayleigh + tau_cloud)</p></li>
<li><p><strong>ftau_cld_3d</strong> (<em>ndarray</em><em> of </em><em>float</em>)  Fraction of cloud extinction to total
= tau_cloud/(tau_rayleigh + tau_cloud)</p></li>
<li><p><strong>ftau_ray_3d</strong> (<em>ndarray</em><em> of </em><em>float</em>)  Fraction of rayleigh extinction to total
= tau_rayleigh/(tau_rayleigh + tau_cloud)</p></li>
<li><p><strong>dtau_og_3d</strong> (<em>ndarray</em><em> of </em><em>float</em>)  This is the opacity contained within each individual layer (defined at midpoints of levels)
WITHOUT the delta eddington correction, if it was specified by user
Dimensions=# layer by # wave</p></li>
<li><p><strong>tau_og_3d</strong> (<em>ndarray</em><em> of </em><em>float</em>)  This is the cumulative summed opacity
WITHOUT the delta eddington correction, if it was specified by user
Dimensions=# level by # wave</p></li>
<li><p><strong>w0_og_3d</strong> (<em>ndarray</em><em> of </em><em>float</em>)  Same as w0 but WITHOUT the delta eddington correction, if it was specified by user</p></li>
<li><p><strong>cosb_og_3d</strong> (<em>ndarray</em><em> of </em><em>float</em>)  Same as cosbar buth WITHOUT the delta eddington correction, if it was specified by user</p></li>
<li><p><strong>surf_reflect</strong> (<em>float</em>)  Surface reflectivity</p></li>
<li><p><strong>ubar0</strong> (<em>ndarray</em><em> of </em><em>float</em>)  matrix of cosine of the incident angle from geometric.json</p></li>
<li><p><strong>ubar1</strong> (<em>ndarray</em><em> of </em><em>float</em>)  matrix of cosine of the observer angles</p></li>
<li><p><strong>cos_theta</strong> (<em>float</em>)  Cosine of the phase angle of the planet</p></li>
<li><p><strong>F0PI</strong> (<em>array</em>)  Downward incident solar radiation</p></li>
<li><p><strong>single_phase</strong> (<em>str</em>)  Single scattering phase function, default is the two-term henyey-greenstein phase function</p></li>
<li><p><strong>multi_phase</strong> (<em>str</em>)  Multiple scattering phase function, defulat is N=2 Legendre polynomial</p></li>
<li><p><strong>frac_a</strong> (<em>float</em>)  (Optional), If using the TTHG phase function. Must specify the functional form for fraction
of forward to back scattering (A + B * gcosb^C)</p></li>
<li><p><strong>frac_b</strong> (<em>float</em>)  (Optional), If using the TTHG phase function. Must specify the functional form for fraction
of forward to back scattering (A + B * gcosb^C)</p></li>
<li><p><strong>frac_c</strong> (<em>float</em>)  (Optional), If using the TTHG phase function. Must specify the functional form for fraction
of forward to back scattering (A + B * gcosb^C), Default is : 1 - gcosb^2</p></li>
<li><p><strong>constant_back</strong> (<em>float</em>)  (Optional), If using the TTHG phase function. Must specify the assymetry of back scatterer.
Remember, the output of A &amp; M code does not separate back and forward scattering.</p></li>
<li><p><strong>constant_forward</strong> (<em>float</em>)  (Optional), If using the TTHG phase function. Must specify the assymetry of forward scatterer.
Remember, the output of A &amp; M code does not separate back and forward scattering.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>intensity at the top of the atmosphere for all the different ubar1 and ubar2</em></p></li>
<li><p><em>To Do</em></p></li>
<li><p><em></em></p></li>
<li><p><em>- F0PI Solar flux shouldnt always be 1.. Follow up to make sure that this isnt a bad</em>  hardwiring to solar, despite relative albedo</p></li>
<li><p><em>- take delta eddington option out of fluxes and move it all over to optics</em></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.fluxes.get_reflected_SH">
<span class="sig-prename descclassname"><span class="pre">picaso.fluxes.</span></span><span class="sig-name descname"><span class="pre">get_reflected_SH</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nlevel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nwno</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtau</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cosb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ftau_cld</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ftau_ray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_deltaM</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtau_og</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau_og</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w0_og</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cosb_og</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">surf_reflect</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ubar0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ubar1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cos_theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">F0PI</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w_single_form</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w_multi_form</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psingle_form</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w_single_rayleigh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w_multi_rayleigh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psingle_rayleigh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frac_a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frac_b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frac_c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constant_back</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constant_forward</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stream</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b_top</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">single_form</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.fluxes.get_reflected_SH" title="Link to this definition"></a></dt>
<dd><p>Computes rooney fluxes given tau and everything is 3 dimensional. This is the exact same function
as <cite>get_flux_geom_1d</cite> but is kept separately so we dont have to do unecessary indexing for
retrievals.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nlevel</strong> (<em>int</em>)  Number of levels in the model</p></li>
<li><p><strong>nwno</strong> (<em>int</em>)  Number of wave points</p></li>
<li><p><strong>numg</strong> (<em>int</em>)  Number of Gauss angles</p></li>
<li><p><strong>numt</strong> (<em>int</em>)  Number of Chebyshev angles</p></li>
<li><p><strong>dtau</strong> (<em>ndarray</em><em> of </em><em>float</em>)  This is the opacity contained within each individual layer (defined at midpoints of levels)
WITHOUT D-Eddington Correction
Dimensions=# layer by # wave</p></li>
<li><p><strong>tau</strong> (<em>ndarray</em><em> of </em><em>float</em>)  This is the cumulative summed opacity
WITHOUT D-Eddington Correction
Dimensions=# level by # wave</p></li>
<li><p><strong>w0</strong> (<em>ndarray</em><em> of </em><em>float</em>)  This is the single scattering albedo, from scattering, clouds, raman, etc
WITHOUT D-Eddington Correction
Dimensions=# layer by # wave</p></li>
<li><p><strong>cosb</strong> (<em>ndarray</em><em> of </em><em>float</em>)  This is the asymmetry factor
WITHOUT D-Eddington Correction
Dimensions=# layer by # wave</p></li>
<li><p><strong>ftau_cld</strong> (<em>ndarray</em><em> of </em><em>float</em>)  Fraction of cloud extinction to total
= tau_cloud/(tau_rayleigh + tau_cloud)</p></li>
<li><p><strong>ftau_ray</strong> (<em>ndarray</em><em> of </em><em>float</em>)  Fraction of rayleigh extinction to total
= tau_rayleigh/(tau_rayleigh + tau_cloud)</p></li>
<li><p><strong>f_deltaM</strong> (<em>ndarray</em><em> of </em><em>float</em>)  Fractional scattering coefficient for delta-M calculation
f_deltaM = 0 if delta_eddington=False</p></li>
<li><p><strong>dtau_og</strong> (<em>ndarray</em><em> of </em><em>float</em>)  This is the opacity contained within each individual layer (defined at midpoints of levels)
WITHOUT the delta eddington correction, if it was specified by user
Dimensions=# layer by # wave</p></li>
<li><p><strong>tau_og</strong> (<em>ndarray</em><em> of </em><em>float</em>)  This is the cumulative summed opacity
WITHOUT the delta eddington correction, if it was specified by user
Dimensions=# level by # wave</p></li>
<li><p><strong>w0_og</strong> (<em>ndarray</em><em> of </em><em>float</em>)  Same as w0 but WITHOUT the delta eddington correction, if it was specified by user</p></li>
<li><p><strong>cosb_og</strong> (<em>ndarray</em><em> of </em><em>float</em>)  Same as cosbar buth WITHOUT the delta eddington correction, if it was specified by user</p></li>
<li><p><strong>surf_reflect</strong> (<em>float</em>)  Surface reflectivity</p></li>
<li><p><strong>ubar0</strong> (<em>ndarray</em><em> of </em><em>float</em>)  matrix of cosine of the incident angle from geometric.json</p></li>
<li><p><strong>ubar1</strong> (<em>ndarray</em><em> of </em><em>float</em>)  matrix of cosine of the observer angles</p></li>
<li><p><strong>cos_theta</strong> (<em>float</em>)  Cosine of the phase angle of the planet</p></li>
<li><p><strong>F0PI</strong> (<em>array</em>)  Downward incident solar radiation</p></li>
<li><p><strong>w_single_form</strong> (<em>str</em>)  Single scattering phase function approximation for SH</p></li>
<li><p><strong>w_multi_form</strong> (<em>str</em>)  Multiple scattering phase function approximation for SH</p></li>
<li><p><strong>psingle_form</strong> (<em>str</em>)  Scattering phase function approximation for psingle in SH</p></li>
<li><p><strong>w_single_rayleigh</strong> (<em>str</em>)  Toggle rayleigh scattering on/off for single scattering in SH</p></li>
<li><p><strong>w_multi_rayleigh</strong> (<em>str</em>)  Toggle rayleigh scattering on/off for multi scattering in SH</p></li>
<li><p><strong>psingle_rayleigh</strong> (<em>str</em>)  Toggle rayleigh scattering on/off for psingle in SH</p></li>
<li><p><strong>frac_a</strong> (<em>float</em>)  (Optional), If using the TTHG phase function. Must specify the functional form for fraction
of forward to back scattering (A + B * gcosb^C)</p></li>
<li><p><strong>frac_b</strong> (<em>float</em>)  (Optional), If using the TTHG phase function. Must specify the functional form for fraction
of forward to back scattering (A + B * gcosb^C)</p></li>
<li><p><strong>frac_c</strong> (<em>float</em>)  (Optional), If using the TTHG phase function. Must specify the functional form for fraction
of forward to back scattering (A + B * gcosb^C), Default is : 1 - gcosb^2</p></li>
<li><p><strong>constant_back</strong> (<em>float</em>)  (Optional), If using the TTHG phase function. Must specify the assymetry of back scatterer.
Remember, the output of A &amp; M code does not separate back and forward scattering.</p></li>
<li><p><strong>constant_forward</strong> (<em>float</em>)  (Optional), If using the TTHG phase function. Must specify the assymetry of forward scatterer.
Remember, the output of A &amp; M code does not separate back and forward scattering.</p></li>
<li><p><strong>stream</strong> (<em>int</em>)  Order of expansion of Legendre polynomials (2 or 4)</p></li>
<li><p><strong>b_top</strong> (<em>float</em>)  Upper boundary condition for incoming intensity</p></li>
<li><p><strong>flx</strong> (<em>int</em>)  Toggle calculation of layerwise fluxes (0 = do not calculate, 1 = calculate)</p></li>
<li><p><strong>single_form</strong> (<em>int</em>)  Toggle which version of p_single to use (0 = explicit, 1 = legendre)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>intensity at the top of the atmosphere for all the different ubar1 and ubar2</em></p></li>
<li><p><em>To Do</em></p></li>
<li><p><em></em></p></li>
<li><p><em>- F0PI Solar flux shouldnt always be 1.. Follow up to make sure that this isnt a bad</em>  hardwiring to solar, despite relative albedo</p></li>
<li><p><em>- take delta eddington option out of fluxes and move it all over to optics</em></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.fluxes.get_thermal_1d">
<span class="sig-prename descclassname"><span class="pre">picaso.fluxes.</span></span><span class="sig-name descname"><span class="pre">get_thermal_1d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nlevel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wno</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nwno</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tlevel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtau</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cosb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plevel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ubar1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">surf_reflect</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hard_surface</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dwno</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calc_type</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.fluxes.get_thermal_1d" title="Link to this definition"></a></dt>
<dd><p>This function uses the source function method, which is outlined here :
<a class="reference external" href="https://agupubs.onlinelibrary.wiley.com/doi/pdf/10.1029/JD094iD13p16287">https://agupubs.onlinelibrary.wiley.com/doi/pdf/10.1029/JD094iD13p16287</a></p>
<p>The result of this routine is the top of the atmosphere thermal flux as
a function of gauss and chebychev points accross the disk.</p>
<p>Everything here is in CGS units:</p>
<p>Fluxes - erg/s/cm^3
Temperature - K
Wave grid - cm-1
Pressure ; dyne/cm2</p>
<p>Reminder: Flux = pi * Intensity, so if you are trying to compare the result of this with
a black body you will need to compare with pi * BB !</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nlevel</strong> (<em>int</em>)  Number of levels which occur at the grid points (not to be confused with layers which are
mid points)</p></li>
<li><p><strong>wno</strong> (<em>numpy.ndarray</em>)  Wavenumber grid in inverse cm</p></li>
<li><p><strong>nwno</strong> (<em>int</em>)  Number of wavenumber points</p></li>
<li><p><strong>numg</strong> (<em>int</em>)  Number of gauss points (think longitude points)</p></li>
<li><p><strong>numt</strong> (<em>int</em>)  Number of chebychev points (think latitude points)</p></li>
<li><p><strong>tlevel</strong> (<em>numpy.ndarray</em>)  Temperature as a function of level (not layer)</p></li>
<li><p><strong>dtau</strong> (<em>numpy.ndarray</em>)  This is a matrix of nlayer by nwave. This describes the per layer optical depth.</p></li>
<li><p><strong>w0</strong> (<em>numpy.ndarray</em>)  This is a matrix of nlayer by nwave. This describes the single scattering albedo of
the atmosphere. Note this is free of any Raman scattering or any d-eddington correction
that is sometimes included in reflected light calculations.</p></li>
<li><p><strong>cosb</strong> (<em>numpy.ndarray</em>)  This is a matrix of nlayer by nwave. This describes the asymmetry of the
atmosphere. Note this is free of any Raman scattering or any d-eddington correction
that is sometimes included in reflected light calculations.</p></li>
<li><p><strong>plevel</strong> (<em>numpy.ndarray</em>)  Pressure for each level (not layer, which is midpoints). CGS units (dyne/cm2)</p></li>
<li><p><strong>ubar1</strong> (<em>numpy.ndarray</em>)  This is a matrix of ng by nt. This describes the outgoing incident angles and is generally
computed in <cite>picaso.disco</cite></p></li>
<li><p><strong>surf_reflect</strong> (<em>numpy.ndarray</em>)  Surface reflectivity as a function of wavenumber.</p></li>
<li><p><strong>hard_surface</strong> (<em>int</em>)  0 for no hard surface (e.g. Jupiter/Neptune), 1 for hard surface (terrestrial)</p></li>
<li><p><strong>dwno</strong> (<em>int</em>)  delta wno needed for climate</p></li>
<li><p><strong>calc_type</strong> (<em>int</em>)  0 for spectrum model, 1 for climate solver</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Thermal flux in CGS units (erg/cm3/s) in a matrix that is
numg x numt x nwno</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.fluxes.get_thermal_1d_deprecate">
<span class="sig-prename descclassname"><span class="pre">picaso.fluxes.</span></span><span class="sig-name descname"><span class="pre">get_thermal_1d_deprecate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nlevel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wno</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nwno</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tlevel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtau</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cosb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plevel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ubar1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">surf_reflect</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hard_surface</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tridiagonal</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.fluxes.get_thermal_1d_deprecate" title="Link to this definition"></a></dt>
<dd><p>This function uses the source function method, which is outlined here :
<a class="reference external" href="https://agupubs.onlinelibrary.wiley.com/doi/pdf/10.1029/JD094iD13p16287">https://agupubs.onlinelibrary.wiley.com/doi/pdf/10.1029/JD094iD13p16287</a></p>
<p>The result of this routine is the top of the atmosphere thermal flux as
a function of gauss and chebychev points accross the disk.
Everything here is in CGS units:
Fluxes - erg/s/cm^3
Temperature - K
Wave grid - cm-1
Pressure ; dyne/cm2
Reminder: Flux = pi * Intensity, so if you are trying to compare the result of this with
a black body you will need to compare with pi * BB !
:param nlevel: Number of levels which occur at the grid points (not to be confused with layers which are</p>
<blockquote>
<div><p>mid points)</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wno</strong> (<em>numpy.ndarray</em>)  Wavenumber grid in inverse cm</p></li>
<li><p><strong>nwno</strong> (<em>int</em>)  Number of wavenumber points</p></li>
<li><p><strong>numg</strong> (<em>int</em>)  Number of gauss points (think longitude points)</p></li>
<li><p><strong>numt</strong> (<em>int</em>)  Number of chebychev points (think latitude points)</p></li>
<li><p><strong>tlevel</strong> (<em>numpy.ndarray</em>)  Temperature as a function of level (not layer)</p></li>
<li><p><strong>dtau</strong> (<em>numpy.ndarray</em>)  This is a matrix of nlayer by nwave. This describes the per layer optical depth.</p></li>
<li><p><strong>w0</strong> (<em>numpy.ndarray</em>)  This is a matrix of nlayer by nwave. This describes the single scattering albedo of
the atmosphere. Note this is free of any Raman scattering or any d-eddington correction
that is sometimes included in reflected light calculations.</p></li>
<li><p><strong>cosb</strong> (<em>numpy.ndarray</em>)  This is a matrix of nlayer by nwave. This describes the asymmetry of the
atmosphere. Note this is free of any Raman scattering or any d-eddington correction
that is sometimes included in reflected light calculations.</p></li>
<li><p><strong>plevel</strong> (<em>numpy.ndarray</em>)  Pressure for each level (not layer, which is midpoints). CGS units (dyne/cm2)</p></li>
<li><p><strong>ubar1</strong> (<em>numpy.ndarray</em>)  This is a matrix of ng by nt. This describes the outgoing incident angles and is generally
computed in <cite>picaso.disco</cite></p></li>
<li><p><strong>surf_reflect</strong> (<em>numpy.ndarray</em>)  Surface reflectivity as a function of wavenumber.</p></li>
<li><p><strong>hard_surface</strong> (<em>int</em>)  0 for no hard surface (e.g. Jupiter/Neptune), 1 for hard surface (terrestrial)</p></li>
<li><p><strong>tridiagonal</strong> (<em>int</em>)  0 for tridiagonal, 1 for pentadiagonal</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Thermal flux in CGS units (erg/cm3/s) in a matrix that is
numg x numt x nwno</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.fluxes.get_thermal_1d_gfluxi_deprecate">
<span class="sig-prename descclassname"><span class="pre">picaso.fluxes.</span></span><span class="sig-name descname"><span class="pre">get_thermal_1d_gfluxi_deprecate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nlevel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wno</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nwno</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tlevel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtau</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cosb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plevel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ubar1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">surf_reflect</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ugauss_angles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ugauss_weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tridiagonal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calc_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dwno</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.fluxes.get_thermal_1d_gfluxi_deprecate" title="Link to this definition"></a></dt>
<dd><p>This function uses the source function method, which is outlined here :
<a class="reference external" href="https://agupubs.onlinelibrary.wiley.com/doi/pdf/10.1029/JD094iD13p16287">https://agupubs.onlinelibrary.wiley.com/doi/pdf/10.1029/JD094iD13p16287</a></p>
<p>The result of this routine is the top of the atmosphere thermal flux as
a function of gauss and chebychev points accross the disk.
Everything here is in CGS units:
Fluxes - erg/s/cm^3
Temperature - K
Wave grid - cm-1
Pressure ; dyne/cm2
Reminder: Flux = pi * Intensity, so if you are trying to compare the result of this with
a black body you will need to compare with pi * BB !
:param nlevel: Number of levels which occur at the grid points (not to be confused with layers which are</p>
<blockquote>
<div><p>mid points)</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wno</strong> (<em>numpy.ndarray</em>)  Wavenumber grid in inverse cm</p></li>
<li><p><strong>nwno</strong> (<em>int</em>)  Number of wavenumber points</p></li>
<li><p><strong>numg</strong> (<em>int</em>)  Number of gauss points (think longitude points)</p></li>
<li><p><strong>numt</strong> (<em>int</em>)  Number of chebychev points (think latitude points)</p></li>
<li><p><strong>tlevel</strong> (<em>numpy.ndarray</em>)  Temperature as a function of level (not layer)</p></li>
<li><p><strong>dtau</strong> (<em>numpy.ndarray</em>)  This is a matrix of nlayer by nwave. This describes the per layer optical depth.</p></li>
<li><p><strong>w0</strong> (<em>numpy.ndarray</em>)  This is a matrix of nlayer by nwave. This describes the single scattering albedo of
the atmosphere. Note this is free of any Raman scattering or any d-eddington correction
that is sometimes included in reflected light calculations.</p></li>
<li><p><strong>cosb</strong> (<em>numpy.ndarray</em>)  This is a matrix of nlayer by nwave. This describes the asymmetry of the
atmosphere. Note this is free of any Raman scattering or any d-eddington correction
that is sometimes included in reflected light calculations.</p></li>
<li><p><strong>plevel</strong> (<em>numpy.ndarray</em>)  Pressure for each level (not layer, which is midpoints). CGS units (dyne/cm2)</p></li>
<li><p><strong>ubar1</strong> (<em>numpy.ndarray</em>)  This is a matrix of ng by nt. This describes the outgoing incident angles and is generally
computed in <cite>picaso.disco</cite></p></li>
<li><p><strong>surf_reflect</strong> (<em>numpy.ndarray</em>)  Surface reflectivity as a function of wavenumber.</p></li>
<li><p><strong>tridiagonal</strong> (<em>int</em>)  0 for tridiagonal, 1 for pentadiagonal</p></li>
<li><p><strong>calc_type</strong> (<em>int</em>)  0 for outgoing flux at top level output, 1 for upward and downward layer and level flux outputs</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>numpy.ndarray</em>  Thermal flux in CGS units (erg/cm3/s) in a matrix that is
numg x numt x nwno if calc_type=0</p></li>
<li><p><em>numpy.ndarray, numpy.ndarray, numpy.ndarray, numpy.ndarray</em>  Thermal flux in CGS units (erg/cm3/s) in four matrices if calc_type=0: that is
level downward flux and level upward flux numg x numt x nlevel x nwno and then
layer downward flux and layer upward flux numg x numt x nlayer x nwno</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.fluxes.get_thermal_3d">
<span class="sig-prename descclassname"><span class="pre">picaso.fluxes.</span></span><span class="sig-name descname"><span class="pre">get_thermal_3d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nlevel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wno</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nwno</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tlevel_3d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtau_3d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w0_3d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cosb_3d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plevel_3d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ubar1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">surf_reflect</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hard_surface</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.fluxes.get_thermal_3d" title="Link to this definition"></a></dt>
<dd><p>This function uses the source function method, which is outlined here :
<a class="reference external" href="https://agupubs.onlinelibrary.wiley.com/doi/pdf/10.1029/JD094iD13p16287">https://agupubs.onlinelibrary.wiley.com/doi/pdf/10.1029/JD094iD13p16287</a></p>
<p>The result of this routine is the top of the atmosphere thermal flux as
a function of gauss and chebychev points accross the disk.
Everything here is in CGS units:
Fluxes - erg/s/cm^3
Temperature - K
Wave grid - cm-1
Pressure ; dyne/cm2
Reminder: Flux = pi * Intensity, so if you are trying to compare the result of this with
a black body you will need to compare with pi * BB !
:param nlevel: Number of levels which occur at the grid points (not to be confused with layers which are</p>
<blockquote>
<div><p>mid points)</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wno</strong> (<em>numpy.ndarray</em>)  Wavenumber grid in inverse cm</p></li>
<li><p><strong>nwno</strong> (<em>int</em>)  Number of wavenumber points</p></li>
<li><p><strong>numg</strong> (<em>int</em>)  Number of gauss points (think longitude points)</p></li>
<li><p><strong>numt</strong> (<em>int</em>)  Number of chebychev points (think latitude points)</p></li>
<li><p><strong>tlevel_3d</strong> (<em>numpy.ndarray</em>)  Temperature as a function of level (not layer). This 3d matrix has dimensions [nlevel,ngangle,ntangle].</p></li>
<li><p><strong>dtau_3d</strong> (<em>numpy.ndarray</em>)  This is a matrix of nlayer by nwave. This describes the per layer optical depth.
This 4d matrix has dimensions [nlevel, nwave,ngangle,ntangle].</p></li>
<li><p><strong>w0_3d</strong> (<em>numpy.ndarray</em>)  This is a matrix of nlayer by nwave. This describes the single scattering albedo of
the atmosphere. Note this is free of any Raman scattering or any d-eddington correction
that is sometimes included in reflected light calculations.
This 4d matrix has dimensions [nlevel, nwave,ngangle,ntangle].</p></li>
<li><p><strong>cosb_3d</strong> (<em>numpy.ndarray</em>)  This is a matrix of nlayer by nwave. This describes the asymmetry of the
atmosphere. Note this is free of any Raman scattering or any d-eddington correction
that is sometimes included in reflected light calculations.
This 4d matrix has dimensions [nlevel, nwave,ngangle,ntangle].</p></li>
<li><p><strong>plevel</strong> (<em>numpy.ndarray</em>)  Pressure for each level (not layer, which is midpoints). CGS units (dyne/cm2)</p></li>
<li><p><strong>ubar1</strong> (<em>numpy.ndarray</em>)  This is a matrix of ng by nt. This describes the outgoing incident angles and is generally
computed in <cite>picaso.disco</cite></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Thermal flux in CGS units (erg/cm3/s) in a matrix that is
numg x numt x nwno</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.fluxes.get_thermal_SH">
<span class="sig-prename descclassname"><span class="pre">picaso.fluxes.</span></span><span class="sig-name descname"><span class="pre">get_thermal_SH</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nlevel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wno</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nwno</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tlevel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtau</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cosb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtau_og</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau_og</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w0_og</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w0_no_raman</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cosb_og</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plevel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ubar1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">surf_reflect</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stream</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hard_surface</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.fluxes.get_thermal_SH" title="Link to this definition"></a></dt>
<dd><p>The result of this routine is the top of the atmosphere thermal intensity as
a function of gauss and chebychev points accross the disk.</p>
<p>Everything here is in CGS units:</p>
<p>Fluxes - erg/s/cm^3
Temperature - K
Wave grid - cm-1
Pressure ; dyne/cm2</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nlevel</strong> (<em>int</em>)  Number of levels which occur at the grid points (not to be confused with layers which are
mid points)</p></li>
<li><p><strong>wno</strong> (<em>numpy.ndarray</em>)  Wavenumber grid in inverse cm</p></li>
<li><p><strong>nwno</strong> (<em>int</em>)  Number of wavenumber points</p></li>
<li><p><strong>numg</strong> (<em>int</em>)  Number of gauss points (think longitude points)</p></li>
<li><p><strong>numt</strong> (<em>int</em>)  Number of chebychev points (think latitude points)</p></li>
<li><p><strong>tlevel</strong> (<em>numpy.ndarray</em>)  Temperature as a function of level (not layer)</p></li>
<li><p><strong>dtau</strong> (<em>numpy.ndarray</em>)  This is a matrix of nlayer by nwave. This describes the per layer optical depth.</p></li>
<li><p><strong>tau</strong> (<em>numpy.ndarray</em>)  This is a matrix of nlevel by nwave. This describes the cumulative optical depth.</p></li>
<li><p><strong>w0</strong> (<em>numpy.ndarray</em>)  This is a matrix of nlayer by nwave. This describes the single scattering albedo of
the atmosphere. Note this is free of any Raman scattering or any d-eddington correction
that is sometimes included in reflected light calculations.</p></li>
<li><p><strong>cosb</strong> (<em>numpy.ndarray</em>)  This is a matrix of nlayer by nwave. This describes the asymmetry of the
atmosphere. Note this is free of any Raman scattering or any d-eddington correction
that is sometimes included in reflected light calculations.</p></li>
<li><p><strong>dtau_og</strong> (<em>ndarray</em><em> of </em><em>float</em>)  This is the opacity contained within each individual layer (defined at midpoints of levels)
WITHOUT the delta eddington correction, if it was specified by user
Dimensions=# layer by # wave</p></li>
<li><p><strong>tau_og</strong> (<em>ndarray</em><em> of </em><em>float</em>)  This is the cumulative summed opacity
WITHOUT the delta eddington correction, if it was specified by user
Dimensions=# level by # wave</p></li>
<li><p><strong>w0_og</strong> (<em>ndarray</em><em> of </em><em>float</em>)  Same as w0 but WITHOUT the delta eddington correction, if it was specified by user</p></li>
<li><p><strong>cosb_og</strong> (<em>ndarray</em><em> of </em><em>float</em>)  Same as cosbar buth WITHOUT the delta eddington correction, if it was specified by user</p></li>
<li><p><strong>plevel</strong> (<em>numpy.ndarray</em>)  Pressure for each level (not layer, which is midpoints). CGS units (dyne/cm2)</p></li>
<li><p><strong>ubar1</strong> (<em>numpy.ndarray</em>)  This is a matrix of ng by nt. This describes the outgoing incident angles and is generally
computed in <cite>picaso.disco</cite></p></li>
<li><p><strong>surf_reflect</strong> (<em>numpy.ndarray</em>)  Surface reflectivity as a function of wavenumber.</p></li>
<li><p><strong>stream</strong> (<em>int</em>)  Order of expansion of Legendre polynomials (2 or 4)</p></li>
<li><p><strong>hard_surface</strong> (<em>int</em>)  0 for no hard surface (e.g. Jupiter/Neptune), 1 for hard surface (terrestrial)</p></li>
<li><p><strong>flx</strong> (<em>int</em>)  Toggle calculation of layerwise fluxes (0 = do not calculate, 1 = calculate)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Thermal flux in CGS units (erg/cm3/s) in a matrix that is
numg x numt x nwno</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.fluxes.get_transit_1d">
<span class="sig-prename descclassname"><span class="pre">picaso.fluxes.</span></span><span class="sig-name descname"><span class="pre">get_transit_1d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nlevel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nwno</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rstar</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mmw</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k_b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">player</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tlayer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colden</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">DTAU</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.fluxes.get_transit_1d" title="Link to this definition"></a></dt>
<dd><p>Routine to get the transmission spectrum
:param z: Altitude in decreasing order (cm)
:type z: float, array
:param dz: length of each atmospheric layer
:type dz: float, array
:param nlevel: Number of levels
:type nlevel: int
:param nwno: Number of wavelength points
:type nwno: int
:param rstar: Radius of star (cm)
:type rstar: float
:param mmw: Mean molecular weight
:type mmw: float, array
:param k_b: Boltzman constant cgs
:type k_b: float
:param amu: Atomic mass units cgs
:type amu: float
:param player: Pressure at layers (dyn/cm2)
:type player: float, array
:param tlayer: Temperature at layers (K)
:type tlayer: float, array
:param colden: Column density conputed in atmsetup.get_column_density()
:type colden: float, array
:param DTAU: Matrix of summed tau opacities from optics. This is</p>
<blockquote>
<div><p>TAUGAS + TAURAY + TAUCLD</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Rp**2 /Rs**2 as a function of wavelength</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>array</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id6" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></span>
<p>Brown, Timothy M. Transmission spectra as diagnostics of extrasolar giant planet atmospheres. The Astrophysical Journal 553.2 (2001): 1006.</p>
</aside>
</aside>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.fluxes.get_transit_3d">
<span class="sig-prename descclassname"><span class="pre">picaso.fluxes.</span></span><span class="sig-name descname"><span class="pre">get_transit_3d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nlevel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nwno</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gravity</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rstar</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mass</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mmw</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k_b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">G</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_reference</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plevel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tlevel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">player</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tlayer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colden</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">DTAU</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.fluxes.get_transit_3d" title="Link to this definition"></a></dt>
<dd><p>Routine to get the 3D transmission spectrum</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.fluxes.legP">
<span class="sig-prename descclassname"><span class="pre">picaso.fluxes.</span></span><span class="sig-name descname"><span class="pre">legP</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mu</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.fluxes.legP" title="Link to this definition"></a></dt>
<dd><p>Generate array of Legendre polynomials</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.fluxes.mat_dot">
<span class="sig-prename descclassname"><span class="pre">picaso.fluxes.</span></span><span class="sig-name descname"><span class="pre">mat_dot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.fluxes.mat_dot" title="Link to this definition"></a></dt>
<dd><p>Matrix-vector dot product</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.fluxes.numba_cumsum">
<span class="sig-prename descclassname"><span class="pre">picaso.fluxes.</span></span><span class="sig-name descname"><span class="pre">numba_cumsum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mat</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.fluxes.numba_cumsum" title="Link to this definition"></a></dt>
<dd><p>Function to compute cumsum along axis=0 to bypass numba not allowing kwargs in
cumsum</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.fluxes.pent_diag_solve">
<span class="sig-prename descclassname"><span class="pre">picaso.fluxes.</span></span><span class="sig-name descname"><span class="pre">pent_diag_solve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">l</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">F</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.fluxes.pent_diag_solve" title="Link to this definition"></a></dt>
<dd><p>Pentadiagonal Matrix solver
:param A:
:type A: array or list
:param B:
:type B: array or list
:param C:
:type C: array or list
:param D:
:type D: array or list
:param E:
:type E: array or list
:param F:
:type F: array or list</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Solution, x</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.fluxes.planck_cgs_deprecate">
<span class="sig-prename descclassname"><span class="pre">picaso.fluxes.</span></span><span class="sig-name descname"><span class="pre">planck_cgs_deprecate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wave</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dwave</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.fluxes.planck_cgs_deprecate" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.fluxes.planck_rad_deprecate">
<span class="sig-prename descclassname"><span class="pre">picaso.fluxes.</span></span><span class="sig-name descname"><span class="pre">planck_rad_deprecate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iw</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dT</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tp</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.fluxes.planck_rad_deprecate" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.fluxes.set_bb_deprecate">
<span class="sig-prename descclassname"><span class="pre">picaso.fluxes.</span></span><span class="sig-name descname"><span class="pre">set_bb_deprecate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wno</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta_wno</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nwno</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ntmps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmax</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.fluxes.set_bb_deprecate" title="Link to this definition"></a></dt>
<dd><p>Function to compute a grid of black bodies before the code runs.
This allows us to interpolate on a blackbody instead of computing the planck
function repetitively. This was done because historically computing the
planck function was a bottleneck in speed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wno</strong> (<em>array</em><em>, </em><em>float</em>)  Wavenumber array cm-1</p></li>
<li><p><strong>delta_wno</strong> (<em>array</em><em>, </em><em>float</em>)  Wavenumber bins cm-1</p></li>
<li><p><strong>nwno</strong> (<em>int</em>)  Number of wavenumbers (len(wno))</p></li>
<li><p><strong>ntmps</strong> (<em>int</em>)  Number of temperature points to compute. Default number is set in config.json</p></li>
<li><p><strong>dt</strong> (<em>float</em>)  Spacing in temperature to compute. Default number is set in config.json</p></li>
<li><p><strong>tmin</strong> (<em>float</em>)  Minimum temperature to compute the grid</p></li>
<li><p><strong>tmax</strong> (<em>float</em>)  Maximum temperature to compute the grid</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>array</em>  black body grid (CGS), number of temperatures x number of wavenumbers</p></li>
<li><p><em>array</em>  spline values for interpolation, number of temperatures x number of wavenumbers</p></li>
<li><p><em>array</em>  temperature grid</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.fluxes.setup_2_stream_fluxes">
<span class="sig-prename descclassname"><span class="pre">picaso.fluxes.</span></span><span class="sig-name descname"><span class="pre">setup_2_stream_fluxes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nlayer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nwno</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b_top</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b_surface</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">surf_reflect</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ubar0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtau</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fluxes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calculation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.fluxes.setup_2_stream_fluxes" title="Link to this definition"></a></dt>
<dd><p>Setup up matrices to solve flux problem for spherical harmonics method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nlayer</strong> (<em>int</em>)  Number of layers</p></li>
<li><p><strong>nwno</strong> (<em>int</em>)  Number of wavenumber points</p></li>
<li><p><strong>w0</strong> (<em>numpy.ndarray</em>)  This is a matrix of nlayer by nwave. This describes the single scattering albedo of
the atmosphere. Note this is free of any Raman scattering or any d-eddington correction
that is sometimes included in reflected light calculations.</p></li>
<li><p><strong>b_top</strong> (<em>array</em>)  The diffuse radiation into the model at the top of the atmosphere</p></li>
<li><p><strong>b_surface</strong> (<em>array</em>)  The diffuse radiation into the model at the bottom. Includes emission, reflection
of the unattenuated portion of the direct beam</p></li>
<li><p><strong>b_surface_SH4</strong> (<em>array</em>)  Second bottom BC for SH4 method.</p></li>
<li><p><strong>surf_reflect</strong> (<em>numpy.ndarray</em>)  Surface reflectivity as a function of wavenumber.</p></li>
<li><p><strong>ubar0</strong> (<em>ndarray</em><em> of </em><em>float</em>)  matrix of cosine of the incident angle from geometric.json</p></li>
<li><p><strong>dtau</strong> (<em>numpy.ndarray</em>)  This is a matrix of nlayer by nwave. This describes the per layer optical depth.</p></li>
<li><p><strong>tau</strong> (<em>numpy.ndarray</em>)  This is a matrix of nlevel by nwave. This describes the cumulative optical depth.</p></li>
<li><p><strong>a</strong> (<em>numpy.ndarray</em>)  Coefficients of matrix capturing legendre expansion of phase function for multiple scattering</p></li>
<li><p><strong>b</strong> (<em>numpy.ndarray</em>)  Coefficients of source vector capturing legendre expansion of phase function for single
scattering</p></li>
<li><p><strong>B0</strong> (<em>numpy.ndarray</em>)  Matrix of blackbodies</p></li>
<li><p><strong>B1</strong> (<em>numpy.ndarray</em>)  Eqn (26) Toon 89</p></li>
<li><p><strong>fluxes</strong> (<em>int</em>)  Toggle calculation of layerwise fluxes (0 = do not calculate, 1 = calculate)</p></li>
<li><p><strong>calculation</strong> (<em>int</em>)  Toggle calculation method (1 = linear, 2 = exponential)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Matrices and vectors used to calculate fluxes and intensities at each level</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarrays</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.fluxes.setup_4_stream_fluxes">
<span class="sig-prename descclassname"><span class="pre">picaso.fluxes.</span></span><span class="sig-name descname"><span class="pre">setup_4_stream_fluxes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nlayer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nwno</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b_top</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b_surface</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b_surface_SH4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">surf_reflect</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ubar0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtau</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fluxes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calculation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.fluxes.setup_4_stream_fluxes" title="Link to this definition"></a></dt>
<dd><p>Setup up matrices to solve flux problem for spherical harmonics method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nlayer</strong> (<em>int</em>)  Number of layers</p></li>
<li><p><strong>nwno</strong> (<em>int</em>)  Number of wavenumber points</p></li>
<li><p><strong>w0</strong> (<em>numpy.ndarray</em>)  This is a matrix of nlayer by nwave. This describes the single scattering albedo of
the atmosphere. Note this is free of any Raman scattering or any d-eddington correction
that is sometimes included in reflected light calculations.</p></li>
<li><p><strong>b_top</strong> (<em>array</em>)  The diffuse radiation into the model at the top of the atmosphere</p></li>
<li><p><strong>b_surface</strong> (<em>array</em>)  The diffuse radiation into the model at the bottom. Includes emission, reflection
of the unattenuated portion of the direct beam</p></li>
<li><p><strong>b_surface_SH4</strong> (<em>array</em>)  Second bottom BC for SH4 method.</p></li>
<li><p><strong>surf_reflect</strong> (<em>numpy.ndarray</em>)  Surface reflectivity as a function of wavenumber.</p></li>
<li><p><strong>ubar0</strong> (<em>ndarray</em><em> of </em><em>float</em>)  matrix of cosine of the incident angle from geometric.json</p></li>
<li><p><strong>dtau</strong> (<em>numpy.ndarray</em>)  This is a matrix of nlayer by nwave. This describes the per layer optical depth.</p></li>
<li><p><strong>tau</strong> (<em>numpy.ndarray</em>)  This is a matrix of nlevel by nwave. This describes the cumulative optical depth.</p></li>
<li><p><strong>a</strong> (<em>numpy.ndarray</em>)  Coefficients of matrix capturing legendre expansion of phase function for multiple scattering</p></li>
<li><p><strong>b</strong> (<em>numpy.ndarray</em>)  Coefficients of source vector capturing legendre expansion of phase function for single
scattering</p></li>
<li><p><strong>B0</strong> (<em>numpy.ndarray</em>)  Matrix of blackbodies</p></li>
<li><p><strong>B1</strong> (<em>numpy.ndarray</em>)  Eqn (26) Toon 89</p></li>
<li><p><strong>fluxes</strong> (<em>int</em>)  Toggle calculation of layerwise fluxes (0 = do not calculate, 1 = calculate)</p></li>
<li><p><strong>calculation</strong> (<em>int</em>)  Toggle calculation method (0 = reflected, 1 = thermal)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Matrices and vectors used to calculate fluxes and intensities at each level</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarrays</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.fluxes.setup_pent_diag">
<span class="sig-prename descclassname"><span class="pre">picaso.fluxes.</span></span><span class="sig-name descname"><span class="pre">setup_pent_diag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nlayer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nwno</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c_plus_up</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c_minus_up</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c_plus_down</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c_minus_down</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b_top</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b_surface</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">surf_reflect</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gama</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtau</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exptrm_positive</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exptrm_minus</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">g1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">g2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exptrm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lamda</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.fluxes.setup_pent_diag" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nlayer</strong> (<em>int</em>)  number of layers in the model</p></li>
<li><p><strong>nwno</strong> (<em>int</em>)  number of wavelength points</p></li>
<li><p><strong>c_plus_up</strong> (<em>array</em>)  c-plus evaluated at the top of the atmosphere</p></li>
<li><p><strong>c_minus_up</strong> (<em>array</em>)  c_minus evaluated at the top of the atmosphere</p></li>
<li><p><strong>c_plus_down</strong> (<em>array</em>)  c_plus evaluated at the bottom of the atmosphere</p></li>
<li><p><strong>c_minus_down</strong> (<em>array</em>)  c_minus evaluated at the bottom of the atmosphere</p></li>
<li><p><strong>b_top</strong> (<em>array</em>)  The diffuse radiation into the model at the top of the atmosphere</p></li>
<li><p><strong>b_surface</strong> (<em>array</em>)  The diffuse radiation into the model at the bottom. Includes emission, reflection
of the unattenuated portion of the direct beam</p></li>
<li><p><strong>surf_reflect</strong> (<em>array</em>)  Surface reflectivity</p></li>
<li><p><strong>g1</strong> (<em>array</em>)  table 1 toon et al 1989</p></li>
<li><p><strong>g2</strong> (<em>array</em>)  table 1 toon et al 1989</p></li>
<li><p><strong>g3</strong> (<em>array</em>)  table 1 toon et al 1989</p></li>
<li><p><strong>lamba</strong> (<em>array</em>)  Eqn 21 toon et al 1989</p></li>
<li><p><strong>gama</strong> (<em>array</em>)  Eqn 22 toon et al 1989</p></li>
<li><p><strong>dtau</strong> (<em>array</em>)  Opacity per layer</p></li>
<li><p><strong>exptrm_positive</strong> (<em>array</em>)  Eqn 44, expoential terms needed for tridiagonal rotated layered, clipped at 35</p></li>
<li><p><strong>exptrm_minus</strong> (<em>array</em>)  Eqn 44, expoential terms needed for tridiagonal rotated layered, clipped at 35</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>coefficient of the positive exponential term</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.fluxes.setup_tri_diag">
<span class="sig-prename descclassname"><span class="pre">picaso.fluxes.</span></span><span class="sig-name descname"><span class="pre">setup_tri_diag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nlayer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nwno</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c_plus_up</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c_minus_up</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c_plus_down</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c_minus_down</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b_top</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b_surface</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">surf_reflect</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gama</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtau</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exptrm_positive</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exptrm_minus</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.fluxes.setup_tri_diag" title="Link to this definition"></a></dt>
<dd><p>Before we can solve the tridiagonal matrix (See Toon+1989) section
SOLUTION OF THE TwO-STREAM EQUATIONS FOR MULTIPLE LAYERS, we
need to set up the coefficients.
:param nlayer: number of layers in the model
:type nlayer: int
:param nwno: number of wavelength points
:type nwno: int
:param c_plus_up: c-plus evaluated at the top of the atmosphere
:type c_plus_up: array
:param c_minus_up: c_minus evaluated at the top of the atmosphere
:type c_minus_up: array
:param c_plus_down: c_plus evaluated at the bottom of the atmosphere
:type c_plus_down: array
:param c_minus_down: c_minus evaluated at the bottom of the atmosphere
:type c_minus_down: array
:param b_top: The diffuse radiation into the model at the top of the atmosphere
:type b_top: array
:param b_surface: The diffuse radiation into the model at the bottom. Includes emission, reflection</p>
<blockquote>
<div><p>of the unattenuated portion of the direct beam</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>surf_reflect</strong> (<em>array</em>)  Surface reflectivity</p></li>
<li><p><strong>g1</strong> (<em>array</em>)  table 1 toon et al 1989</p></li>
<li><p><strong>g2</strong> (<em>array</em>)  table 1 toon et al 1989</p></li>
<li><p><strong>g3</strong> (<em>array</em>)  table 1 toon et al 1989</p></li>
<li><p><strong>lamba</strong> (<em>array</em>)  Eqn 21 toon et al 1989</p></li>
<li><p><strong>gama</strong> (<em>array</em>)  Eqn 22 toon et al 1989</p></li>
<li><p><strong>dtau</strong> (<em>array</em>)  Opacity per layer</p></li>
<li><p><strong>exptrm_positive</strong> (<em>array</em>)  Eqn 44, expoential terms needed for tridiagonal rotated layered, clipped at 35</p></li>
<li><p><strong>exptrm_minus</strong> (<em>array</em>)  Eqn 44, expoential terms needed for tridiagonal rotated layered, clipped at 35</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>coefficient of the positive exponential term</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.fluxes.slice_eq">
<span class="sig-prename descclassname"><span class="pre">picaso.fluxes.</span></span><span class="sig-name descname"><span class="pre">slice_eq</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.fluxes.slice_eq" title="Link to this definition"></a></dt>
<dd><p>Funciton to replace values with upper or lower limit</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.fluxes.slice_gt">
<span class="sig-prename descclassname"><span class="pre">picaso.fluxes.</span></span><span class="sig-name descname"><span class="pre">slice_gt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lim</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.fluxes.slice_gt" title="Link to this definition"></a></dt>
<dd><p>Funciton to replace values with upper or lower limit</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.fluxes.slice_lt">
<span class="sig-prename descclassname"><span class="pre">picaso.fluxes.</span></span><span class="sig-name descname"><span class="pre">slice_lt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lim</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.fluxes.slice_lt" title="Link to this definition"></a></dt>
<dd><p>Funciton to replace values with upper or lower limit</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.fluxes.slice_lt_cond">
<span class="sig-prename descclassname"><span class="pre">picaso.fluxes.</span></span><span class="sig-name descname"><span class="pre">slice_lt_cond</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cond_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cond</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">newval</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.fluxes.slice_lt_cond" title="Link to this definition"></a></dt>
<dd><p>Funciton to replace values with upper or lower limit</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.fluxes.slice_lt_cond_arr">
<span class="sig-prename descclassname"><span class="pre">picaso.fluxes.</span></span><span class="sig-name descname"><span class="pre">slice_lt_cond_arr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cond_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cond</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">newarray</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.fluxes.slice_lt_cond_arr" title="Link to this definition"></a></dt>
<dd><p>Funciton to replace values with upper or lower limit</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.fluxes.slice_rav">
<span class="sig-prename descclassname"><span class="pre">picaso.fluxes.</span></span><span class="sig-name descname"><span class="pre">slice_rav</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lim</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.fluxes.slice_rav" title="Link to this definition"></a></dt>
<dd><p>Funciton to replace values with upper or lower limit</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.fluxes.solve_4_stream_banded">
<span class="sig-prename descclassname"><span class="pre">picaso.fluxes.</span></span><span class="sig-name descname"><span class="pre">solve_4_stream_banded</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">M</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stream</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.fluxes.solve_4_stream_banded" title="Link to this definition"></a></dt>
<dd><p>Solve the Spherical Harmonics Problem</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>intgrl_new</strong> (<em>numpy.ndarray</em>)  Integrated source function for source function technique</p></li>
<li><p><strong>flux</strong> (<em>numpy.ndarray</em>)  Upwards lux at bottom of atmosphere</p></li>
<li><p><strong>X</strong> (<em>numpy.ndarray</em>)  Coefficients of flux/intensity matrix problem</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.fluxes.spline_deprecate">
<span class="sig-prename descclassname"><span class="pre">picaso.fluxes.</span></span><span class="sig-name descname"><span class="pre">spline_deprecate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yp0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ypn</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.fluxes.spline_deprecate" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.fluxes.tidal_flux">
<span class="sig-prename descclassname"><span class="pre">picaso.fluxes.</span></span><span class="sig-name descname"><span class="pre">tidal_flux</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">T_e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nlevel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pressure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_den</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">InjectionBundle</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.fluxes.tidal_flux" title="Link to this definition"></a></dt>
<dd><p>Computes Tidal Fluxes in all levels. Py of TIDALWAVE subroutine.</p>
<dl class="simple">
<dt>Parameters</dt><dd><dl class="simple">
<dt>T_e<span class="classifier">float</span></dt><dd><p>Temperature (internal?)</p>
</dd>
<dt>wave_in<span class="classifier">float</span></dt><dd><p>what is this?</p>
</dd>
<dt>nlevel<span class="classifier">int</span></dt><dd><p># of levels</p>
</dd>
<dt>pressure<span class="classifier">array</span></dt><dd><p>pressure array</p>
</dd>
<dt>pm<span class="classifier">float</span></dt><dd><p>Some pressure (?)</p>
</dd>
</dl>
</dd>
<dt>hratio<span class="classifier">float</span></dt><dd><p>Ratio of Scale Height over Chapman Scale Height</p>
</dd>
<dt>col_den<span class="classifier">array</span></dt><dd><p>Column density array</p>
</dd>
<dt>inject_beam<span class="classifier">bool</span></dt><dd><p>If True, inject an energy beam into the model</p>
</dd>
<dt>beam_profile<span class="classifier">array</span></dt><dd><p>Beam profile to inject into the model. If None, no beam is injected.</p>
</dd>
<dt>Returns</dt><dd><p>Tidal Fluxes and DE/DM in ergs/g sec</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.fluxes.tri_diag_solve">
<span class="sig-prename descclassname"><span class="pre">picaso.fluxes.</span></span><span class="sig-name descname"><span class="pre">tri_diag_solve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">l</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.fluxes.tri_diag_solve" title="Link to this definition"></a></dt>
<dd><p>Tridiagonal Matrix Algorithm solver, a b c d can be NumPy array type or Python list type.
refer to this <a class="reference external" href="http://en.wikipedia.org/wiki/Tridiagonal_matrix_algorithm">wiki</a> and to this <a class="reference external" href="http://www.cfd-online.com/Wiki/Tridiagonal_matrix_algorithm_-_TDMA_(Thomas_algorithm)">explanation</a>.</p>
<p>A, B, C and D refer to:
.. math:: A(I)*X(I-1) + B(I)*X(I) + C(I)*X(I+1) = D(I)
This solver returns X.
:param A:
:type A: array or list
:param B:
:type B: array or list
:param C:
:type C: array or list
:param C:
:type C: array or list</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Solution, x</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.fluxes.vec_dot">
<span class="sig-prename descclassname"><span class="pre">picaso.fluxes.</span></span><span class="sig-name descname"><span class="pre">vec_dot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.fluxes.vec_dot" title="Link to this definition"></a></dt>
<dd><p>Vector-vector dot product</p>
</dd></dl>

</section>
<section id="module-picaso.io_utils">
<span id="picaso-io-utils-module"></span><h2>picaso.io_utils module<a class="headerlink" href="#module-picaso.io_utils" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="picaso.io_utils.read_hdf">
<span class="sig-prename descclassname"><span class="pre">picaso.io_utils.</span></span><span class="sig-name descname"><span class="pre">read_hdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">requires</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">raise_except</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.io_utils.read_hdf" title="Link to this definition"></a></dt>
<dd><p>read in H5 format file and pull out specific table based on specific
header information in the requires field. return None if file is not there</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>str</em>)  name of H5 file to read</p></li>
<li><p><strong>requires</strong> (<em>dict</em>)  dictionary with keys and values to get correct table
e.g. {wmin:0.3, wmax:1, R:5000} for opacity grid</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>d</strong>  data from H5 file decoded into python object</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>python object</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.io_utils.read_json">
<span class="sig-prename descclassname"><span class="pre">picaso.io_utils.</span></span><span class="sig-name descname"><span class="pre">read_json</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.io_utils.read_json" title="Link to this definition"></a></dt>
<dd><p>read in a JSON format file.  return None if the file is not there.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>string</em>)  name of the JSON file to read</p></li>
<li><p><strong>except</strong> (<em>bool</em>)  if true, raise exception if file is missing. if false, return empty dict.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>d</strong>  data from JSON file decoded into python object</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>python object</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.io_utils.read_visscher_2121">
<span class="sig-prename descclassname"><span class="pre">picaso.io_utils.</span></span><span class="sig-name descname"><span class="pre">read_visscher_2121</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.io_utils.read_visscher_2121" title="Link to this definition"></a></dt>
<dd><p>Explicit function to read and reformat channons files</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>filename</strong> (<em>chem filename</em>)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>columns include temperature (Kelvin), pressure (bar), and all molecules (v/v mixing ratio)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas df</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.io_utils.write_all_profiles">
<span class="sig-prename descclassname"><span class="pre">picaso.io_utils.</span></span><span class="sig-name descname"><span class="pre">write_all_profiles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_all_profiles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_profiles</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.io_utils.write_all_profiles" title="Link to this definition"></a></dt>
<dd><p>Saves all T(P) profiles to the file in save_all_profiles</p>
</dd></dl>

</section>
<section id="module-picaso.justdoit">
<span id="picaso-justdoit-module"></span><h2>picaso.justdoit module<a class="headerlink" href="#module-picaso.justdoit" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="picaso.justdoit.HJ_cld">
<span class="sig-prename descclassname"><span class="pre">picaso.justdoit.</span></span><span class="sig-name descname"><span class="pre">HJ_cld</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.HJ_cld" title="Link to this definition"></a></dt>
<dd><p>Function to get rough Jupiter Cloud model with fsed=3</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.justdoit.HJ_pt">
<span class="sig-prename descclassname"><span class="pre">picaso.justdoit.</span></span><span class="sig-name descname"><span class="pre">HJ_pt</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.HJ_pt" title="Link to this definition"></a></dt>
<dd><p>Function to get Jupiters PT profile</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.justdoit.HJ_pt_3d">
<span class="sig-prename descclassname"><span class="pre">picaso.justdoit.</span></span><span class="sig-name descname"><span class="pre">HJ_pt_3d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">as_xarray</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_kz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'/data/reference_data/picaso/ref4/base_cases/HJ_3d.pt'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.HJ_pt_3d" title="Link to this definition"></a></dt>
<dd><p>Function to get Jupiters PT profile</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>as_xarray</strong> (<em>bool</em>)  Returns as xarray, instead of dictionary</p></li>
<li><p><strong>add_kz</strong> (<em>bool</em>)  Returns kzz along with PT info</p></li>
<li><p><strong>input_file</strong> (<em>str</em>)  point to input file in the same format as mitgcm example
file in base_cases/HJ_3d.pt</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.justdoit.SH_calculate_fluxes_options">
<span class="sig-prename descclassname"><span class="pre">picaso.justdoit.</span></span><span class="sig-name descname"><span class="pre">SH_calculate_fluxes_options</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">printout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.SH_calculate_fluxes_options" title="Link to this definition"></a></dt>
<dd><p>Retrieve options for calculating layerwise fluxes</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.justdoit.SH_psingle_form_options">
<span class="sig-prename descclassname"><span class="pre">picaso.justdoit.</span></span><span class="sig-name descname"><span class="pre">SH_psingle_form_options</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">printout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.SH_psingle_form_options" title="Link to this definition"></a></dt>
<dd><p>Retrieve options for direct scattering form approximation</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.justdoit.SH_rayleigh_options">
<span class="sig-prename descclassname"><span class="pre">picaso.justdoit.</span></span><span class="sig-name descname"><span class="pre">SH_rayleigh_options</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">printout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.SH_rayleigh_options" title="Link to this definition"></a></dt>
<dd><p>Retrieve options for rayleigh scattering</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.justdoit.SH_scattering_options">
<span class="sig-prename descclassname"><span class="pre">picaso.justdoit.</span></span><span class="sig-name descname"><span class="pre">SH_scattering_options</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">printout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.SH_scattering_options" title="Link to this definition"></a></dt>
<dd><p>Retrieve all the options for scattering radiation in SH</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.justdoit.all_planets">
<span class="sig-prename descclassname"><span class="pre">picaso.justdoit.</span></span><span class="sig-name descname"><span class="pre">all_planets</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.all_planets" title="Link to this definition"></a></dt>
<dd><p>Load all planets from <a class="reference external" href="https://exoplanetarchive.ipac.caltech.edu">https://exoplanetarchive.ipac.caltech.edu</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.justdoit.brown_dwarf_cld">
<span class="sig-prename descclassname"><span class="pre">picaso.justdoit.</span></span><span class="sig-name descname"><span class="pre">brown_dwarf_cld</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.brown_dwarf_cld" title="Link to this definition"></a></dt>
<dd><p>Function to get rough Brown Dwarf cloud model with Teff=1270 K M/H=1xSolar, C/O=1xSolar, fsed=1</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.justdoit.brown_dwarf_pt">
<span class="sig-prename descclassname"><span class="pre">picaso.justdoit.</span></span><span class="sig-name descname"><span class="pre">brown_dwarf_pt</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.brown_dwarf_pt" title="Link to this definition"></a></dt>
<dd><p>Function to get rough Brown Dwarf climate model with Teff=1270 K M/H=1xSolar, C/O=1xSolar, fsed=1</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.justdoit.check_units">
<span class="sig-prename descclassname"><span class="pre">picaso.justdoit.</span></span><span class="sig-name descname"><span class="pre">check_units</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">unit</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.check_units" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.justdoit.convert_flux_units">
<span class="sig-prename descclassname"><span class="pre">picaso.justdoit.</span></span><span class="sig-name descname"><span class="pre">convert_flux_units</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xgrid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flux</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_f_unit</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xgrid_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cm^(-1)'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'erg*cm^(-3)*s^(-1)'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.convert_flux_units" title="Link to this definition"></a></dt>
<dd><p>Simple function to convert flux units using sts source spectrum technique from picaso defaults
Always returns flux in ordered</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xgrid</strong> (<em>ndarray</em>)  Wavelength or wavenumber array</p></li>
<li><p><strong>flux</strong> (<em>ndarray</em>)  Flux array</p></li>
<li><p><strong>to_xgrid_unit</strong> (<em>str</em>)  astropy approved string unit</p></li>
<li><p><strong>to_f_unit</strong> (<em>str</em>)  astropy approved string unit</p></li>
<li><p><strong>xgrid_unit</strong> (<em>str</em><em>, </em><em>default</em>)  current units, default is picaso original cm^(-1)</p></li>
<li><p><strong>f_unit</strong> (<em>str</em><em>, </em><em>default</em>)  current units, default is picaso original erg*cm^(-3)*s^(-1)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.justdoit.evolution_track">
<span class="sig-prename descclassname"><span class="pre">picaso.justdoit.</span></span><span class="sig-name descname"><span class="pre">evolution_track</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mass</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">age</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.evolution_track" title="Link to this definition"></a></dt>
<dd><p>Plot or grab an effective temperature for a certain age and mass planet.
:param mass: (Optional) Mass of planet, in Jupiter Masses. Only valid options = 1, 2, 4, 6, 8, 10,all</p>
<blockquote>
<div><p>If another value is entered, it will find the nearest option.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>age</strong> (<em>float</em><em> or </em><em>str</em><em>, </em><em>optional</em>)  (Optional) Age of planet, in years or all to return full model</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>if age=None</strong> (<em>data = {cold:all_data_cold_start, hot:all_data_hot_start}</em>)</p></li>
<li><p><strong>if age=float</strong> (<em>data = {cold:data_at_age, hot:data_at_age}</em>)</p></li>
<li><p><strong>if plot=False</strong> (<em>returns data</em>)</p></li>
<li><p><strong>else</strong> (<em>returns data, plot</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.justdoit.find_press">
<span class="sig-prename descclassname"><span class="pre">picaso.justdoit.</span></span><span class="sig-name descname"><span class="pre">find_press</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">at_tau</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.find_press" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.justdoit.get_contribution">
<span class="sig-prename descclassname"><span class="pre">picaso.justdoit.</span></span><span class="sig-name descname"><span class="pre">get_contribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bundle</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opacityclass</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">at_tau</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dimension</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'1d'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.get_contribution" title="Link to this definition"></a></dt>
<dd><p>Currently top level program to run albedo code</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bundle</strong> (<em>dict</em>)  This input dict is built by loading the input = <cite>justdoit.load_inputs()</cite></p></li>
<li><p><strong>opacityclass</strong> (<em>class</em>)  Opacity class from <cite>justdoit.opannection</cite></p></li>
<li><p><strong>at_tau</strong> (<em>float</em>)  (Optional) Default = 1, This is to compute the pressure level at which cumulative opacity reaches
at_tau. Usually users want to know when the cumulative opacity reaches a tau of 1.</p></li>
<li><p><strong>dimension</strong> (<em>str</em>)  (Optional) Default = 1d. Currently only 1d is supported.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>taus_by_species</strong> (<em>dict</em>)  Each dictionary entry is a nlayer x nwave that represents the
per layer optical depth for that molecule. If you do not see
a molecule that you have added as input, check to make sure it is
propertly formatted (e.g. Sodium must be Na not NA, Titanium Oxide must be TiO not TIO)</p></li>
<li><p><strong>cumsum_taus</strong> (<em>dict</em>)  Each dictionary entry is a nlevel x nwave that represents the cumulative summed opacity
for that molecule. If you do not see a molecule that you have added as input, check to make sure it is
propertly formatted (e.g. Sodium must be Na not NA, Titanium Oxide must be TiO not TIO)</p></li>
<li><p><strong>at_pressure_array</strong> (<em>dict</em>)  Each dictionary entry is a nwave array that represents the
pressure level where the cumulative opacity reaches the value specieid by the user through <cite>at_tau</cite>.
If you do not see a molecule that you have added as input, check to make sure it is
a molecule that you have added as input, check to make sure it is
propertly formatted (e.g. Sodium must be Na not NA, Titanium Oxide must be TiO not TIO)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.justdoit.get_targets">
<span class="sig-prename descclassname"><span class="pre">picaso.justdoit.</span></span><span class="sig-name descname"><span class="pre">get_targets</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.get_targets" title="Link to this definition"></a></dt>
<dd><p>Function to grab available targets using exoplanet archive data.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dataframe from Exoplanet Archive</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.justdoit.input_xarray">
<span class="sig-prename descclassname"><span class="pre">picaso.justdoit.</span></span><span class="sig-name descname"><span class="pre">input_xarray</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xr_usr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opacity</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calculation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'planet'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">approx_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.input_xarray" title="Link to this definition"></a></dt>
<dd><p>This takes an input based on these standards and runs:
-gravity
-phase_angle
-star
-approx (p_reference=10)
-atmosphere
-clouds (if there are any)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xr_usr</strong> (<em>xarray</em>)  xarray based on ERS formatting requirements</p></li>
<li><p><strong>opacity</strong> (<em>justdoit.opannection</em>)  opacity connection</p></li>
<li><p><strong>approx_kwargs</strong> (<em>dict</em>)  any key words to pass to the approx class</p></li>
<li><p><strong>calculation</strong> (<em>str</em>)  planet or browndwarf</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<p>case = jdi.input_xarray(xr_user)
case.spectrum(opacity,calculation=transit_depth)</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="picaso.justdoit.inputs">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">picaso.justdoit.</span></span><span class="sig-name descname"><span class="pre">inputs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">calculation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'planet'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">climate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.inputs" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class to setup planet to run</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>calculation</strong> (<em>str</em>)  (Optional) Controls planet or brown dwarf calculation. Default = planet. Other option is browndwarf.</p></li>
<li><p><strong>climate</strong> (<em>bool</em>)  (Optional) If true, this do a thorough iterative calculation to compute
a temperature pressure profile.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="picaso.justdoit.inputs.phase_angle">
<span class="sig-name descname"><span class="pre">phase_angle</span></span><a class="headerlink" href="#picaso.justdoit.inputs.phase_angle" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>set phase angle</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="picaso.justdoit.inputs.gravity">
<span class="sig-name descname"><span class="pre">gravity</span></span><a class="headerlink" href="#picaso.justdoit.inputs.gravity" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>set gravity</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="picaso.justdoit.inputs.star">
<span class="sig-name descname"><span class="pre">star</span></span><a class="headerlink" href="#picaso.justdoit.inputs.star" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>set stellar spec</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="picaso.justdoit.inputs.atmosphere">
<span class="sig-name descname"><span class="pre">atmosphere</span></span><a class="headerlink" href="#picaso.justdoit.inputs.atmosphere" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>set atmosphere composition and PT</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="picaso.justdoit.inputs.clouds">
<span class="sig-name descname"><span class="pre">clouds</span></span><a class="headerlink" href="#picaso.justdoit.inputs.clouds" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>set cloud profile</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="picaso.justdoit.inputs.approx">
<span class="sig-name descname"><span class="pre">approx</span></span><a class="headerlink" href="#picaso.justdoit.inputs.approx" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>set approximation</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="picaso.justdoit.inputs.spectrum">
<span class="sig-name descname"><span class="pre">spectrum</span></span><a class="headerlink" href="#picaso.justdoit.inputs.spectrum" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>create spectrum</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="picaso.justdoit.inputs.TP_line_earth">
<span class="sig-name descname"><span class="pre">TP_line_earth</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">P</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Tsfc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">294.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Psfc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gam_trop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.18</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ptrop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.199</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gam_strat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-0.045</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Pstrat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nlevel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">150</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.inputs.TP_line_earth" title="Link to this definition"></a></dt>
<dd><p>Author: Mike R. Line
Estimates Earths pressure-temperature profile. All default
values have been tuned to semi reproduce Earths temperature
pressure profile.
:param P: Pressure array usually np.logspace(-6,2,nlevel)
:type P: array
:param Tsfc: Surface Temperature (K). Earth is 294 K
:type Tsfc: float,optional
:param Psfc: Surface Pressure (bar). Earth is 1 bar.
:type Psfc: float ,optional
:param gam_trop: Tropospheric dry lapse rate. Earth is ~0.18
:type gam_trop: float ,optional
:param Ptrop: Tropospheric pressure. Earth 0.199 bar.
:type Ptrop: float ,optional
:param gam_strat: Stratospheric lapse rate. Earth is -0.045
:type gam_strat: float ,optional
:param Pstrat: Stratospheric pressure (bars). Earth is 0.001 bar. /
:type Pstrat: float ,optional
:param nlevel: Number of grid levels
:type nlevel: int ,optional</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Temperature array (K)Psfc</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="picaso.justdoit.inputs.T_eff">
<span class="sig-name descname"><span class="pre">T_eff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Teff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.inputs.T_eff" title="Link to this definition"></a></dt>
<dd><p>Get Teff for climate run</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>T_eff</strong> (<em>float</em>)  (Optional) Effective temperature of Planet</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="picaso.justdoit.inputs.add_pt">
<span class="sig-name descname"><span class="pre">add_pt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">T</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">P</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">P_config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.inputs.add_pt" title="Link to this definition"></a></dt>
<dd><p>Adds temperature pressure profile to atmosphere, keeps kzz if it exists, wipes everything else out.
:param T: Temperature Array in Kelbin
:type T: array
:param P: Pressure Array in bars
:type P: array</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>in PICASO format
also sets the nlevels and nlayers
temperature : numpy.array</p>
<blockquote>
<div><p>Temperature grid in Kelvin</p>
</div></blockquote>
<dl class="simple">
<dt>pressure<span class="classifier">numpy.array</span></dt><dd><p>Pressure grid in bars</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="picaso.justdoit.inputs.adjust_quench_chemistry">
<span class="sig-name descname"><span class="pre">adjust_quench_chemistry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">quench_levels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chemistry_table</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.inputs.adjust_quench_chemistry" title="Link to this definition"></a></dt>
<dd><p>Adjusts the abundances of quenched species in the chemistry profile based on the provided quench levels.
CO2 is defaulted to do the Zahnle and Marley (2014) kinetic fix outlined in Wogan et al. 2025 research note.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>quench_levels</strong> (<em>dict</em>)  Dictionary with the quench levels for each molecule.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id0">
<span class="sig-name descname"><span class="pre">approx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">single_phase</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'TTHG_ray'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multi_phase</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'N=2'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta_eddington</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">raman</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pollack'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tthg_frac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[1,</span> <span class="pre">-1,</span> <span class="pre">2]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tthg_back</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tthg_forward</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_reference</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rt_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'toon'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stream</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">toon_coefficients</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'quadrature'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">single_form</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'explicit'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calculate_fluxes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'off'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w_single_form</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'TTHG'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w_multi_form</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'TTHG'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psingle_form</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'TTHG'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w_single_rayleigh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'on'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w_multi_rayleigh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'on'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psingle_rayleigh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'on'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_lvl_flux</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#id0" title="Link to this definition"></a></dt>
<dd><p>This function REsets all the default approximations in the code from what is in config file.
This means that it will rewrite what is specified via config file defaults.
It transforms the string specificatons
into a number so that they can be used in numba nopython routines.</p>
<p>To see the <cite>str</cite> cases such as <cite>TTHG_ray</cite> users see all the options by using the function <cite>justdoit.single_phase_options</cite>
or <cite>justdoit.multi_phase_options</cite>, etc.</p>
<dl class="simple">
<dt>single_phase<span class="classifier">str</span></dt><dd><p>Single scattering phase function approximation</p>
</dd>
<dt>multi_phase<span class="classifier">str</span></dt><dd><p>Multiple scattering phase function approximation</p>
</dd>
<dt>delta_eddington<span class="classifier">bool</span></dt><dd><p>Turns delta-eddington on and off</p>
</dd>
<dt>raman<span class="classifier">str</span></dt><dd><p>Uses various versions of raman scattering
default is to use the pollack approximation</p>
</dd>
<dt>tthg_frac<span class="classifier">list</span></dt><dd><p>Functional of forward to back scattering with the form of polynomial :
tthg_frac[0] + tthg_frac[1]*g_b^tthg_frac[2]
See eqn. 6 in picaso paper</p>
</dd>
<dt>tthg_back<span class="classifier">float</span></dt><dd><p>Back scattering asymmetry factor gf = g_bar*tthg_back</p>
</dd>
<dt>tthg_forward<span class="classifier">float</span></dt><dd><p>Forward scattering asymmetry factor gb = g_bar * tthg_forward</p>
</dd>
<dt>p_reference<span class="classifier">float</span></dt><dd><p>Reference pressure (bars) This is an arbitrary pressure that
corresponds do the users input of radius. Usually something at depth
around 1-10 bars.</p>
</dd>
<dt>method<span class="classifier">str</span></dt><dd><p>Toon (toon) or spherical harmonics (SH).</p>
</dd>
<dt>stream<span class="classifier">int</span></dt><dd><p>Two stream or four stream (options are 2 or 4). For 4 stream need to set method=SH</p>
</dd>
<dt>toon_coefficients: str</dt><dd><p>Decide whether to use Quadrature (quadrature) or Eddington (eddington) schemes
to define Toon coefficients in two-stream approximation (see Table 1 in Toon et al 1989)</p>
</dd>
<dt>single_form<span class="classifier">str</span></dt><dd><p>form of the phase function can either be written as an explicit henyey greinstein
or it can be written as a legendre expansion. Default is explicit</p>
</dd>
<dt>w_single_form<span class="classifier">str</span></dt><dd><p>Single scattering phase function approximation for SH</p>
</dd>
<dt>w_multi_form<span class="classifier">str</span></dt><dd><p>Multiple scattering phase function approximation for SH</p>
</dd>
<dt>psingle_form<span class="classifier">str</span></dt><dd><p>Scattering phase function approximation for psingle in SH</p>
</dd>
<dt>w_single_rayleigh<span class="classifier">str</span></dt><dd><p>Toggle rayleigh scattering on/off for single scattering in SH</p>
</dd>
<dt>w_multi_rayleigh<span class="classifier">str</span></dt><dd><p>Toggle rayleigh scattering on/off for multi scattering in SH</p>
</dd>
<dt>psingle_rayleigh<span class="classifier">str</span></dt><dd><p>Toggle rayleigh scattering on/off for psingle in SH</p>
</dd>
<dt>get_lvl_flux<span class="classifier">bool</span></dt><dd><p>This parameter returns the level by level and layer by layer
fluxes in the full output
Default is False</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id7">
<span class="sig-name descname"><span class="pre">atmosphere</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude_mol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cto_absolute</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cto_relative</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chem_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quench</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no_ph3</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cold_trap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vol_rainout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">photochem_init_args</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_visscher_abunds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">pd_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#id7" title="Link to this definition"></a></dt>
<dd><p>Builds a dataframe and makes sure that minimum necessary parameters have been suplied.
Sets number of layers in model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pandas.DataFrame</em><em> or </em><em>dict</em>)  (Optional) Dataframe with volume mixing ratios and pressure, temperature profile.
Must contain pressure (bars) at least one molecule</p></li>
<li><p><strong>filename</strong> (<em>str</em>)  (Optional) Filename with pressure, temperature and volume mixing ratios.
Must contain pressure at least one molecule</p></li>
<li><p><strong>exclude_mol</strong> (<em>list</em><em> of </em><em>str</em>)  (Optional) List of molecules to ignore from opacity. It will NOT
change other aspects of the calculation like mean molecular weight.
This should be used as exploratory ONLY. if you actually want to remove
the contribution of a molecule entirely from your profile you should remove
it from your input data frame.</p></li>
<li><p><strong>mh</strong> (<em>float</em>)  Metallicity relative to Solar</p></li>
<li><p><strong>cto_relative</strong> (<em>float</em>)  Carbon-to-Oxygen Ratio relative to Solar (Solar value is determined by <cite>chem_method</cite>)</p></li>
<li><p><strong>cto_absolute</strong> (<em>float</em>)  Carbon-to-Oxygen Ratio in absolute terms (e.g. 0.55)</p></li>
<li><p><strong>chem_method</strong> (<em>str</em>)  <p>Current options:
- visscher : uses the 2121 chemical equilibrium tables computed by Channon Visscher via the function <cite>chemeq_visscher</cite></p>
<blockquote>
<div><p>if visscher needs to input: mh and cto</p>
</div></blockquote>
<ul>
<li><dl>
<dt>visscher_1060<span class="classifier">uses the chemical equilibrium tables computed by Channon Visscher on the 1060 grid via the function <cite>chemeq_visscher</cite></span></dt><dd><p>if visscher needs to input: mh and cto</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>photochem<span class="classifier">users photochem model by Nick Wogan</span></dt><dd><p>if photochem user needs to input photochem_init_args and photochem_TOA_pressure</p>
</dd>
</dl>
</li>
</ul>
</p></li>
<li><p><strong>quench</strong> (<em>bool</em>)  Climate only, default = False: no quencing</p></li>
<li><p><strong>no_ph3</strong> (<em>bool</em>)  Climate only chem hack, default=False: True removes any PH3 from the atmosphere</p></li>
<li><p><strong>cold_trap</strong> (<em>bool</em>)  Climate only chem hack, default=False: Force H2O and NH3 abundances to be cold trapped after condensation.</p></li>
<li><p><strong>vol_rainint</strong> (<em>bool ;</em>)  Climate only chem hack, default=False: will rainout volatiles like H2O, CH4 and NH3 in diseq runs as in equilibrium model when applicable</p></li>
<li><p><strong>photochem_init_args</strong> (<em>dict</em>)  <p>Dictionary containing initialization arguments for photochem. Should contain the following keys
- mechanism_file : str</p>
<blockquote>
<div><p>Path to the file describing the reaction mechanism</p>
</div></blockquote>
<ul>
<li><dl class="simple">
<dt>stellar_flux_file<span class="classifier">str</span></dt><dd><p>Path to the file describing the stellar UV flux.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>planet_mass<span class="classifier">float</span></dt><dd><p>Planet mass in grams</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>planet_radius<span class="classifier">float</span></dt><dd><p>Planet radius in cm</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>nz<span class="classifier">int, optional</span></dt><dd><p>The number of layers in the photochemical model, by default 100</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>P_ref<span class="classifier">float, optional</span></dt><dd><p>Pressure level corresponding to the planet_radius, by default 1e6 dynes/cm^2</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>thermo_file<span class="classifier">str, optional</span></dt><dd><p>Optionally include a dedicated thermodynamic file.</p>
</dd>
</dl>
</li>
<li><p>TOA_pressure : float</p></li>
</ul>
<p>Pressure at the top of the atmosphere for photochem, by default 1e-7 bar. Unit must be in dynes/cm^2</p>
</p></li>
<li><p><strong>add_visscher_abunds</strong> (<em>bool</em>)  Default = False; Only used for photochemical results. Adds visscher to fill gaps covered by the photochemical mdoel</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>)  (Optional) prints out warnings. Default set to True</p></li>
<li><p><strong>pd_kwargs</strong> (<em>kwargs</em>)  Key word arguments for pd.read_csv to read in supplied atmosphere file</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="picaso.justdoit.inputs.atmosphere_3d">
<span class="sig-name descname"><span class="pre">atmosphere_3d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regrid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iz_plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.inputs.atmosphere_3d" title="Link to this definition"></a></dt>
<dd><p>Checks your xarray input to make sure the necessary elements are included. If
requested, it will regrid your output according to what you have specified in
phase_angle() routine. If you have not requested a regrid, it will check to make
sure that the latitude/longitude grid that you have specified in your xarray
is the same one that you have set in the phase_angle() routine.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ds</strong> (<em>xarray.DataArray</em>)  xarray input grid (see GCM 3D input tutorials)</p></li>
<li><p><strong>regrid</strong> (<em>bool</em>)  If True, this will auto regrid your data, based on the input to the
phase_angle function you have supllied
If False, it will skip regridding. However, this assumes that you have already
regridded your data to the necessary gangles and tangles. PICASO will double check
for you by comparing latitude/longitudes of what is in your xarray to what was computed
in the phase_angle function.</p></li>
<li><p><strong>plot</strong> (<em>bool</em>)  If True, this will auto output a regridded plot</p></li>
<li><p><strong>iz_plot</strong> (<em>int</em>)  Altitude index to plot if it is requested</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>)  If True, this will plot out messages, letting you know if your input data is being transformed</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="picaso.justdoit.inputs.atmosphere_4d">
<span class="sig-name descname"><span class="pre">atmosphere_4d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shift</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iz_plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zero_point</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'night_transit'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.inputs.atmosphere_4d" title="Link to this definition"></a></dt>
<dd><p>Regrids xarray</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ds</strong> (<em>xarray.DataArray</em>)  xarray input grid (see GCM 3D input tutorials)
Only optional if you have already defined your dataframe to
self.inputs[atmosphere][profile]</p></li>
<li><p><strong>shift</strong> (<em>array</em>)  Degrees, for each orbital <cite>phase</cite>, <cite>picaso</cite> will rotate the longitude grid <cite>phase_i`+`shift_i</cite>.
For example, for tidally locked planets, <cite>shift`=0 at all phase angles.
Therefore, `shift</cite> must be input as an array of length <cite>n_phase</cite>, set by phase_angle() routine.
Use plot=True to understand how your grid is being shifted.</p></li>
<li><p><strong>plot</strong> (<em>bool</em>)  If True, this will auto output a regridded plot</p></li>
<li><p><strong>iz_plot</strong> (<em>bool</em>)  pressure index to plot</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>)  If True, this will plot out messages, letting you know if your input data is being transformed</p></li>
<li><p><strong>zero_point</strong> (<em>str</em>)  Is your zero point night_transit, or secondary_eclipse
Default, night_transit</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="picaso.justdoit.inputs.channon_grid_low">
<span class="sig-name descname"><span class="pre">channon_grid_low</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.inputs.channon_grid_low" title="Link to this definition"></a></dt>
<dd><p>Interpolate from visscher grid</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="picaso.justdoit.inputs.chem_interp">
<span class="sig-name descname"><span class="pre">chem_interp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chem_grid</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.inputs.chem_interp" title="Link to this definition"></a></dt>
<dd><p>Interpolates chemistry based on dataframe input of either 1460 or 1060 grid
This particular function needs to have all molecules as columns as well as
pressure and temperature</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="picaso.justdoit.inputs.chemeq_3d">
<span class="sig-name descname"><span class="pre">chemeq_3d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">c_o</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_mh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cto_absolute</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.55</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_cpu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.inputs.chemeq_3d" title="Link to this definition"></a></dt>
<dd><p>You must have already ran atmosphere_3d or pre-defined an xarray gcm
before running this function.</p>
<p>This function will post-process sonora chemical equillibrium
chemistry onto your 3D grid.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>c_o</strong> (<em>float</em><em>,</em><em>optional</em>)  default = 1 (solar), options= 0.5X, 1.0X, 1.5X, 2.0X, 2.5X</p></li>
<li><p><strong>log_mh</strong> (<em>float</em><em>, </em><em>optional</em>)  default = 0 (solar), options = 0.0, 0.5, 1.0, 1.5, 1.7, 2.0</p></li>
<li><p><strong>n_cpu</strong> (<em>int</em>)  Number of cpu to use for parallelization of chemistry</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="picaso.justdoit.inputs.chemeq_visscher">
<span class="sig-name descname"><span class="pre">chemeq_visscher</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">c_o</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_mh</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.inputs.chemeq_visscher" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="picaso.justdoit.inputs.chemeq_visscher_1060">
<span class="sig-name descname"><span class="pre">chemeq_visscher_1060</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">c_o</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_mh</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.inputs.chemeq_visscher_1060" title="Link to this definition"></a></dt>
<dd><p>Author of Data: Channon Visscher</p>
<p>Find nearest neighbor from visscher grid
JUNE 2015
MODELS BASED ON 1060-POINT MARLEY GRID
GRAPHITE ACTIVITY ADDED IN TEXT FILES (AFTER OCS)
ABUNDANCE INDICATES CONDENSATION CONDITION (O OR 1)
CURRENT GRID</p>
<p>FE/H: 0.0, 0.5, 1.0, 1.5, 1.7, 2.0</p>
<p>C/O: 0.5X, 1.0X, 1.5X, 2.0X, 2.5X</p>
<p>The <em>solar</em> carbon-to-oxygen ratio is calculated from Lodders (2010):</p>
<p>CARBON = 7.19E6 ATOMS
OXYGEN = 1.57E7 ATOMS</p>
<p>This gives a solar C/O ratio of 0.458</p>
<p>The C/O ratio adjusted by keeping C + O = constant and adjusting the carbon-to-oxygen ratio by a factor relative to the solar value (i.e., a factor of 1 means 1x the solar value, i.e. a C/O ratio of 0.458).</p>
<p>This approach keeps the heavy-element-to-hydrogen ratio (Z/X) constant for a given [Fe/H]</p>
<p>These abundances are then multiplied by the metallicity factor (10**[Fe/H]) along with every other element in the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>co</strong> (<em>int</em>)  carbon to oxygen ratio relative to solar.
Solar = 1</p></li>
<li><p><strong>log_mh</strong> (<em>int</em>)  metallicity (relative to solar)
Will find the nearest value to 0.0, 0.5, 1.0, 1.5, 1.7, 2.0
Solar = 0</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="picaso.justdoit.inputs.chemeq_visscher_2121">
<span class="sig-name descname"><span class="pre">chemeq_visscher_2121</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cto_absolute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_mh</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.inputs.chemeq_visscher_2121" title="Link to this definition"></a></dt>
<dd><p>Author of Data: Channon Visscher</p>
<p>SONORAPY 2020 CHEMISTRY GRIDS README
<strong>*BETA VERSION*</strong> Spring 2024
Channon Visscher</p>
<p>PYTHON IMPLEMENTATION OF THE SONORA CHEMICAL EQUILIBRIUM ABUNDANCE GRIDS</p>
<p>Based upon easyCHEM Python package of NASA CEA code, written Elise Lei and Paul Mollire
See <a class="reference external" href="https://easychem.readthedocs.io/en/latest/index.html">https://easychem.readthedocs.io/en/latest/index.html</a></p>
<p>This version prints the 2020 grid, which includes all grid points calculated in prior grids
2020 data points:
* 20 pressures, from 1e-06 to to 3e03 bar
* 101 temperatures, from 75 K to 6000 K</p>
<p>reported here are a selected output of abundances requested for opacity calculations
* unless calculated, gas abundances at low temperatures set to 1e-50
* graphite condensation is included in the calculations;
the graphite stability field is also indicated in the contour plots
* consideration of ion chemistry over all temperatures included
* PH3 is adopted as the stable low-T P-bearing gas (i.e., JANAF P4O6 data); this can
be switched by replacing P4O6(JANAF) with P4O6(Gurvich) in the species list
* This version may be considered a minimum working example to test for consistency
with previous NASA CEA calculations used in SONORA equilibrium chemistry grids</p>
<p>The C/O ratio is calculated as follows:
1) all abundances are read-in from abundance database
2) all elements heavier than helium multiplied by metallicity factor (10^feh)
where feh is the metallicity in dex (i.e. feh = 1.0 is 10x solar
3) the C/O factor is defined relative to solar (i.e. co_factor = 1 is bulk solar ratio)
4) the new C/O ratio adjusted by keeping C + O = constant and adjusting the carbon-to-oxygen
ratio by the co_factor</p>
<p>This approach keeps the heavy-element-to-hydrogen ratio (Z/X) constant for a given [Fe/H]</p>
<p>FE/H: -1.0 -0.7 -0.5 -0.3  0.0  0.5  1.0  1.3  1.7  2.0
C/O x:
0.25    X    0    0    0    X    0    X    0    0    0
0.5     X    0    0    0    X    0    X    0    0    0
1.0     X    0    0    0    S    0    X    0    0    0
1.5     X    0    0    0    X    0    X    0    0    0
2.0     X    0    0    0    X    0    X    0    0    0
2.5     X    0    0    0    X    0    X    0    0    0</p>
<p>SOLAR METALLICITY DENOTED BY S ABOVE</p>
<p>METALLICITY AND C/O RATIO INDICATED BY FILENAME</p>
<p>output_fehxxx_coyyy.txt</p>
<p>where
xxx = feh value in dex (e.g., 0.0 for solar)
yyy = if x, co_factor value (e.g., 1.0 for 1x solar C/O)
yyy = bulk c/o ratio (e.g. 0.549 for solar) - python grids</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cto_absolute</strong> (<em>int</em>)  carbon to oxygen ratio absolute units.
Solar = 0.55</p></li>
<li><p><strong>log_mh</strong> (<em>int</em>)  metallicity (relative to solar)
Will find the nearest value to 0.0, 0.5, 1.0, 1.5, 1.7, 2.0
Solar = 0</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="picaso.justdoit.inputs.chemistry_handler">
<span class="sig-name descname"><span class="pre">chemistry_handler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chemistry_table</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.inputs.chemistry_handler" title="Link to this definition"></a></dt>
<dd><p>This function sets the chemistry table that we want to use, whether it is the 1060, 2121 and if we want to
do photohchemistry.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>chemistry_table</strong> (<em>str</em>)  Chemistry table type</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="picaso.justdoit.inputs.climate">
<span class="sig-name descname"><span class="pre">climate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">opacityclass</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_all_profiles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_spec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_all_kzz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diseq_chem</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">self_consistent_kzz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.inputs.climate" title="Link to this definition"></a></dt>
<dd><p>Top Function to run the Climate Model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>opacityclass</strong> (<em>class</em>)  Opacity class from <cite>justdoit.opannection</cite></p></li>
<li><p><strong>save_all_profiles</strong> (<em>bool</em><em> or </em><em>str</em>)  If you want to save and return all iterations in the T(P) profile, True/False.
If str, specifies a path to which all iterations are written as an HDF5 file.</p></li>
<li><p><strong>with_spec</strong> (<em>bool</em>)  Runs picaso spectrum at the end to get the full converged outputs, Default=False</p></li>
<li><p><strong>save_all_kzz</strong> (<em>bool</em>)  If you want to save and return all iterations in the kzz profile,True/False.
Note that if your calculation does not need a kzz profile at all,
this will still compute it and return to you. Those this seems silly it
is designed for folks coupling PICASO runs to other codes that need kzz
as input (e.g., other cloud codes etc.) and this way they can get the kzz profile
without having to run a separate PICASO run.</p></li>
<li><p><strong>diseq_chem</strong> (<em>bool</em>)  If you want to run <a href="#id8"><span class="problematic" id="id9">`</span></a>on-the-fly mixing (takes longer),True/False</p></li>
<li><p><strong>self_consistent_kzz</strong> (<em>bool</em>)  If you want to run MLT in convective zones and Moses in the radiative zones</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>)  If True, triggers prints throughout code</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id10">
<span class="sig-name descname"><span class="pre">clouds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">g0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_holes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fhole</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fthin_cld</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">pd_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#id10" title="Link to this definition"></a></dt>
<dd><p>Cloud specification for the model. Clouds are parameterized by a single scattering albedo (w0),
an assymetry parameter (g0), and a total extinction per layer (opd).
g0,w0, and opd are both wavelength and pressure dependent. Our cloud models come
from eddysed. Their output look something like this where
pressure is in bars and wavenumber is inverse cm. We will sort pressure and wavenumber before we reshape
so the exact order doesnt matter
pressure wavenumber opd w0 g0
1.   1.    . .
1.   2.    . .
1.   3.    . .
.     .  . .
.     .  . .
1.   M.    . .
2.   1.    . .
.     .  . .
N.   .   . .
If you are creating your own file you have to make sure that you have a
<strong>pressure</strong> (bars) and <a href="#id11"><span class="problematic" id="id12">**</span></a>wavenumber**(inverse cm) column. We will use this to make sure that your cloud
and atmospheric profiles are on the same grid. <a href="#id13"><span class="problematic" id="id14">**</span></a>If there is no pressure or wavelength parameter
we will assume that you are on the same grid as your atmospheric input, and on the
eddysed wavelength grid! **
Users can also input their own fixed cloud parameters, by specifying a single value
for g0,w0,opd and defining the thickness and location of the cloud.
:param filename: (Optional) Filename with info on the wavelength and pressure-dependent single scattering</p>
<blockquote>
<div><p>albedo, asymmetry factor, and total extinction per layer. Input associated pd_kwargs
so that the resultant output has columns named : <cite>g0</cite>, <cite>w0</cite> and <cite>opd</cite>. If you are not
using the eddysed output, you will also need a <cite>wavenumber</cite> and <cite>pressure</cite> column in units
of inverse cm, and bars.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>g0</strong> (<em>float</em><em>, </em><em>list</em><em> of </em><em>float</em>)  (Optional) Asymmetry factor. Can be a single float for a single cloud. Or a list of floats
for two different cloud layers</p></li>
<li><p><strong>w0</strong> (<em>list</em><em> of </em><em>float</em>)  (Optional) Single Scattering Albedo. Can be a single float for a single cloud. Or a list of floats
for two different cloud layers</p></li>
<li><p><strong>opd</strong> (<em>list</em><em> of </em><em>float</em>)  (Optional) Total Extinction in <cite>dp</cite>. Can be a single float for a single cloud. Or a list of floats
for two different cloud layers</p></li>
<li><p><strong>p</strong> (<em>list</em><em> of </em><em>float</em>)  (Optional) Bottom location of cloud deck (LOG10 bars). Can be a single float for a single cloud. Or a list of floats
for two different cloud layers</p></li>
<li><p><strong>dp</strong> (<em>list</em><em> of </em><em>float</em>)  (Optional) Total thickness cloud deck above p (LOG10 bars).
Can be a single float for a single cloud or a list of floats
for two different cloud layers
Cloud will span 10**(np.log10(p-dp))</p></li>
<li><p><strong>df</strong> (<em>pd.DataFrame</em><em>, </em><em>dict</em>)  (Optional) Same as what would be included in the file, but in DataFrame or dict form</p></li>
<li><p><strong>do_holes</strong> (<em>bool</em>)  (Optional) The dataframe or cloud that you input becomes patchy with the added two parameters fthin_cld and fhole</p></li>
<li><p><strong>fthin_cld</strong> (<em>float</em>)  (Optional) Used only if do_holes=True; scales the hole (the clear part) such that fthin_cld=0 would simply be a fully clear patch</p></li>
<li><p><strong>fhole</strong> (<em>float</em>)  (Optional) Used only if do_holes=True; the fraction of the clear hole such that
spec = (1-fhole) * cloudy_spec + fhole * clear_spec</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="picaso.justdoit.inputs.clouds_3d">
<span class="sig-name descname"><span class="pre">clouds_3d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regrid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iz_plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iw_plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.inputs.clouds_3d" title="Link to this definition"></a></dt>
<dd><p>Checks your cloud xarray input to make sure the necessary elements are included. If
requested, it will regrid your output according to what you have specified in
phase_angle() routine. If you have not requested a regrid, it will check to make
sure that the latitude/longitude grid that you have specified in your xarray
is the same one that you have set in the phase_angle() routine.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ds</strong> (<em>xarray.DataArray</em>)  xarray input grid (see cloud GCM 3D input tutorials)</p></li>
<li><p><strong>regrid</strong> (<em>bool</em>)  If True, this will auto regrid your data, based on the input to the
phase_angle function you have supllied
If False, it will skip regridding. However, this assumes that you have already
regridded your data to the necessary gangles and tangles. PICASO will double check
for you by comparing latitude/longitudes of what is in your xarray to what was computed
in the phase_angle function.</p></li>
<li><p><strong>plot</strong> (<em>bool</em>)  If True, this will auto output a regridded plot</p></li>
<li><p><strong>iz_plot</strong> (<em>int</em>)  Altitude index to plot if a plot is requested</p></li>
<li><p><strong>iw_plot</strong> (<em>int</em>)  Wavelength index to plot if plot is requested</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>)  If True, this will plot out messages, letting you know if your input data is being transformed</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="picaso.justdoit.inputs.clouds_4d">
<span class="sig-name descname"><span class="pre">clouds_4d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iz_plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iw_plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calculation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'reflected'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.inputs.clouds_4d" title="Link to this definition"></a></dt>
<dd><p>Regrids xarray</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ds</strong> (<em>xarray.DataArray</em>)  xarray input grid (see GCM 3D input tutorials)
Only optional if you have already defined your dataframe to
self.inputs[clouds][profile]</p></li>
<li><p><strong>plot</strong> (<em>bool</em>)  If True, this will auto output a regridded plot</p></li>
<li><p><strong>iz_plot</strong> (<em>bool</em>)  pressure index to plot</p></li>
<li><p><strong>iw_plot</strong> (<em>bool</em>)  wavelength index to plot</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>)  If True, this will plot out messages, letting you know if your input data is being transformed</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="picaso.justdoit.inputs.clouds_reset">
<span class="sig-name descname"><span class="pre">clouds_reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.inputs.clouds_reset" title="Link to this definition"></a></dt>
<dd><p>Reset cloud dict to zeros</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="picaso.justdoit.inputs.cold_trap">
<span class="sig-name descname"><span class="pre">cold_trap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">species_to_consider</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['H2O',</span> <span class="pre">'CH4',</span> <span class="pre">'NH3']</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.inputs.cold_trap" title="Link to this definition"></a></dt>
<dd><p>Enforces cold trapping along the chemeq grid for any species included in the cld_species set. Currently only set
for H2O, CH4 and NH3.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="picaso.justdoit.inputs.effective_temp">
<span class="sig-name descname"><span class="pre">effective_temp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">teff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.inputs.effective_temp" title="Link to this definition"></a></dt>
<dd><p>Same as T_eff with different notation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>teff</strong> (<em>float</em>)  (Optional) Effective temperature of Planet</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="picaso.justdoit.inputs.energy_injection">
<span class="sig-name descname"><span class="pre">energy_injection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inject_energy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">total_energy_injection</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">press_max_energy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">injection_scalehight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inject_beam</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beam_profile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.inputs.energy_injection" title="Link to this definition"></a></dt>
<dd><p>Get Inputs for Energy Injection</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inject_energy</strong> (<em>bool</em>)  If True, will inject energy into the atmosphere</p></li>
<li><p><strong>total_energy_injection</strong> (<em>float</em>)  Total energy injection in ergs/cm^2/s (energy injection for chapman function)</p></li>
<li><p><strong>press_max_energy</strong> (<em>float</em>)  Pressure for maximum energy injection in bars (for chapman function)</p></li>
<li><p><strong>injection_scaleheight</strong> (<em>float</em>)  Scale height ratio for energy injection (for chapman function)</p></li>
<li><p><strong>inject_beam</strong> (<em>bool</em>)  If True, will inject energy beam, this is meant for numerical profile input. Otherwise, will need inputs for chapman function</p></li>
<li><p><strong>beam_profile</strong> (<em>array</em>)  Beam profile (numerical) for energy injection (inject_beam must = True for this to be used)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="picaso.justdoit.inputs.find_kzz">
<span class="sig-name descname"><span class="pre">find_kzz</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.inputs.find_kzz" title="Link to this definition"></a></dt>
<dd><p>Returns in this order:
1) self.inputs[atmosphere][kzz][constant_kzz]
OR
2) self.inputs[atmosphere][kzz][sc_kzz]
OR
3) self.inputs[atmosphere][profile][kz]
OR
None</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id15">
<span class="sig-name descname"><span class="pre">gravity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gravity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gravity_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mass</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mass_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#id15" title="Link to this definition"></a></dt>
<dd><p>Get gravity based on mass and radius, or gravity inputs</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gravity</strong> (<em>float</em>)  (Optional) Gravity of planet</p></li>
<li><p><strong>gravity_unit</strong> (<em>astropy.unit</em>)  (Optional) Unit of Gravity</p></li>
<li><p><strong>radius</strong> (<em>float</em>)  (Optional) radius of planet MUST be specified for thermal emission!</p></li>
<li><p><strong>radius_unit</strong> (<em>astropy.unit</em>)  (Optional) Unit of radius</p></li>
<li><p><strong>mass</strong> (<em>float</em>)  (Optional) mass of planet</p></li>
<li><p><strong>mass_unit</strong> (<em>astropy.unit</em>)  (Optional) Unit of mass</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="picaso.justdoit.inputs.guillot_pt">
<span class="sig-name descname"><span class="pre">guillot_pt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Teq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T_int</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logg1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logKir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nlevel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">61</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_bottom</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_top</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-6</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.inputs.guillot_pt" title="Link to this definition"></a></dt>
<dd><p>Creates temperature pressure profile given parameterization in Guillot 2010 TP profile
called in fx()
:param Teq: equilibrium temperature
:type Teq: float
:param T_int: Internal temperature, if low (100) currently set to 100 for everything
:type T_int: float
:param kv1: see parameterization Guillot 2010 (10.**(logg1+logKir))
:type kv1: float
:param kv2: see parameterization Guillot 2010 (10.**(logg1+logKir))
:type kv2: float
:param kth: see parameterization Guillot 2010 (10.**logKir)
:type kth: float
:param alpha: set to 0.5
:type alpha: float , optional
:param nlevel: Number of atmospheric layers
:type nlevel: int, optional
:param p_bottom: Log pressure (bars) of the lower bound pressure
:type p_bottom: float, optional
:param p_top: Log pressure (bars) of the TOA
:type p_top: float , optional</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>T</strong> (<em>numpy.array</em>)  Temperature grid</p></li>
<li><p><strong>P</strong> (<em>numpy.array</em>)  Pressure grid</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="picaso.justdoit.inputs.inputs_climate">
<span class="sig-name descname"><span class="pre">inputs_climate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">temp_guess</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pressure</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rfaci</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rcb_guess</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rfacv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">moistgrad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.inputs.inputs_climate" title="Link to this definition"></a></dt>
<dd><p>Get Inputs for Climate run</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>temp_guess</strong> (<em>array</em>)  Guess T(P) profile to begin with</p></li>
<li><p><strong>pressure</strong> (<em>array</em>)  Pressure Grid for climate code (this wont change on the fly)</p></li>
<li><p><strong>rfaci</strong> (<em>float</em>)  Default=1, Fractional contribution of thermal light in net flux
Usually this is kept at one and then the redistribution is controlled
via rfacv</p></li>
<li><p><strong>rcb_guess</strong> (<em>int</em>)  Layer index of the initial Radiative-Convective Boundary (RCB) guess (replaces nstr input list)</p></li>
<li><p><strong>rfacv</strong> (<em>float</em>)  Fractional contribution of reflected light in net flux.
=0 for no stellar irradition,
=0.5 for full day-night heat redistribution
=1 for dayside</p></li>
<li><p><strong>moistgrad</strong> (<em>bool</em>)  Moist adiabatic gradient option</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="picaso.justdoit.inputs.interpret_run">
<span class="sig-name descname"><span class="pre">interpret_run</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.inputs.interpret_run" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id16">
<span class="sig-name descname"><span class="pre">phase_angle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phase</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_gangle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_tangle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symmetry</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase_grid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calculation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#id16" title="Link to this definition"></a></dt>
<dd><p>Define phase angle and number of gauss and tchebychev angles to compute.
Controls all geometry of the calculation. Computes latitude and longitudes.
Computes cos theta and incoming and outgoing angles. Adds everything to class.</p>
<p>Please see geometry notebook for a deep dive into how these angles are incorporated
into the calculation.</p>
<p>Typical numbers:
- 1D Thermal: num_gangle = 10, num_tangle=1
- 1D Reflected light with zero phase : num_gangle = 10, num_tangle=1
- 1D Reflected light with non zero phase : num_gangle = 8, num_tangle=8
- 3D Thermal or Reflected : angles will depend on 3D features interested in resolving.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>phase</strong> (<em>float</em><em>,</em><em>int</em>)  Phase angle in radians</p></li>
<li><p><strong>num_gangle</strong> (<em>int</em>)  Number of Gauss angles to integrate over facets (Default is 10). This
is defined as angles over the full sphere. So 10 as the default compute the RT
with 5 points on the west hemisphere and 5 points on the west.
Higher numbers will slow down code.</p></li>
<li><p><strong>num_tangle</strong> (<em>int</em>)  Number of Tchebyshev angles to integrate over facets (Default is 1, which automatically
assumes symmetry).
Must be even if considering symmetry.</p></li>
<li><p><strong>symmetry</strong> (<em>bool</em>)  Default is False. Note, if num_tangle=1 you are automatically considering symmetry.
This will only compute the unique incoming angles so that the calculation
isnt doing repetetive models. E.g. if num_tangles=10, num_gangles=10. Instead of running a 10x10=100
FT calculations, it will only run 5x5 = 25 (or a quarter of the sphere).</p></li>
<li><p><strong>phase_grid</strong> (<em>array</em>)  This is ONLY for computing phase curves and ONLY can be used</p></li>
<li><p><strong>calculation</strong> (<em>str</em>)  Used for phase curve calculation. Needs to be specified in order
to determine integrable angles correctly.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="picaso.justdoit.inputs.phase_curve">
<span class="sig-name descname"><span class="pre">phase_curve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">opacityclass</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">full_output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_opacity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_cpu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.inputs.phase_curve" title="Link to this definition"></a></dt>
<dd><p>Run phase curve
:param opacityclass: Opacity class from <cite>justdoit.opannection</cite>
:type opacityclass: class
:param full_output: (Optional) Default = False. Returns atmosphere class, which enables several</p>
<blockquote>
<div><p>plotting capabilities.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>n_cpu</strong> (<em>int</em>)  (Optional) Default = 1 (no parallelization). Number of cpu to parallelize calculation.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="picaso.justdoit.inputs.phase_curve_geometry">
<span class="sig-name descname"><span class="pre">phase_curve_geometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">calculation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_gangle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_tangle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.inputs.phase_curve_geometry" title="Link to this definition"></a></dt>
<dd><p>Geometry setup for phase curve calculation. This computes all the
necessary</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>calculation</strong> (<em>str</em>)  reflected or thermal</p></li>
<li><p><strong>phase_grid</strong> (<em>float</em>)  phase angle grid to compute phase curve in radians</p></li>
<li><p><strong>num_gangle</strong> (<em>int</em>)  number of gauss angles, equivalent to longitude</p></li>
<li><p><strong>num_tangle</strong> (<em>int</em>)  number of tchebychev angles, equivalent to latitude</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="picaso.justdoit.inputs.photochem_init">
<span class="sig-name descname"><span class="pre">photochem_init</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.inputs.photochem_init" title="Link to this definition"></a></dt>
<dd><p>called in chemistry handler</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="picaso.justdoit.inputs.premix_3d">
<span class="sig-name descname"><span class="pre">premix_3d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">opa</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_cpu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.inputs.premix_3d" title="Link to this definition"></a></dt>
<dd><p>You must have already ran atmosphere_3d or pre-defined an xarray gcm
before running this function.</p>
<p>This function will post-process sonora chemical equillibrium
chemistry onto your 3D grid.</p>
<p>CURRENT options
log m/h: 0.0, 0.5, 1.0, 1.5, 1.7, 2.0
C/O: 0.5X, 1.0X, 1.5X, 2.0X, 2.5X</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>c_o</strong> (<em>float</em><em>,</em><em>optional</em>)  default = 1 (solar), options= 0.5X, 1.0X, 1.5X, 2.0X, 2.5X</p></li>
<li><p><strong>log_mh</strong> (<em>float</em><em>, </em><em>optional</em>)  default = 0 (solar), options = 0.0, 0.5, 1.0, 1.5, 1.7, 2.0</p></li>
<li><p><strong>n_cpu</strong> (<em>int</em>)  Number of cpu to use for parallelization of chemistry</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="picaso.justdoit.inputs.premix_atmosphere">
<span class="sig-name descname"><span class="pre">premix_atmosphere</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">opa</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quench_levels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.inputs.premix_atmosphere" title="Link to this definition"></a></dt>
<dd><p>Builds a dataframe and makes sure that minimum necessary parameters have been suplied.
Sets number of layers in model.
:param opa: Opacity class from opannection : RetrieveCks()
:type opa: class
:param quench_levels: Dictionary with the quench levels for each molecule.
:type quench_levels: dict</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="picaso.justdoit.inputs.premix_atmosphere_diseq_deprecate">
<span class="sig-name descname"><span class="pre">premix_atmosphere_diseq_deprecate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">opa</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quench_levels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">teff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_mix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vol_rainout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quench_ph3</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kinetic_CO2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no_ph3</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cold_trap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cld_species</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">pd_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.inputs.premix_atmosphere_diseq_deprecate" title="Link to this definition"></a></dt>
<dd><p>Builds a dataframe and makes sure that minimum necessary parameters have been suplied.
Sets number of layers in model.
:param opa: Opacity class from opannection : RetrieveCks()
:type opa: class
:param teff: Effective temperature of the object
:type teff: float
:param df: (Optional) Dataframe with volume mixing ratios and pressure, temperature profile.</p>
<blockquote>
<div><p>Must contain pressure (bars) at least one molecule</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>str</em>)  (Optional) Filename with pressure, temperature and volume mixing ratios.
Must contain pressure at least one molecule</p></li>
<li><p><strong>exclude_mol</strong> (<em>list</em><em> of </em><em>str</em>)  (Optional) List of molecules to ignore from file</p></li>
<li><p><strong>vol_rainout</strong> (<em>bool</em>)  (Optional) If True, will rainout volatiles like H2O, CH4 and NH3 as in equilibrium model when applicable</p></li>
<li><p><strong>cold_trap</strong> (<em>bool</em>)  Option to cold trap condensible species, default = False</p></li>
<li><p><strong>cld_species</strong> (<em>list</em><em> of </em><em>str</em>)  (Optional) List of condensing species</p></li>
<li><p><strong>pd_kwargs</strong> (<em>kwargs</em>)  Key word arguments for pd.read_csv to read in supplied atmosphere file</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="picaso.justdoit.inputs.premix_atmosphere_photochem">
<span class="sig-name descname"><span class="pre">premix_atmosphere_photochem</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">quench_levels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.inputs.premix_atmosphere_photochem" title="Link to this definition"></a></dt>
<dd><p>This function runs the photochemistry model, and updates the chemical abundance profiles.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>quench_levels</strong> (<em>dict</em>)  Dictionary with the quench levels for each molecule.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>)  If True, prints out the progress of the photochemistry model.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="picaso.justdoit.inputs.premix_atmosphere_photochem_deprecate">
<span class="sig-name descname"><span class="pre">premix_atmosphere_photochem_deprecate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">opa</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">firsttime</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mh_interp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cto_interp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">pd_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.inputs.premix_atmosphere_photochem_deprecate" title="Link to this definition"></a></dt>
<dd><p>Builds a dataframe and makes sure that minimum necessary parameters have been suplied.
Sets number of layers in model.
:param opa: Opacity class from opannection : RetrieveCks()
:type opa: class
:param df: (Optional) Dataframe with volume mixing ratios and pressure, temperature profile.</p>
<blockquote>
<div><p>Must contain pressure (bars) at least one molecule</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>str</em>)  (Optional) Filename with pressure, temperature and volume mixing ratios.
Must contain pressure at least one molecule</p></li>
<li><p><strong>exclude_mol</strong> (<em>list</em><em> of </em><em>str</em>)  (Optional) List of molecules to ignore from file</p></li>
<li><p><strong>pd_kwargs</strong> (<em>kwargs</em>)  Key word arguments for pd.read_csv to read in supplied atmosphere file</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="picaso.justdoit.inputs.pressure_grid">
<span class="sig-name descname"><span class="pre">pressure_grid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">P_config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.inputs.pressure_grid" title="Link to this definition"></a></dt>
<dd><p>Computes pressure grid based on user input dictionary</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>P_config</strong> (<em>dict</em>)</p></li>
<li><p><strong>dict</strong><strong>(</strong> (<em>P_config =</em>)  reference = {value=1e1,unit=bar}
min = {value=1e-7, unit=bar}
max = {value=1e3,unit=bar}
nlevel = 100
spacing = log )#spacing can be log or linear</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>pressure in bars</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="picaso.justdoit.inputs.setup_climate">
<span class="sig-name descname"><span class="pre">setup_climate</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.inputs.setup_climate" title="Link to this definition"></a></dt>
<dd><p>Turns off planet specific things, so program can run as usual</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="picaso.justdoit.inputs.setup_nostar">
<span class="sig-name descname"><span class="pre">setup_nostar</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.inputs.setup_nostar" title="Link to this definition"></a></dt>
<dd><p>Turns off planet specific things, so program can run as usual</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="picaso.justdoit.inputs.sonora">
<span class="sig-name descname"><span class="pre">sonora</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sonora_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">teff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chem</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'low'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.inputs.sonora" title="Link to this definition"></a></dt>
<dd><p>This queries Sonora temperature profile that can be downloaded from profiles.tar on
Zenodo:</p>
<blockquote>
<div><ul class="simple">
<li><p>Bobcat Models: [profile.tar file](<a class="reference external" href="https://zenodo.org/record/1309035#.Xo5GbZNKjGJ">https://zenodo.org/record/1309035#.Xo5GbZNKjGJ</a>)</p></li>
</ul>
</div></blockquote>
<p>Note gravity is not an input because it grabs gravity from self.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sonora_path</strong> (<em>str</em>)  Path to the untarred profile.tar file from sonora grid</p></li>
<li><p><strong>teff</strong> (<em>float</em>)  teff to query. does not have to be exact (it will query one the nearest neighbor)</p></li>
<li><p><strong>chem</strong> (<em>str</em>)  Default = low. There are two sonora chemistry grids. the default is use low.
There is sublety to this that is going to be explained at length in the sonora grid paper.
Until then, ONLY use chem=low unless you have reached out to one of the developers.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id17">
<span class="sig-name descname"><span class="pre">spectrum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">opacityclass</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calculation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'reflected'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dimension</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'1d'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">full_output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_opacity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">as_dict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#id17" title="Link to this definition"></a></dt>
<dd><p>Run Spectrum
:param opacityclass: Opacity class from <cite>justdoit.opannection</cite>
:type opacityclass: class
:param calculation: Either reflected or thermal for reflected light or thermal emission.</p>
<blockquote>
<div><p>If running a brown dwarf, this will automatically default to thermal</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dimension</strong> (<em>str</em>)  (Optional) Dimensions of the calculation. Default = 1d. But 3d is also accepted.
In order to run 3d calculations, user must build 3d input (see tutorials)</p></li>
<li><p><strong>full_output</strong> (<em>bool</em>)  (Optional) Default = False. Returns atmosphere class, which enables several
plotting capabilities.</p></li>
<li><p><strong>plot_opacity</strong> (<em>bool</em>)  (Optional) Default = False, Creates pop up of the weighted opacity</p></li>
<li><p><strong>as_dict</strong> (<em>bool</em>)  (Optional) Default = True. If true, returns a condensed dictionary to the user.
If false, returns the atmosphere class, which can be used for debugging.
The class is clunky to navigate so if you are consiering navigating through this, ping one of the
developers.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id18">
<span class="sig-name descname"><span class="pre">star</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">opannection</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metal</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">semi_major</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">semi_major_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">database</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ck04models'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#id18" title="Link to this definition"></a></dt>
<dd><p>Get the stellar spectrum using stsynphot and interpolate onto a much finer grid than the
planet grid.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>opannection</strong> (<em>class picaso.RetrieveOpacities</em>)  This is the opacity class and its needed to get the correct wave info and raman scattering cross sections</p></li>
<li><p><strong>temp</strong> (<em>float</em>)  (Optional) Teff of the stellar model if using the stellar database feature.
Not needed for filename option.</p></li>
<li><p><strong>metal</strong> (<em>float</em>)  (Optional) Metallicity of the stellar model if using the stellar database feature.
Not needed for filename option.</p></li>
<li><p><strong>logg</strong> (<em>float</em>)  (Optional) Logg cgs of the stellar model if using the stellar database feature.
Not needed for filename option.</p></li>
<li><p><strong>radius</strong> (<em>float</em>)  (Optional) Radius of the star. Only needed as input if you want relative flux units (Fp/Fs)</p></li>
<li><p><strong>radius_unit</strong> (<em>astropy.unit</em>)  (Optional) Any astropy unit (e.g. <cite>radius_unit=astropy.unit.Unit(R_sun)</cite>)</p></li>
<li><p><strong>semi_major</strong> (<em>float</em>)  (Optional) Semi major axis of the planet. Only needed to compute fp/fs for albedo calculations.</p></li>
<li><p><strong>semi_major_unit</strong> (<em>astropy.unit</em>)  (Optional) Any astropy unit (e.g. <cite>radius_unit=astropy.unit.Unit(au)</cite>)</p></li>
<li><p><strong>database</strong> (<em>str</em>)  (Optional)The database to pull stellar spectrum from. See documentation for pysynphot.
Most popular are ck04models, phoenix and</p></li>
<li><p><strong>filename</strong> (<em>str</em>)  (Optional) Upload your own stellar spectrum. File format = two column white space (wave, flux).
Must specify w_unit and f_unit</p></li>
<li><p><strong>w_unit</strong> (<em>str</em>)  (Optional) Astropy Unit</p></li>
<li><p><strong>f_unit</strong> (<em>str</em>)  (Optional) Astrpy Unit</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="picaso.justdoit.inputs.surface_reflect">
<span class="sig-name descname"><span class="pre">surface_reflect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">albedo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wavenumber</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">old_wavenumber</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.inputs.surface_reflect" title="Link to this definition"></a></dt>
<dd><p>Set atmospheric surface reflectivity. This preps the code to run a terrestrial
planet. This will automatically change the run to hardsurface, which alters
the lower boundary condition of the thermal_1d flux calculation.
:param albedo: Set constant albedo for surface reflectivity
:type albedo: float
:param wavenumber: The desired wavenumber grid (inverse cm) for the albedo
:type wavenumber: list
:param old_wavenumber: Original wavenumber grid (inverse cm) for the albedo which is used to interpolate onto the new wavenumber grid
:type old_wavenumber: list</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="picaso.justdoit.inputs.virga">
<span class="sig-name descname"><span class="pre">virga</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">condensates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">directory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fsed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'const'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mmw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kz_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Teff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_pressure</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">supsat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gas_mmr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_virtual</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_holes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fhole</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fthin_cld</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aggregates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Df</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N_mon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_mon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latent_heat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.inputs.virga" title="Link to this definition"></a></dt>
<dd><p>Runs virga cloud code based on the PT and Kzz profiles
that have been added to inptus class.
:param condensates: Condensates to run in cloud model
:type condensates: str
:param fsed: Sedimentation efficiency coefficient
:type fsed: float
:param b: Denominator of exponential in sedimentation efficiency  (if param is exp)
:type b: float
:param eps: Minimum value of fsed function (if param=exp)
:type eps: float
:param param: fsed parameterisation</p>
<blockquote>
<div><p>const (constant), exp (exponential density derivation), pow (power-law)</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mh</strong> (<em>float</em>)  Metallicity</p></li>
<li><p><strong>mmw</strong> (<em>float</em>)  Atmospheric mean molecular weight</p></li>
<li><p><strong>gas_mmr</strong> (<em>dict</em>)  Gas MMR as a dictionary for individual gases. This allows users to override
virgas chemistry. E.g. {SiO2:1e-6}</p></li>
<li><p><strong>kz_min</strong> (<em>float</em>)  Minimum kzz value</p></li>
<li><p><strong>sig</strong> (<em>float</em>)  Width of the log normal distribution for the particle sizes</p></li>
<li><p><strong>Teff</strong> (<em>float</em><em>, </em><em>optional</em>)  Effective temperature. If None, Teff set to temperature at 1 bar</p></li>
<li><p><strong>alpha_pressure</strong> (<em>float</em><em>, </em><em>optional</em>)  Pressure at which we want fsed=alpha for variable fsed calculation.
If None, pressure set to the top of the atmosphere</p></li>
<li><p><strong>do_virtual</strong> (<em>bool</em>)  Turn on and off the virtual cloud which is a cloud that forms below
the pressure grid defined by the user.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>)  Turn off warnings</p></li>
<li><p><strong>clouds_kwargs</strong> (<em>dict</em>)  Added so that users can add do_hole=True, with fhole and fthin_cld and it will make the virga cloud
patchy</p></li>
<li><p><strong>do_holes</strong> (<em>bool</em>)  If True, the clouds will be patchy. This is done by using the fthin_cld and fhole parameters</p></li>
<li><p><strong>fhole</strong> (<em>float</em>)  Fraction of the clear hole such that spec = (1-fhole) * cloudy_spec + fhole * clear_spec</p></li>
<li><p><strong>fthin_cld</strong> (<em>float</em>)  Scales the hole (the clear part) such that fthin_cld=0 would simply be a fully clear patch</p></li>
<li><p><strong>aggregates</strong> (<em>bool</em>)  Default=False, Turns on virga v2 capability to do aggregates. This requires
the v2 aggregates mieff files. users should read virga documention on aggregates before
turning this on.</p></li>
<li><p><strong>Df</strong> (<em>float</em><em>, </em><em>optional</em>)  only used if aggregate = True.
The fractal dimension of an aggregate particle.
Low Df are highly fractal long, lacy chains; large Df are more compact. Df = 3 is a perfect compact sphere.</p></li>
<li><p><strong>N_mon</strong> (<em>float</em><em>, </em><em>optional</em>)  only used if aggregate = True.
The number of monomers that make up the aggregate. Either this OR r_mon should be provided (but not both).</p></li>
<li><p><strong>r_mon</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>units: cm</em><em>)</em>)  only used if aggregate = True.
The size of the monomer radii (sub-particles) that make up the aggregate. Either this OR N_mon should be
provided (but not both).</p></li>
<li><p><strong>k0</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>units: None</em><em>)</em>)  only used if aggregate = True.
Default = 0, where it will then be calculated in the vfall equation using Tazaki (2021) Eq 2. k0 can also be prescribed by user,
but with a warning that when r_mon is fixed, unless d_f = 1 at r= r_mon, the dynamics may not be consistent between the boundary
when spheres grow large enough to become aggregates (this applies only when r_mon is fixed. If N_mon is fixed instead, any value of k0 is fine).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="picaso.justdoit.inputs.virga_3d">
<span class="sig-name descname"><span class="pre">virga_3d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">condensates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">directory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fsed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mmw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kz_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_cpu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smooth_kz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">full_output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.inputs.virga_3d" title="Link to this definition"></a></dt>
<dd><p>Runs virga cloud code based on the PT and Kzz profiles
that have been added to inptus class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>condensates</strong> (<em>str</em>)  Condensates to run in cloud model</p></li>
<li><p><strong>fsed</strong> (<em>float</em>)  Sedimentation efficiency</p></li>
<li><p><strong>mh</strong> (<em>float</em>)  Metallicity</p></li>
<li><p><strong>mmw</strong> (<em>float</em>)  Atmospheric mean molecular weight</p></li>
<li><p><strong>n_cpu</strong> (<em>int</em>)  number cpu to parallelize</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>)  Print statements to help user</p></li>
<li><p><strong>smooth_kz</strong> (<em>bool</em>)  If true, it uses the min_kz value and does a UnivariateSpline
accross the kz values to smooth out the profile</p></li>
<li><p><strong>full_output</strong> (<em>bool</em>)  Returns full output of virga model run</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="picaso.justdoit.inputs.volatile_rainout">
<span class="sig-name descname"><span class="pre">volatile_rainout</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">quench_levels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">species_to_consider</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['H2O',</span> <span class="pre">'CH4',</span> <span class="pre">'NH3']</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.inputs.volatile_rainout" title="Link to this definition"></a></dt>
<dd><p>Enforces rainout along pvap. So far these are only H2O, CH4 and NH3, since these are the only major species
that are in the abundance tables and would be expected to rainout.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>quench_levels</strong>  Layer in the atmosphere where each of the species is quenched.</p></li>
<li><p><strong>species_to_consider</strong> (<em>list</em><em> of </em><em>str</em>)  Default is [H2O, CH4,NH3]</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.justdoit.jupiter_cld">
<span class="sig-prename descclassname"><span class="pre">picaso.justdoit.</span></span><span class="sig-name descname"><span class="pre">jupiter_cld</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.jupiter_cld" title="Link to this definition"></a></dt>
<dd><p>Function to get rough Jupiter Cloud model with fsed=3</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.justdoit.jupiter_pt">
<span class="sig-prename descclassname"><span class="pre">picaso.justdoit.</span></span><span class="sig-name descname"><span class="pre">jupiter_pt</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.jupiter_pt" title="Link to this definition"></a></dt>
<dd><p>Function to get Jupiters PT profile</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.justdoit.load_planet">
<span class="sig-prename descclassname"><span class="pre">picaso.justdoit.</span></span><span class="sig-name descname"><span class="pre">load_planet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opacity</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase_angle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stellar_db</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ck04models'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">planet_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.load_planet" title="Link to this definition"></a></dt>
<dd><p>Wrapper to simplify PICASO run. This really turns picaso into a black box. This was created
specifically Sagan School tutorial. It grabs planet parameters from the user supplied df, then
adds a parametric PT profile (Guillot et al. 2010). The user still has to add chemistry.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pd.DataFrame</em>)  This is single row from <cite>all_planets()</cite></p></li>
<li><p><strong>opacity</strong> (<em>np.array</em>)  Opacity loaded from opannection</p></li>
<li><p><strong>phase_angle</strong> (<em>float</em>)  Observing phase angle (radians)</p></li>
<li><p><strong>stellar_db</strong> (<em>str</em>)  Stellar database to pull from. Default is ck04models but you can also
use phoenix if you have those downloaded.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em> , </em><em>options</em>)  Print out warnings</p></li>
<li><p><strong>planet_kwargs</strong> (<em>dict</em>)  List of parameters to supply NexSci database is values dont exist</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.justdoit.merge_xarrays">
<span class="sig-prename descclassname"><span class="pre">picaso.justdoit.</span></span><span class="sig-name descname"><span class="pre">merge_xarrays</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ds1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ds2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.merge_xarrays" title="Link to this definition"></a></dt>
<dd><p>This function merges two identical xarrays whose only difference is the wavelength axis. This is supposed to
help merge xarrays whose only difference was that they were computed with two different opacity files.
It will take all the extra variables and attributes from ds1 (input1). So please ensure ds1 and ds2 have identical
inputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ds1</strong> (<em>xarray</em>)  picaso jdi.output_xarray 1</p></li>
<li><p><strong>ds2</strong> (<em>xarray</em>)  picaso jdi.output_xarray 2</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>concatenated along wavelength dimension, sorted by wavelength, merged all ds1 extra variables and attributes</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.justdoit.multi_phase_options">
<span class="sig-prename descclassname"><span class="pre">picaso.justdoit.</span></span><span class="sig-name descname"><span class="pre">multi_phase_options</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">printout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.multi_phase_options" title="Link to this definition"></a></dt>
<dd><p>Retrieve all the options for multiple scattering radiation</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.justdoit.opannection">
<span class="sig-prename descclassname"><span class="pre">picaso.justdoit.</span></span><span class="sig-name descname"><span class="pre">opannection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wave_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename_db</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resample</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'resampled'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ck_db</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">raman_db</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preload_gases</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.opannection" title="Link to this definition"></a></dt>
<dd><p>Sets up database connection to opacities.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wave_range</strong> (<em>list</em><em> of </em><em>float</em>)  Subset of wavelength range for which to run models for
Default : None, which pulls entire grid</p></li>
<li><p><strong>filename_db</strong> (<em>str</em>)  Filename of opacity database to query from
Default is none which pulls opacity file that
comes with distribution</p></li>
<li><p><strong>raman_db</strong> (<em>str</em>)  Filename of raman opacity cross section
Default is none which pulls opacity file that comes with distribution</p></li>
<li><p><strong>resample</strong> (<em>int</em>)  Default=1 (no resampling) PROCEED WITH CAUTION!!!!!This will resample your opacites.
This effectively takes opacity[::BINS] depending on what the
sampling requested is. Consult your local theorist before
using this.</p></li>
<li><p><strong>method</strong> (<em>str</em>)  By default method=resampled
Other options include: [preweighted,resortrebin]</p></li>
<li><p><strong>ck_db</strong> (<em>str</em>)  Can be:
- (required if method is preweighted) ASCII dir of ck file
- (required if method is preweighted) HDF5 filename
- (optional) path to HDF5 directory, if none specified then assumed default in climate_INPUTS/ktable_by_molecule folder</p></li>
<li><p><strong>preload_gases</strong> (<em>str</em>)  Gases that you want to have mixed on the fly, you can specify them here. Default is all</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>)  Error message to warn users about resampling. Can be turned off by supplying
verbose=False</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.justdoit.output_xarray">
<span class="sig-prename descclassname"><span class="pre">picaso.justdoit.</span></span><span class="sig-name descname"><span class="pre">output_xarray</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">picaso_class</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savefile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.output_xarray" title="Link to this definition"></a></dt>
<dd><p>This function converts all picaso output to xarray which is easy to save
It is recommended for reuse and reproducibility of models. the returned
xarray can be used with input_xarray to rerun models. See Preservation notebook.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>dict</em>)  This is the output of your spectrum and must include full_output=True
For example, df = case.spectrum(opa, full_output=True)
It can also be the output of your climate run. For example, out=case.climate(, with_spec=True)
If running climate you must run with_spec=True OR add output of case.spectrum to your output dictionary
by doing (for example):
&gt;&gt; out = case.climate(, withSpec=False)
&gt;&gt; #add any post processing steps you desire (e.g. case.atmosphere or case.clouds)
&gt;&gt; df = case.spectrum(opa, calculation=thermal)
&gt;&gt; out[spectrum_output] = df</p></li>
<li><p><strong>picaso_class</strong> (<em>picaso.inputs</em>)  This is the original class that you made to do your run.
For example, case=jdi.inputs();followed by case.atmosphere(), case.clouds(), etc</p></li>
<li><p><strong>add_output</strong> (<em>dict</em>)  These are any additional outputs you want included in your xarray metadata
This dictionary has a very specific struture if you want it to work correctly.
To see the structure you can run justdoit.standard_metadata() which will
return an empty dictionary that you can fill.</p></li>
<li><p><strong>savefile</strong> (<em>str</em>)  Optional, if string it will save a xarray file for you</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>this xarray dataset can be easily passed to justdoit.input_xarray to run a spectrum</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xarray.Dataset</p>
</dd>
</dl>
<div class="admonition-todo admonition" id="id19">
<p class="admonition-title">Todo</p>
<ul class="simple">
<li><p>figure out why pandas index are being returned for pressure and wavelenth</p></li>
<li><p>fix clouds wavenumber_layer which doesnt seem like it would work</p></li>
<li><p>add clima inputs : teff (or tint), number of convective zones</p></li>
<li><p>cvs_locs array should be more clear</p></li>
</ul>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.justdoit.picaso">
<span class="sig-prename descclassname"><span class="pre">picaso.justdoit.</span></span><span class="sig-name descname"><span class="pre">picaso</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bundle</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opacityclass</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dimension</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'1d'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calculation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'reflected'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">full_output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_opacity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">as_dict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.picaso" title="Link to this definition"></a></dt>
<dd><p>Currently top level program to run albedo code
:param bundle: This input dict is built by loading the input = <cite>justdoit.load_inputs()</cite>
:type bundle: dict
:param opacityclass: Opacity class from <cite>justdoit.opannection</cite>
:type opacityclass: class
:param dimension: (Optional) Dimensions of the calculation. Default = 1d. But 3d is also accepted.</p>
<blockquote>
<div><p>In order to run 3d calculations, user must build 3d input (see tutorials)</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>full_output</strong> (<em>bool</em>)  (Optional) Default = False. Returns atmosphere class, which enables several
plotting capabilities.</p></li>
<li><p><strong>plot_opacity</strong> (<em>bool</em>)  (Optional) Default = False, Creates pop up of the weighted opacity</p></li>
<li><p><strong>as_dict</strong> (<em>bool</em>)  (Optional) Default = True. If true, returns a condensed dictionary to the user.
If false, returns the atmosphere class, which can be used for debugging.
The class is clunky to navigate so if you are consiering navigating through this, ping one of the
developers.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>dictionary with albedos or fluxes or both (depending on what calculation type)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.justdoit.raman_options">
<span class="sig-prename descclassname"><span class="pre">picaso.justdoit.</span></span><span class="sig-name descname"><span class="pre">raman_options</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.raman_options" title="Link to this definition"></a></dt>
<dd><p>Retrieve options for raman scattering approximtions</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.justdoit.rt_methodology_options">
<span class="sig-prename descclassname"><span class="pre">picaso.justdoit.</span></span><span class="sig-name descname"><span class="pre">rt_methodology_options</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">printout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.rt_methodology_options" title="Link to this definition"></a></dt>
<dd><p>Retrieve all the options for methodology</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.justdoit.single_phase_options">
<span class="sig-prename descclassname"><span class="pre">picaso.justdoit.</span></span><span class="sig-name descname"><span class="pre">single_phase_options</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">printout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.single_phase_options" title="Link to this definition"></a></dt>
<dd><p>Retrieve all the options for direct radation</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.justdoit.standard_metadata">
<span class="sig-prename descclassname"><span class="pre">picaso.justdoit.</span></span><span class="sig-name descname"><span class="pre">standard_metadata</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.standard_metadata" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.justdoit.stream_options">
<span class="sig-prename descclassname"><span class="pre">picaso.justdoit.</span></span><span class="sig-name descname"><span class="pre">stream_options</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">printout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.stream_options" title="Link to this definition"></a></dt>
<dd><p>Retrieve all the options for stream</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.justdoit.toon_phase_coefficients">
<span class="sig-prename descclassname"><span class="pre">picaso.justdoit.</span></span><span class="sig-name descname"><span class="pre">toon_phase_coefficients</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">printout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.toon_phase_coefficients" title="Link to this definition"></a></dt>
<dd><p>Retrieve options for coefficients used in Toon calculation</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.justdoit.w17_data">
<span class="sig-prename descclassname"><span class="pre">picaso.justdoit.</span></span><span class="sig-name descname"><span class="pre">w17_data</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.w17_data" title="Link to this definition"></a></dt>
<dd><p>Function to get WASP-17 Grant et al data from here
<a class="reference external" href="https://zenodo.org/records/8360121/files/ExoTiC-MIRI.zip?download=1">https://zenodo.org/records/8360121/files/ExoTiC-MIRI.zip?download=1</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.justdoit.young_planets">
<span class="sig-prename descclassname"><span class="pre">picaso.justdoit.</span></span><span class="sig-name descname"><span class="pre">young_planets</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.young_planets" title="Link to this definition"></a></dt>
<dd><p>Load planets from ZJs paper</p>
</dd></dl>

</section>
<section id="module-picaso.justplotit">
<span id="picaso-justplotit-module"></span><h2>picaso.justplotit module<a class="headerlink" href="#module-picaso.justplotit" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="picaso.justplotit.all_optics_1d">
<span class="sig-prename descclassname"><span class="pre">picaso.justplotit.</span></span><span class="sig-name descname"><span class="pre">all_optics_1d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">full_output</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wave_range</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">legend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ng</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('#0072B2',</span> <span class="pre">'#E69F00',</span> <span class="pre">'#F0E442',</span> <span class="pre">'#009E73',</span> <span class="pre">'#56B4E9',</span> <span class="pre">'#D55E00',</span> <span class="pre">'#CC79A7',</span> <span class="pre">'#000000')</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.all_optics_1d" title="Link to this definition"></a></dt>
<dd><p>Plots 1d profiles of optical depth per layer, single scattering, and
asymmetry averaged over the user input wave_range.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>full_output</strong> (<em>list</em><em>,</em><em>dict</em>)  Dictonary of outputs or list of dicts</p></li>
<li><p><strong>wave_range</strong> (<em>list</em>)  min and max wavelength in microns</p></li>
<li><p><strong>return_output</strong> (<em>bool</em>)  Default is just to return a figure but you can also
return all the 1d profiles</p></li>
<li><p><strong>legend</strong> (<em>bool</em>)  Default is none. Legend for each component of out</p></li>
<li><p><strong>ng</strong> (<em>int</em>)  gauss index</p></li>
<li><p><strong>nt</strong> (<em>int</em>)  chebychev intex</p></li>
<li><p><strong>**kwargs</strong> (<em>keyword arguments</em>)  Key word arguments will be supplied to each bokeh figure function</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.justplotit.animate_convergence">
<span class="sig-prename descclassname"><span class="pre">picaso.justplotit.</span></span><span class="sig-name descname"><span class="pre">animate_convergence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">clima_out</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">picaso_bundle</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opacity</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calculation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'thermal'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wave_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0.3,</span> <span class="pre">6]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">molecules</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['H2O',</span> <span class="pre">'CH4',</span> <span class="pre">'CO',</span> <span class="pre">'NH3']</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.animate_convergence" title="Link to this definition"></a></dt>
<dd><p>Function to animate climate convergence given all profiles that were
computed throughout the climate run
Animates from the first guess through to the final converged state.
Runs spectra for each of those cases.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>clima_out</strong> (<em>dict</em>)  Output from, for example: clima_out = cl_run.climate(opacity_ck, save_all_profiles=True)</p></li>
<li><p><strong>picaso_bundle</strong> (<em>&lt;picaso.justdoit.inputs&gt;</em>)  This would be the equivalent of cl_run that you used to run climate_model(). This ensures that
your spectra can be rerun</p></li>
<li><p><strong>opacity</strong> (<em>&lt;picaso.optics.RetrieveCKs&gt;</em>)  This is the jdi.opannection that you used as input in the run_climate_model</p></li>
<li><p><strong>wave_range</strong> (<em>list</em>)  sets the wavelngth range of the spectra</p></li>
<li><p><strong>molecules</strong> (<em>list</em>)  list of strings for what molecules to animate</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>matplotlib.animation</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.justplotit.bin_errors">
<span class="sig-prename descclassname"><span class="pre">picaso.justplotit.</span></span><span class="sig-name descname"><span class="pre">bin_errors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">newx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">oldx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dy</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.bin_errors" title="Link to this definition"></a></dt>
<dd><p>Bin errors properly to account for reduction in noise</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>newx</strong> (<em>array</em>)  New x axis (either micron or wavenumber)</p></li>
<li><p><strong>oldx</strong> (<em>array</em>)  Old x axis (either micron or wavenumber)</p></li>
<li><p><strong>dy</strong> (<em>array</em>)  Error bars</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>new dy</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.justplotit.brightness_temperature">
<span class="sig-prename descclassname"><span class="pre">picaso.justplotit.</span></span><span class="sig-name descname"><span class="pre">brightness_temperature</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">out_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">R</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_guide</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.brightness_temperature" title="Link to this definition"></a></dt>
<dd><p>Plots and returns brightness temperature</p>
<p>$T_{rm bright}=dfrac{a}{{lambda}logleft(dfrac{{b}}{F(lambda){lambda}^5}+1right)}$</p>
<p>where a = 1.43877735$times$10$^{-2}$ m.K and b = 11.91042952$times$10$^{-17}$ m$^4$kg/s$^3$</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>out_dict</strong> (<em>dict</em>)  output of bundle.spectrum(opa,full_output=True) or a dictionary with
{wavenumber: np.array, thermal: np.array of standard output in erg/cm2/s/cm}</p></li>
<li><p><strong>plot</strong> (<em>bool</em>)  If true creates and returns a plot</p></li>
<li><p><strong>R</strong> (<em>float</em>)  If not None, rebins the brightness temperature</p></li>
<li><p><strong>with_guide</strong> (<em>bool</em>)  Plots points from the minimum and maximum pt values</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.justplotit.cloud">
<span class="sig-prename descclassname"><span class="pre">picaso.justplotit.</span></span><span class="sig-name descname"><span class="pre">cloud</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">full_output</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.cloud" title="Link to this definition"></a></dt>
<dd><p>Plotting the cloud input from <code class="docutils literal notranslate"><span class="pre">picaso</span></code>.</p>
<p>The plot itselfs creates maps of the wavelength dependent single scattering albedo
and cloud opacity as a function of altitude.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>full_output</strong></p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>A matplotlib figure with three subplots showing heatmaps of single scattering, optical depth, and asymmetry.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.justplotit.create_heat_map">
<span class="sig-prename descclassname"><span class="pre">picaso.justplotit.</span></span><span class="sig-name descname"><span class="pre">create_heat_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rayleigh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_height</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">300</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">300</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">font_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'12px'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.create_heat_map" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.justplotit.disco">
<span class="sig-prename descclassname"><span class="pre">picaso.justplotit.</span></span><span class="sig-name descname"><span class="pre">disco</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">full_output</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wavelength</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calculation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'reflected'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.disco" title="Link to this definition"></a></dt>
<dd><p>Plot disco ball with facets. Bokeh is not good with 3D things. So this is in matplotlib</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>full_output</strong> (<em>class</em>)  Full output from picaso</p></li>
<li><p><strong>wavelength</strong> (<em>list</em>)  Where to plot 3d facets. Can input as many wavelengths as wanted.
Must be a list, must be in microns.</p></li>
<li><p><strong>calculation</strong> (<em>str</em><em>, </em><em>optional</em>)  Default is to plot reflected light but can also switch to thermal if it has been computed</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.justplotit.explore">
<span class="sig-prename descclassname"><span class="pre">picaso.justplotit.</span></span><span class="sig-name descname"><span class="pre">explore</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.explore" title="Link to this definition"></a></dt>
<dd><p>Function to explore a dictionary that is THREE levels deep and return the data sitting at
the end of key.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>df</strong> (<em>dict</em>)  Dictionary that you want to search through.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Consider a dictionary that has <cite>df[layer][cloud][w0] = [0,0,0]</cite></p>
<p>&gt;&gt;&gt;explore(df, w0)
[0,0,0]</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.justplotit.find_nearest_1d">
<span class="sig-prename descclassname"><span class="pre">picaso.justplotit.</span></span><span class="sig-name descname"><span class="pre">find_nearest_1d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.find_nearest_1d" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.justplotit.find_nearest_2d">
<span class="sig-prename descclassname"><span class="pre">picaso.justplotit.</span></span><span class="sig-name descname"><span class="pre">find_nearest_2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.find_nearest_2d" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.justplotit.find_nearest_old">
<span class="sig-prename descclassname"><span class="pre">picaso.justplotit.</span></span><span class="sig-name descname"><span class="pre">find_nearest_old</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.find_nearest_old" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.justplotit.flux_at_top">
<span class="sig-prename descclassname"><span class="pre">picaso.justplotit.</span></span><span class="sig-name descname"><span class="pre">flux_at_top</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">full_output</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_bb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">R</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pressures</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0.1,</span> <span class="pre">0.01,</span> <span class="pre">0.001]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ng</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.flux_at_top" title="Link to this definition"></a></dt>
<dd><p>Routine to plot the OLR with overlaying black bodies.</p>
<p>Flux units are CGS = erg/s/cm^3</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>full_output</strong> (<em>dict</em>)  full dictionary output with {wavenumber,thermal,full_output}</p></li>
<li><p><strong>plot_bb</strong> (<em>bool</em><em> , </em><em>optional</em>)  Default is to plot black bodies for three pressures specified by <cite>pressures</cite></p></li>
<li><p><strong>R</strong> (<em>float</em>)  New constant R to bin to</p></li>
<li><p><strong>pressures</strong> (<em>list</em><em>, </em><em>optional</em>)  Default is a list of three pressures (in bars) =  [1e-1,1e-2,1e-3]</p></li>
<li><p><strong>ng</strong> (<em>int</em>)  Used for 3D calculations to select point on the sphere (equivalent to longitude point)</p></li>
<li><p><strong>nt</strong> (<em>int</em>)  Used for 3D calculations to select point on the sphere (equivalent to latitude point)</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em>)  Any key word argument for bokeh.figure()</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.justplotit.heatmap_taus">
<span class="sig-prename descclassname"><span class="pre">picaso.justplotit.</span></span><span class="sig-name descname"><span class="pre">heatmap_taus</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">out</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">R</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.heatmap_taus" title="Link to this definition"></a></dt>
<dd><p>Plots a heatmap of the tau fields (taugas, taucld, tauray)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>out</strong> (<em>dict</em>)  full_ouput dictionary</p></li>
<li><p><strong>R</strong> (<em>int</em>)  Resolution to bin to (if zero, no binning)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.justplotit.lon_lat_to_cartesian">
<span class="sig-prename descclassname"><span class="pre">picaso.justplotit.</span></span><span class="sig-name descname"><span class="pre">lon_lat_to_cartesian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lon_r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat_r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">R</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.lon_lat_to_cartesian" title="Link to this definition"></a></dt>
<dd><p>calculates lon, lat coordinates of a point on a sphere with
radius R</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.justplotit.map">
<span class="sig-prename descclassname"><span class="pre">picaso.justplotit.</span></span><span class="sig-name descname"><span class="pre">map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">full_output</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pressure</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0.1]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'temperature'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wavelength</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">igauss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.map" title="Link to this definition"></a></dt>
<dd><p>Plot disco ball with facets. Bokeh is not good with 3D things. So this is in matplotlib</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>full_output</strong> (<em>class</em>)  Full output from picaso</p></li>
<li><p><strong>pressure</strong> (<em>list</em>)  What pressure (in bars) to make the map on. Note: this assumes that the
pressure grid is the same for each ng,nt point accross the grid.</p></li>
<li><p><strong>plot</strong> (<em>str</em><em>, </em><em>optional</em>)  Default is to plot temperature map but can also switch to any
3d [nlayer, nlong, nlat] or 4d [nlayer, nwave, nlong, nlat] output in full_output. You can check what is available to plot by printing:
<cite>print(full_output[layer].keys()</cite>.
If you are plotting something that is ALSO wavelength dependent you have to
also supply a single wavelength.</p></li>
<li><p><strong>wavelength</strong>  This allows users to plot maps of things that are wavelength dependent, like
<cite>taugas</cite> and <cite>taucld</cite>.</p></li>
<li><p><strong>float</strong>  This allows users to plot maps of things that are wavelength dependent, like
<cite>taugas</cite> and <cite>taucld</cite>.</p></li>
<li><p><strong>optional</strong>  This allows users to plot maps of things that are wavelength dependent, like
<cite>taugas</cite> and <cite>taucld</cite>.</p></li>
<li><p><strong>igauss</strong> (<em>int</em>)  Gauss point to plot if using ktables this can be greater than 0 up to ngauss-1. Otherwise,
This must be zero for monochromatic opacities.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.justplotit.mean_regrid">
<span class="sig-prename descclassname"><span class="pre">picaso.justplotit.</span></span><span class="sig-name descname"><span class="pre">mean_regrid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">newx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">R</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.mean_regrid" title="Link to this definition"></a></dt>
<dd><p>Rebin the spectrum at a minimum R or on a fixed grid!</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>array</em>)  Wavenumbers</p></li>
<li><p><strong>y</strong> (<em>array</em>)  Anything (e.g. albedo, flux)</p></li>
<li><p><strong>newx</strong> (<em>array</em>)  new array to regrid on.</p></li>
<li><p><strong>R</strong> (<em>float</em>)  create grid with constant R</p></li>
<li><p><strong>binwidths</strong> (<em>array</em>)  bin widths centered at x</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>final x, and final y</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.justplotit.mixing_ratio">
<span class="sig-prename descclassname"><span class="pre">picaso.justplotit.</span></span><span class="sig-name descname"><span class="pre">mixing_ratio</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">full_output</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ng</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bokeh'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">molecules</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.mixing_ratio" title="Link to this definition"></a></dt>
<dd><p>Returns plot of mixing ratios</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>full_output</strong> (<em>class</em>)  picaso.atmsetup.ATMSETUP</p></li>
<li><p><strong>limit</strong> (<em>int</em>)  Limits the number of curves to 20. Will plot the top 20 molecules
with highest max(abundance). Limit must be &gt;=3.</p></li>
<li><p><strong>molecules</strong> (<em>list</em>)  Directly specify which molecule to plot</p></li>
<li><p><strong>plot_type</strong> (<em>str</em>)  Options are bokeh or matplotlib. Default is bokeh</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em>)  Any key word argument for bokeh.figure()</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.justplotit.molecule_contribution">
<span class="sig-prename descclassname"><span class="pre">picaso.justplotit.</span></span><span class="sig-name descname"><span class="pre">molecule_contribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">contribution_out</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opa</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_pressure</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">R</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.molecule_contribution" title="Link to this definition"></a></dt>
<dd><p>Function to plot &amp; graph the Tau~1 Pressure (bars) of various elements</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>contribution_out</strong> (<em>dict</em>)  contribution_out from jdi.get_contribution.
This function will grab contribution_out[tau_p_surface]
Pressure vs. wavelength optical depth surface at tau specified by user in
get_contribution function (user input for at_tau)</p></li>
<li><p><strong>opa</strong> (<em>picaso.opannection</em>)  Picaso opacity connection to get wavelength</p></li>
<li><p><strong>min_pressure</strong> (<em>float</em><em>, </em><em>int</em>)  Minimum pressure contribution in bars for molecules you want to plot. Ignores all molecules that
are optically thick higher than min_pressure (bars)</p></li>
<li><p><strong>R</strong> (<em>int</em>)  Resolution defined as lambda/dlambda</p></li>
<li><p><strong>Outputs</strong></p></li>
<li><p><strong>-------</strong></p></li>
<li><p><strong>figure</strong> (<em>bokeh.plotting.figure.Figure</em>)  Shows a default graph of Tau 1 Surface of various molecules and a graph based on user input based on their parameters</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.justplotit.numba_cumsum">
<span class="sig-prename descclassname"><span class="pre">picaso.justplotit.</span></span><span class="sig-name descname"><span class="pre">numba_cumsum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mat</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.numba_cumsum" title="Link to this definition"></a></dt>
<dd><p>Function to compute cumsum along axis=0 to bypass numba not allowing kwargs in
cumsum</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.justplotit.phase_curve">
<span class="sig-prename descclassname"><span class="pre">picaso.justplotit.</span></span><span class="sig-name descname"><span class="pre">phase_curve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">allout</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_plot</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">collapse</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">R</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">palette</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('#5e4fa2',</span> <span class="pre">'#3288bd',</span> <span class="pre">'#66c2a5',</span> <span class="pre">'#abdda4',</span> <span class="pre">'#e6f598',</span> <span class="pre">'#ffffbf',</span> <span class="pre">'#fee08b',</span> <span class="pre">'#fdae61',</span> <span class="pre">'#f46d43',</span> <span class="pre">'#d53e4f',</span> <span class="pre">'#9e0142')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reorder_output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.phase_curve" title="Link to this definition"></a></dt>
<dd><p>Plots phase curves</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>allouts</strong> (<em>dict</em>)  picaso allouts element that comes from jdi.phase_curve</p></li>
<li><p><strong>to_plot</strong> (<em>str</em>)  either fpfs_reflected, fpfs_thermal, or thermal, or albedo</p></li>
<li><p><strong>collapse</strong> (<em>str</em><em> or </em><em>float</em><em> or </em><em>list</em><em> of </em><em>float</em>)  Allowable options to collapse wavelength axis:
- <cite>np.mean</cite> or <cite>np.sum</cite>
- float or list of float: wavelength(s) in microns (will find the nearest value to this wavelength). Must be in wavenumber range.</p></li>
<li><p><strong>R</strong> (<em>float</em>)  Resolution to regrid before finding nearest wavelength element</p></li>
<li><p><strong>palette</strong> (<em>list</em>)  list of hex from bokeh or other palette</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>)  Print out low level warnings</p></li>
<li><p><strong>kwargs</strong> (<em>dict</em>)  Bokeh plotting kwargs for bokeh.Figure</p></li>
<li><p><strong>reorder_output</strong> (<em>bool</em>)  Returns sorted outputs, for better phase curve plotting.
re-orders phases such that brightest value is at phase=0</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.justplotit.phase_snaps">
<span class="sig-prename descclassname"><span class="pre">picaso.justplotit.</span></span><span class="sig-name descname"><span class="pre">phase_snaps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">allout</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'longitude'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pressure'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'temperature'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">palette</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'RdBu_r'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_wrap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">collapse</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'np.mean'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">igauss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.phase_snaps" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>str</em>)  What to plot on the x axis options = (longitude or latitude or pressure)</p></li>
<li><p><strong>y</strong> (<em>str</em>)  What to plot on the y axis (longitude or latitude or pressure)</p></li>
<li><p><strong>z</strong> (<em>str</em>)  What to plot in the heatmap (temperature,taugas,taucld,tauray,w0,g0,opd)</p></li>
<li><p><strong>y_log</strong> (<em>bool</em>)  Makes y axis log</p></li>
<li><p><strong>x_log</strong> (<em>bool</em>)  Makes x axis log</p></li>
<li><p><strong>z_log</strong> (<em>bool</em>)  Makes z axis log (colorbar)</p></li>
<li><p><strong>palette</strong> (<em>str</em>)  Color pallete</p></li>
<li><p><strong>col_wrap</strong> (<em>int</em>)  Column wrap, determines number of columns to split runs into</p></li>
<li><p><strong>collapse</strong> (<em>str</em><em> or </em><em>int</em>)  Collapse lets us know how to collapse the axis, not used. For instance, if plotting
x=longitude, and y=pressure, with collapse=mean, it will take an average along the latitude
axis. If collapse=0, it will take the 0th latitude point.
Allowed collapse functions = np.mean, np.median, np.min, np.max</p></li>
<li><p><strong>igauss</strong> (<em>int</em>)  If using k-coeff gauss points, this can be changed to get different
gauss quadrature points.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.justplotit.photon_attenuation">
<span class="sig-prename descclassname"><span class="pre">picaso.justplotit.</span></span><span class="sig-name descname"><span class="pre">photon_attenuation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">full_output</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">at_tau</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">igauss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.photon_attenuation" title="Link to this definition"></a></dt>
<dd><p>Plot breakdown of gas opacity, cloud opacity,
Rayleigh scattering opacity at a specified pressure level.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>full_output</strong> (<em>class</em>)  picaso.atmsetup.ATMSETUP</p></li>
<li><p><strong>at_tau</strong> (<em>float</em>)  Opacity at which to plot the cumulative opacity.
Default = 0.5.</p></li>
<li><p><strong>return_output</strong> (<em>bool</em>)  Return photon attenuation plot values</p></li>
<li><p><strong>igauss</strong> (<em>int</em>)  Gauss angle to plot if using correlated-k method. If not, should always be 0.</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em>)  Any key word argument for bokeh.plotting.figure()</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>if return_output=False</strong> (<em>bokeh plot</em>)</p></li>
<li><p><strong>else</strong> (<em>bokeh plot,wave,at_pressures_gas,at_pressures_cld,at_pressures_ray</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.justplotit.plot_cld_input">
<span class="sig-prename descclassname"><span class="pre">picaso.justplotit.</span></span><span class="sig-name descname"><span class="pre">plot_cld_input</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nwno</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nlayer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pressure</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wavelength</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">pd_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.plot_cld_input" title="Link to this definition"></a></dt>
<dd><p>This function was created to investigate CLD input file for PICASO.</p>
<p>The plot itselfs creates maps of the wavelength dependent single scattering albedo
and cloud opacity and assymetry parameter as a function of altitude.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nwno</strong> (<em>int</em>)  Number of wavenumber points. For runs from Ackerman &amp; Marley, this will always be 196.</p></li>
<li><p><strong>nlayer</strong> (<em>int</em>)  Should be one less than the number of levels in your pressure temperature grid. Cloud
opacity is assigned for slabs.</p></li>
<li><p><strong>file</strong> (<em>str</em><em> , </em><em>optional</em>)  (Optional)Path to cloud input file</p></li>
<li><p><strong>df</strong> (<em>str</em>)  (Optional)Dataframe of cloud input file</p></li>
<li><p><strong>wavelength</strong> (<em>array</em><em> , </em><em>optional</em>)  (Optional) this allows you to reset the tick marks to wavelengths instead of indicies</p></li>
<li><p><strong>pressure</strong> (<em>array</em><em>, </em><em>optional</em>)  (Optional) this allows you to reset the tick marks to pressure instead of indicies</p></li>
<li><p><strong>pd_kwargs</strong> (<em>kwargs</em>)  Pandas key word arguments for <cite>pandas.read_csv</cite></p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Three bokeh plots with the single scattering, optical depth, and assymetry maps</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.justplotit.plot_errorbar">
<span class="sig-prename descclassname"><span class="pre">picaso.justplotit.</span></span><span class="sig-name descname"><span class="pre">plot_errorbar</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">point_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bokeh'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.plot_errorbar" title="Link to this definition"></a></dt>
<dd><p>Plot only symmetric y error bars in bokeh plot</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>array</em>)  x data</p></li>
<li><p><strong>y</strong> (<em>array</em>)  y data</p></li>
<li><p><strong>e</strong> (<em>array</em>)  +- error for y which will be distributed as y+e, y-e on data point</p></li>
<li><p><strong>plot</strong> (<em>bokeh.figure</em><em>, </em><em>optional</em>)  Bokeh figure to add error bars to</p></li>
<li><p><strong>plot_type</strong> (<em>str</em><em>, </em><em>optional</em>)  type of plot (either bokeh or matplotlib)</p></li>
<li><p><strong>point_kwargs</strong> (<em>dict</em>)  formatting for circles</p></li>
<li><p><strong>error_kwargs</strong> (<em>dict</em>)  formatting for error bar lines</p></li>
<li><p><strong>plot_kwargs</strong> (<em>dict</em>)  plot attriutes for bokeh figure</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.justplotit.plot_evolution">
<span class="sig-prename descclassname"><span class="pre">picaso.justplotit.</span></span><span class="sig-name descname"><span class="pre">plot_evolution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">evo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Teff'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.plot_evolution" title="Link to this definition"></a></dt>
<dd><p>Plot evolution of tracks. Requires input from justdoit:</p>
<p>evo = justdoit.evolution_track(mass=all,age=all)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>evo</strong> (<em>dict</em>)  Output from the function justdoit.evolution_track(mass=all,age=all)</p></li>
<li><p><strong>y</strong> (<em>str</em>)  What to plot on the y axis. Can be anything in the pandas that as the mass
attached to the end. E.g. Teff is an option because there exists Teff1Mj.
But, age_years is not an option as it is not a function of mass.
Current options : [logL, Teff, grav_cgs]</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.justplotit.plot_format">
<span class="sig-prename descclassname"><span class="pre">picaso.justplotit.</span></span><span class="sig-name descname"><span class="pre">plot_format</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.plot_format" title="Link to this definition"></a></dt>
<dd><p>Function to reformat plots</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.justplotit.plot_multierror">
<span class="sig-prename descclassname"><span class="pre">picaso.justplotit.</span></span><span class="sig-name descname"><span class="pre">plot_multierror</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx_up</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx_low</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dy_up</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dy_low</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">point_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.plot_multierror" title="Link to this definition"></a></dt>
<dd><p>Plot non-symmetric x and y error bars in bokeh plot</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>array</em>)  x data</p></li>
<li><p><strong>y</strong> (<em>array</em>)  y data</p></li>
<li><p><strong>dx_up</strong> (<em>array</em><em> or </em><em>int</em><em> or </em><em>float</em>)  upper error bar to be distributed as x + dx_up</p></li>
<li><p><strong>dx_low</strong> (<em>array</em><em> or </em><em>int</em><em> or </em><em>float</em>)  lower error bar to be distributed as x + dx_low</p></li>
<li><p><strong>dy_up</strong> (<em>array</em><em> or </em><em>int</em><em> or </em><em>float</em>)  upper error bar to be distributed as y + dy_up</p></li>
<li><p><strong>dy_low</strong> (<em>array</em><em> or </em><em>int</em><em> or </em><em>float</em>)  lower error bar to be distributed as y + dy_low</p></li>
<li><p><strong>plot</strong> (<em>bokeh.figure</em>)  Bokeh figure to add error bars to</p></li>
<li><p><strong>point_kwargs</strong> (<em>dict</em>)  formatting for circles</p></li>
<li><p><strong>error_kwargs</strong> (<em>dict</em>)  formatting for error bar lines</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.justplotit.pt">
<span class="sig-prename descclassname"><span class="pre">picaso.justplotit.</span></span><span class="sig-name descname"><span class="pre">pt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">full_output</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ng</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.pt" title="Link to this definition"></a></dt>
<dd><p>Returns plot of pressure temperature profile</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>full_output</strong> (<em>class</em>)  picaso.atmsetup.ATMSETUP</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em>)  Any key word argument for bokeh.figure()</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.justplotit.pt_adiabat">
<span class="sig-prename descclassname"><span class="pre">picaso.justplotit.</span></span><span class="sig-name descname"><span class="pre">pt_adiabat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">clima_out</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_class</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opacityclass</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.pt_adiabat" title="Link to this definition"></a></dt>
<dd><p>Plot the PT profile with the adiabat</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>clima_out</strong> (<em>dict</em>)  Full output from picaso</p></li>
<li><p><strong>input_class</strong> (<em>justdoit.input</em>)  PICASO input class (e.g. the result of jdi.inputs())</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>adiabat, dTdP, pressure</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.justplotit.rt_heatmap">
<span class="sig-prename descclassname"><span class="pre">picaso.justplotit.</span></span><span class="sig-name descname"><span class="pre">rt_heatmap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figure_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.rt_heatmap" title="Link to this definition"></a></dt>
<dd><p>This creates a heat map of the dataframe created from
picaso.test.thermal_sh_test() or picaso.test.dlugach_test()
The tutorial 10c_AnalyzingApproximationsThermal.ipynb
and 10b_AnalyzingApproximationsReflectedLightSH.ipynb
shows it in use.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>pandas.DataFrame</em>)  Technically, this can be any dataframe, but this function was specifically built to
replicate Figure 9 in Batalha et al.  2019 and Figure 6 from Rooney et al. 2023. Part II Thermal. It is assumed that the
index of the dataframe is asymmetry and the columns are single scattering albedo.</p></li>
<li><p><strong>figure_kwargs</strong> (<em>dict</em>)  keywords for bokeh.plotting.figure function</p></li>
<li><p><strong>cmap_kwargs</strong> (<em>dict</em>)  keywords for bokeh.models.LinearColorMapper funtion. Most common parameters to input are
palette (list or tuple of colors), high (upper lim of color map), and low (lower lim of color map)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.justplotit.spectrum">
<span class="sig-prename descclassname"><span class="pre">picaso.justplotit.</span></span><span class="sig-name descname"><span class="pre">spectrum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">legend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wno_to_micron</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">palette</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('#0072B2',</span> <span class="pre">'#E69F00',</span> <span class="pre">'#F0E442',</span> <span class="pre">'#009E73',</span> <span class="pre">'#56B4E9',</span> <span class="pre">'#D55E00',</span> <span class="pre">'#CC79A7',</span> <span class="pre">'#000000')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">muted_alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.spectrum" title="Link to this definition"></a></dt>
<dd><p>Plot formated albedo spectrum</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xarray</strong> (<em>float array</em><em>, </em><em>list</em><em> of </em><em>arrays</em>)  wavenumber or micron</p></li>
<li><p><strong>yarray</strong> (<em>float array</em><em>, </em><em>list</em><em> of </em><em>arrays</em>)  albedo or fluxes</p></li>
<li><p><strong>legend</strong> (<em>list</em><em> of </em><em>str</em><em> , </em><em>optional</em>)  legends for plotting</p></li>
<li><p><strong>wno_to_micron</strong> (<em>bool</em><em> , </em><em>optional</em>)  Converts wavenumber to micron</p></li>
<li><p><strong>palette</strong> (<em>list</em><em>,</em><em>optional</em>)  List of colors for lines. Default only has 8 colors so if you input more lines, you must
give a different pallete</p></li>
<li><p><strong>muted_alpha</strong> (<em>float</em>)  number 0-1 to indicate how muted you want the click functionaity</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em>)  Any key word argument for bokeh.plotting.figure()</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>bokeh plot</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.justplotit.spectrum_hires">
<span class="sig-prename descclassname"><span class="pre">picaso.justplotit.</span></span><span class="sig-name descname"><span class="pre">spectrum_hires</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wno</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">legend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.spectrum_hires" title="Link to this definition"></a></dt>
<dd><p>Plot formated albedo spectrum</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wno</strong> (<em>float array</em><em>, </em><em>list</em><em> of </em><em>arrays</em>)  wavenumber</p></li>
<li><p><strong>alb</strong> (<em>float array</em><em>, </em><em>list</em><em> of </em><em>arrays</em>)  albedo</p></li>
<li><p><strong>legend</strong> (<em>list</em><em> of </em><em>str</em>)  legends for plotting</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em>)  Any key word argument for hv.opts</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>bokeh plot</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.justplotit.taumap">
<span class="sig-prename descclassname"><span class="pre">picaso.justplotit.</span></span><span class="sig-name descname"><span class="pre">taumap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">full_output</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">at_tau</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wavelength</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">igauss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.taumap" title="Link to this definition"></a></dt>
<dd><p>Plot breakdown of gas opacity, cloud opacity,
Rayleigh scattering opacity at a specified pressure level.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>full_output</strong> (<em>class</em>)  full_output from dictionary picaso output</p></li>
<li><p><strong>at_tau</strong> (<em>float</em>)  Opacity at which to plot the cumulative opacity.
Default = 0.5.</p></li>
<li><p><strong>igauss</strong> (<em>int</em>)  Gauss point to plot if using ktables this can be greater than 0 up to ngauss-1. Otherwise,
This must be zero for monochromatic opacities.</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em>)  Any key word argument for bokeh.plotting.figure()</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>bokeh plot</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.justplotit.thermal_contribution">
<span class="sig-prename descclassname"><span class="pre">picaso.justplotit.</span></span><span class="sig-name descname"><span class="pre">thermal_contribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">full_output</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">R</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.thermal_contribution" title="Link to this definition"></a></dt>
<dd><p>Computer the contribution function from <a class="reference external" href="https://doi.org/10.3847/1538-4357/aadd9e">https://doi.org/10.3847/1538-4357/aadd9e</a> equation 4
Note the equation in the paper is missing the - sign in the exponent
:param full_output: full dictionary output with {wavenumber,thermal,full_output}
:type full_output: dict
:param tau_max: Maximum tau to consider as opaque, largely here to help prevent NaNs and the colorbar from being weird.
:type tau_max: float, optional
:param **kwargs: Any key word argument for pcolormesh
:type **kwargs: dict</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.justplotit.transmission_contribution">
<span class="sig-prename descclassname"><span class="pre">picaso.justplotit.</span></span><span class="sig-name descname"><span class="pre">transmission_contribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">full_output</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">R</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.transmission_contribution" title="Link to this definition"></a></dt>
<dd><p>Compute the transmission contribution function from</p>
<p><a class="reference external" href="https://petitradtrans.readthedocs.io/en/latest/content/notebooks/analysis.html#Transmission-contribution-functions">https://petitradtrans.readthedocs.io/en/latest/content/notebooks/analysis.html#Transmission-contribution-functions</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>full_output</strong> (<em>dict</em>)  full dictionary output with {wavenumber,thermal,full_output}</p></li>
<li><p><strong>R</strong> (<em>float</em><em>, </em><em>optional</em>)  Resolution for rebinning</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em>)  Any key word argument for pcolormesh</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>fig</em>  matplotlib figure</p></li>
<li><p><em>ax</em>  matplotlib ax</p></li>
<li><p><em>um</em>  micron array</p></li>
<li><p><em>CF_bin</em>  contribution function</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-picaso.opacity_factory">
<span id="picaso-opacity-factory-module"></span><h2>picaso.opacity_factory module<a class="headerlink" href="#module-picaso.opacity_factory" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="picaso.opacity_factory.adapt_array">
<span class="sig-prename descclassname"><span class="pre">picaso.opacity_factory.</span></span><span class="sig-name descname"><span class="pre">adapt_array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.adapt_array" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.opacity_factory.add_all_metadata">
<span class="sig-prename descclassname"><span class="pre">picaso.opacity_factory.</span></span><span class="sig-name descname"><span class="pre">add_all_metadata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">version_number</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wavemin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wavemax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zenodo_doi</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.add_all_metadata" title="Link to this definition"></a></dt>
<dd><p>Adds metadata to an opacity file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>str</em>)  sqlite name</p></li>
<li><p><strong>version_number</strong> (<em>str</em>)  Version number it goes with</p></li>
<li><p><strong>default</strong> (<em>bool</em>)  Is this a default for this verison</p></li>
<li><p><strong>resolution</strong> (<em>str</em>)  resolution resampled to</p></li>
<li><p><strong>wavemin</strong> (<em>str</em>)  minimum wavelength in um</p></li>
<li><p><strong>wavemax</strong> (<em>str</em>)  maximum wavelength in um</p></li>
<li><p><strong>zenodo_doi</strong> (<em>str</em>)  zenodo posting</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.opacity_factory.add_metadata_item">
<span class="sig-prename descclassname"><span class="pre">picaso.opacity_factory.</span></span><span class="sig-name descname"><span class="pre">add_metadata_item</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">db_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.add_metadata_item" title="Link to this definition"></a></dt>
<dd><p>Adds or updates a metadata item in the metadata table.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>db_path</strong> (<em>str</em>)  Path to the SQLite database file.</p></li>
<li><p><strong>key</strong> (<em>str</em>)  The metadata key.</p></li>
<li><p><strong>value</strong> (<em>str</em>)  The metadata value (will be stored as TEXT).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.opacity_factory.add_metadata_table">
<span class="sig-prename descclassname"><span class="pre">picaso.opacity_factory.</span></span><span class="sig-name descname"><span class="pre">add_metadata_table</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">db_path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.add_metadata_table" title="Link to this definition"></a></dt>
<dd><p>Adds a metadata table to the SQLite database if it doesnt exist.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>db_path</strong> (<em>str</em>)  Path to the SQLite database file.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.opacity_factory.are_arrays_different">
<span class="sig-prename descclassname"><span class="pre">picaso.opacity_factory.</span></span><span class="sig-name descname"><span class="pre">are_arrays_different</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arr2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.are_arrays_different" title="Link to this definition"></a></dt>
<dd><p>Checks if two arrays are different, even if they have different sizes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arr1</strong> (<em>array</em><em>, </em><em>float</em>)  The first array.</p></li>
<li><p><strong>arr2</strong> (<em>array</em><em>, </em><em>float</em>)  The second array.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>bool</em></p></li>
<li><p><em>True if the arrays are different, False otherwise.</em></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.opacity_factory.build_skeleton">
<span class="sig-prename descclassname"><span class="pre">picaso.opacity_factory.</span></span><span class="sig-name descname"><span class="pre">build_skeleton</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">db_f</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.build_skeleton" title="Link to this definition"></a></dt>
<dd><dl class="simple">
<dt>This functionb builds a skeleton sqlite3 database with three tables:</dt><dd><ol class="arabic simple">
<li><p>header</p></li>
<li><p>molecular</p></li>
<li><p>continuum</p></li>
</ol>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>db_f</strong> (<em>str</em>)  str of database file name</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.opacity_factory.compute_ck_molecular">
<span class="sig-prename descclassname"><span class="pre">picaso.opacity_factory.</span></span><span class="sig-name descname"><span class="pre">compute_ck_molecular</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">og_directory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gfrac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.95</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alkali_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wv_file_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_max_wavelength</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">R</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_wno</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_dwno</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">climate_filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.compute_ck_molecular" title="Link to this definition"></a></dt>
<dd><p>Function to generate correlated-K tables for each individual gas or for a preweighted opacity file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>molecule</strong> (<em>str</em>)  Name of molecule OR name of hdf5 climate file.
E.g. could be H2O which is the directory where cross section
files live. Or it could be feh_000_co_+100.hdf5 which is located in
og_directory</p></li>
<li><p><strong>og_directory</strong> (<em>str</em>)  Directory of all the cross sections that include folders e.g. H2O, CH4
OR the directory where the sum weighted hdf5 file is</p></li>
<li><p><strong>order</strong> (<em>int</em>)  (Default=4)  Gauss Legendre order which by default is set to 4, with the double gauss method</p></li>
<li><p><strong>gfrac</strong> (<em>int</em>)  (Default=0.95) Double-gauss method of splitting up the gauss points, by default we use 0.95</p></li>
<li><p><strong>alkali_dir</strong> (<em>str</em>)  (Optional) Directory of alkalis or individual_file which is the method to use for Roxana Lupus data.</p></li>
<li><p><strong>wv_file_name</strong> (<em>str</em>)  (optional) file name with wavelength. First column wavenumber, second column delta wavenumber
Must supply this OR combo of min, max wavelength and R</p></li>
<li><p><strong>min_max_wavelength</strong> (<em>list</em><em>,</em><em>float</em>)  (optional) minimum and maximum wavelength if not inputting array or filename in micron e.g. [0.3,300]</p></li>
<li><p><strong>R</strong> (<em>float</em>)  (optional) resolution if inputing a min and max wavelength</p></li>
<li><p><strong>new_wno</strong> (<em>array</em><em>, </em><em>float</em>)  (optional) new wavenumber grid in cm-1</p></li>
<li><p><strong>new_dwno</strong> (<em>array</em><em>, </em><em>float</em>)  (optional) delta wavenumber grid in cm-1</p></li>
<li><p><strong>climate_filename</strong> (<em>str</em>)  (Optional) Name of climate file if saving output as hdf5</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>)  (Optional) prints out status of which p,t, point the code is at</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.opacity_factory.compute_sum_molecular">
<span class="sig-prename descclassname"><span class="pre">picaso.opacity_factory.</span></span><span class="sig-name descname"><span class="pre">compute_sum_molecular</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ck_molecules</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">og_directory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chemistry_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wv_file_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alkali_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_max_wavelength</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">R</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_wno</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_dwno</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.compute_sum_molecular" title="Link to this definition"></a></dt>
<dd><p>Function to generate correlated-K tables for each individual gas</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ck_molecules</strong> (<em>str</em>)  Name of molecule</p></li>
<li><p><strong>og_directory</strong> (<em>str</em>)  Directory of all the cross sections that include folders e.g. H2O, CH4</p></li>
<li><p><strong>chemistry_file</strong> (<em>str</em>)  Chemistry file with abundances</p></li>
<li><p><strong>output_dir</strong> (<em>str</em>)  Directory to output the new database</p></li>
<li><p><strong>filename</strong> (<em>str</em>)  Name of the output file</p></li>
<li><p><strong>wv_file_name</strong> (<em>str</em>)  (optional) file name with wavelength. First column wavenumber, second column delta wavenumber
Must supply this OR combo of min, max wavelength and R</p></li>
<li><p><strong>alkali_dir</strong> (<em>str</em>)  (optional) alakalis directory</p></li>
<li><p><strong>min_max_wavelength</strong> (<em>list</em><em>,</em><em>float</em>)  (optional) minimum and maximum wavelength if not inputting array or filename in micron e.g. [0.3,300]</p></li>
<li><p><strong>R</strong> (<em>float</em>)  (optional) resolution if inputing a min_max_wavelenth</p></li>
<li><p><strong>new_wno</strong> (<em>array</em><em>, </em><em>float</em>)  (optional) new wavenumber grid in cm-1</p></li>
<li><p><strong>new_dwno</strong> (<em>array</em><em>, </em><em>float</em>)  (optional) deltget_all_metadata wavenumber grid in cm-1</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>)  (Optional) prints out status of which p,t, point the code is at</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.opacity_factory.continuum_avail">
<span class="sig-prename descclassname"><span class="pre">picaso.opacity_factory.</span></span><span class="sig-name descname"><span class="pre">continuum_avail</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">db_file</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.continuum_avail" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.opacity_factory.convert_array">
<span class="sig-prename descclassname"><span class="pre">picaso.opacity_factory.</span></span><span class="sig-name descname"><span class="pre">convert_array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.convert_array" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.opacity_factory.create_grid">
<span class="sig-prename descclassname"><span class="pre">picaso.opacity_factory.</span></span><span class="sig-name descname"><span class="pre">create_grid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">min_wavelength</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_wavelength</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constant_R</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.create_grid" title="Link to this definition"></a></dt>
<dd><p>Simple function to create a wavelength grid defined with a constant R.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>min_wavelength</strong> (<em>float</em>)  Minimum wavelength in microns</p></li>
<li><p><strong>max_wavelength</strong> (<em>float</em>)  Maximum wavelength in microns</p></li>
<li><p><strong>constant_R</strong> (<em>float</em>)  Constant R spacing</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>wavenumber grid defined at constant Resolution</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.opacity_factory.create_grid_minR">
<span class="sig-prename descclassname"><span class="pre">picaso.opacity_factory.</span></span><span class="sig-name descname"><span class="pre">create_grid_minR</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">min_wavelength</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_wavelength</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minimum_R</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.create_grid_minR" title="Link to this definition"></a></dt>
<dd><p>Simple function to create a wavelength grid defined with a minimum R.
This does not create a constant resolution grid. Rather, it defines the R
at the minimum R so that the wavelength grid satisfies all_Rs&gt;R</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>min_wavelength</strong> (<em>float</em>)  Minimum wavelength in microns</p></li>
<li><p><strong>max_wavelength</strong> (<em>float</em>)  Maximum wavelength in microns</p></li>
<li><p><strong>minimum_R</strong> (<em>float</em>)  Minimum resolution to define the grid</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.opacity_factory.delete_molecule">
<span class="sig-prename descclassname"><span class="pre">picaso.opacity_factory.</span></span><span class="sig-name descname"><span class="pre">delete_molecule</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">db_filename</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.delete_molecule" title="Link to this definition"></a></dt>
<dd><p>Delete a record from the database</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mol</strong> (<em>str</em>)  molecule to delete</p></li>
<li><p><strong>db_filename</strong> (<em>str</em>)  database to delete record from</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.opacity_factory.find_nearest">
<span class="sig-prename descclassname"><span class="pre">picaso.opacity_factory.</span></span><span class="sig-name descname"><span class="pre">find_nearest</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.find_nearest" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.opacity_factory.find_nearest_1d">
<span class="sig-prename descclassname"><span class="pre">picaso.opacity_factory.</span></span><span class="sig-name descname"><span class="pre">find_nearest_1d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.find_nearest_1d" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.opacity_factory.fit_linsky">
<span class="sig-prename descclassname"><span class="pre">picaso.opacity_factory.</span></span><span class="sig-name descname"><span class="pre">fit_linsky</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wno</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">va</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.fit_linsky" title="Link to this definition"></a></dt>
<dd><p>Adds H2-H2 opacity from Linsky (1969) and Lenzuni et al. (1991)
to values that were set to -33 as place holders.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> (<em>float</em>)  Temperature</p></li>
<li><p><strong>wno</strong> (<em>numpy.array</em>)  wave number</p></li>
<li><p><strong>va</strong> (<em>int</em><em> or </em><em>float</em>)  (Optional) 1,2 or 3 (depending on what overtone to compute</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>H2-H2 absorption in cm-1 amagat-2</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.opacity_factory.func_read_gas">
<span class="sig-prename descclassname"><span class="pre">picaso.opacity_factory.</span></span><span class="sig-name descname"><span class="pre">func_read_gas</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">og_directory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gfrac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.95</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alkali_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wv_file_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_max_wavelength</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">R</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_wno</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_dwno</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">climate_filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.func_read_gas" title="Link to this definition"></a></dt>
<dd><p>Function to generate correlated-K tables for each individual gas or for a preweighted opacity file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>molecule</strong> (<em>str</em>)  Name of molecule OR name of hdf5 climate file.
E.g. could be H2O which is the directory where cross section
files live. Or it could be feh_000_co_+100.hdf5 which is located in
og_directory</p></li>
<li><p><strong>og_directory</strong> (<em>str</em>)  Directory of all the cross sections that include folders e.g. H2O, CH4
OR the directory where the sum weighted hdf5 file is</p></li>
<li><p><strong>order</strong> (<em>int</em>)  (Default=4)  Gauss Legendre order which by default is set to 4, with the double gauss method</p></li>
<li><p><strong>gfrac</strong> (<em>int</em>)  (Default=0.95) Double-gauss method of splitting up the gauss points, by default we use 0.95</p></li>
<li><p><strong>alkali_dir</strong> (<em>str</em>)  (Optional) Directory of alkalis or individual_file which is the method to use for Roxana Lupus data.</p></li>
<li><p><strong>wv_file_name</strong> (<em>str</em>)  (optional) file name with wavelength. First column wavenumber, second column delta wavenumber
Must supply this OR combo of min, max wavelength and R</p></li>
<li><p><strong>min_max_wavelength</strong> (<em>list</em><em>,</em><em>float</em>)  (optional) minimum and maximum wavelength if not inputting array or filename in micron e.g. [0.3,300]</p></li>
<li><p><strong>R</strong> (<em>float</em>)  (optional) resolution if inputing a min and max wavelength</p></li>
<li><p><strong>new_wno</strong> (<em>array</em><em>, </em><em>float</em>)  (optional) new wavenumber grid in cm-1</p></li>
<li><p><strong>new_dwno</strong> (<em>array</em><em>, </em><em>float</em>)  (optional) delta wavenumber grid in cm-1</p></li>
<li><p><strong>climate_filename</strong> (<em>str</em>)  (Optional) Name of climate file if saving output as hdf5</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>)  (Optional) prints out status of which p,t, point the code is at</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.opacity_factory.g_w_2gauss">
<span class="sig-prename descclassname"><span class="pre">picaso.opacity_factory.</span></span><span class="sig-name descname"><span class="pre">g_w_2gauss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gfrac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.95</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.g_w_2gauss" title="Link to this definition"></a></dt>
<dd><p>Gets gauss and weight poitns for correlated-k function
Specifically for the 2-point gauss method</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>order</strong> (<em>int</em>)  Gauss order</p></li>
<li><p><strong>gfrac</strong> (<em>float</em>)  Adjustable parameter which sets the division in the values of G which will
be sampled by the first and second set of Gauss points.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>gauss, weights</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.opacity_factory.get_all_metadata">
<span class="sig-prename descclassname"><span class="pre">picaso.opacity_factory.</span></span><span class="sig-name descname"><span class="pre">get_all_metadata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">db_path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.get_all_metadata" title="Link to this definition"></a></dt>
<dd><p>What metadata exists</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.opacity_factory.get_ck_tables">
<span class="sig-prename descclassname"><span class="pre">picaso.opacity_factory.</span></span><span class="sig-name descname"><span class="pre">get_ck_tables</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preload_gases</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">avail_continuum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.get_ck_tables" title="Link to this definition"></a></dt>
<dd><p>Unified loader for correlated-k files (both preweighted HDF5 and resortrebin directory).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> (<em>str</em>)  Path to either a single HDF5 file (preweighted) or a directory containing
individual molecule files (resortrebin).</p></li>
<li><p><strong>preload_gases</strong> (<em>list</em><em> of </em><em>str</em><em>, </em><em>optional</em>)  List of gases to load if in resortrebin mode.</p></li>
<li><p><strong>avail_continuum</strong> (<em>list</em><em> of </em><em>str</em><em>, </em><em>optional</em>)  List of available continuum molecules to check against.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary containing all loaded data.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.opacity_factory.get_continuum">
<span class="sig-prename descclassname"><span class="pre">picaso.opacity_factory.</span></span><span class="sig-name descname"><span class="pre">get_continuum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">db_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">species</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.get_continuum" title="Link to this definition"></a></dt>
<dd><p>Grab continuum opacity from sqlite database</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>db_file</strong> (<em>str</em>)  sqlite3 database filename</p></li>
<li><p><strong>species</strong> (<em>list</em><em> of </em><em>str</em>)  Single species name. you can run continuum_avail to see what species are present.</p></li>
<li><p><strong>temperature</strong> (<em>list</em><em> of </em><em>float</em>)  Temperature to grab. can grab available temperatures from continuum_avail</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.opacity_factory.get_h2minus">
<span class="sig-prename descclassname"><span class="pre">picaso.opacity_factory.</span></span><span class="sig-name descname"><span class="pre">get_h2minus</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_wno</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.get_h2minus" title="Link to this definition"></a></dt>
<dd><p>This results gives the H2 minus opacity, needed for temperatures greater than 600 K.
K L Bell 1980 J. Phys. B: At. Mol. Phys. 13 1859, Table 1
theta=5040/T(K)</p>
<p>The result is given in cm4/dyn, which is why will will  multiply by nh2*ne*k*T
where:
nh2: number of h2 molecules/cm3
ne: number of electrons/cm3
This will happen when we go to sum opacities. For now returns will be in cm4/dyn</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> (<em>numpy.ndarray</em>)  temperature in K</p></li>
<li><p><strong>wno</strong> (<em>numpy.ndarray</em>)  wave number cm-1</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>H2 minus opacity in units of cm4/dyn</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.opacity_factory.get_hminusbf">
<span class="sig-prename descclassname"><span class="pre">picaso.opacity_factory.</span></span><span class="sig-name descname"><span class="pre">get_hminusbf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wno</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.get_hminusbf" title="Link to this definition"></a></dt>
<dd><p>H- bound free opacity, which is only dependent on wavelength. From John 1988 <a class="reference external" href="http://adsabs.harvard.edu/abs/1988A%26A...193..189J">http://adsabs.harvard.edu/abs/1988A%26A193..189J</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>wno</strong> (<em>numpy.ndarray</em>)  Wavenumber in cm-1</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Absorption coefficient in units of cm2</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array of floats</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.opacity_factory.get_hminusff">
<span class="sig-prename descclassname"><span class="pre">picaso.opacity_factory.</span></span><span class="sig-name descname"><span class="pre">get_hminusff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wno</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.get_hminusff" title="Link to this definition"></a></dt>
<dd><p>H- free free opacity, which is both wavelength and temperature dependent.
From Bell &amp; Berrington (1987)
Also includes factor for simulated emission</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> (<em>float</em>)  Temperature in K</p></li>
<li><p><strong>wno</strong> (<em>numpy.ndarray</em>)  Wavenumber in cm-1</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Gives cross section in cm^5</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array of float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.opacity_factory.get_kark_CH4">
<span class="sig-prename descclassname"><span class="pre">picaso.opacity_factory.</span></span><span class="sig-name descname"><span class="pre">get_kark_CH4</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kark_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_wno</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dset</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.get_kark_CH4" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kark_file</strong> (<em>str</em>)  Directory where the Karkoschka CH4 data is stored</p></li>
<li><p><strong>new_wno</strong> (<em>array</em>)  Wavelength grid to interpolate the Karkoschka data onto</p></li>
<li><p><strong>T.dset</strong> (<em>float</em>)  Temperature in Kelvin</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.opacity_factory.get_kark_CH4_noTdependence">
<span class="sig-prename descclassname"><span class="pre">picaso.opacity_factory.</span></span><span class="sig-name descname"><span class="pre">get_kark_CH4_noTdependence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kark_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_wave</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.get_kark_CH4_noTdependence" title="Link to this definition"></a></dt>
<dd><p>Files from kark+2010 paper</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kark_dir</strong> (<em>str</em>)  Directory where the Karkoschka CH4 data is stored</p></li>
<li><p><strong>new_wave</strong> (<em>array</em>)  Wavelength grid to interpolate the Karkoschka data onto</p></li>
<li><p><strong>temperature</strong> (<em>float</em>)  Temperature in Kelvin</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>opacity in cm2/species</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.opacity_factory.get_metadata_item">
<span class="sig-prename descclassname"><span class="pre">picaso.opacity_factory.</span></span><span class="sig-name descname"><span class="pre">get_metadata_item</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">db_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.get_metadata_item" title="Link to this definition"></a></dt>
<dd><p>Retrieves a metadata item by key.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>db_path</strong> (<em>str</em>)  Path to the SQLite database file.</p></li>
<li><p><strong>key</strong> (<em>str</em>)  The metadata key.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>The metadata value associated with the key, or None if the key is not found.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.opacity_factory.get_molecular">
<span class="sig-prename descclassname"><span class="pre">picaso.opacity_factory.</span></span><span class="sig-name descname"><span class="pre">get_molecular</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">db_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">species</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pressure</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.get_molecular" title="Link to this definition"></a></dt>
<dd><p>Grab molecular opacity from sqlite database</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>db_file</strong> (<em>str</em>)  sqlite3 database filename</p></li>
<li><p><strong>species</strong> (<em>list</em><em> of </em><em>str</em>)  Single species name. you can run molecular_avail to see what species are present.</p></li>
<li><p><strong>temperature</strong> (<em>list</em><em> of </em><em>flaot</em><em>,</em><em>int</em>)  Temperature to grab. This will grab the nearest pair neighbor so you dont
have to be exact.
This should be used in conjuction with pressure. For example, if you want
one temperature at two pressures, then this should be input as
t = [100,100] (and pressure would be p=[0.1,1] for instance)</p></li>
<li><p><strong>pressure</strong> (<em>list</em><em> of </em><em>flaot</em><em>,</em><em>int</em>)  Pressure to grab. This will grab the nearest pair neighbor so you dont
have to be exact.
This should be used in conjuction with pressure. For example, if you want
one temperature at two pressures, then this should be input as
t = [100,100] (and pressure would be p=[0.1,1] for instance)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.opacity_factory.get_optical_o3">
<span class="sig-prename descclassname"><span class="pre">picaso.opacity_factory.</span></span><span class="sig-name descname"><span class="pre">get_optical_o3</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_o3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_wvno_grid</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.get_optical_o3" title="Link to this definition"></a></dt>
<dd><p>This hacked ozone is from here:
<a class="reference external" href="http://satellite.mpic.de/spectral_atlas/cross_sections/Ozone/O3.spc">http://satellite.mpic.de/spectral_atlas/cross_sections/Ozone/O3.spc</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file_o3</strong> (<em>str</em>)  Directory where the optical ozone data is stored</p></li>
<li><p><strong>new_wvno_grid</strong> (<em>array</em>)  Wavelength grid to interpolate the optical ozone data onto</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.opacity_factory.get_original_data">
<span class="sig-prename descclassname"><span class="pre">picaso.opacity_factory.</span></span><span class="sig-name descname"><span class="pre">get_original_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">original_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colnames</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_db</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.get_original_data" title="Link to this definition"></a></dt>
<dd><p>The continuum factory takes the CIA opacity file and adds in extra sources of
opacity from other references to fill in empty bands. It assumes that the original file is
structured as following,with the first column wavenumber and the rest molecules:
1000 198
75.
0.0  -33.0000  -33.0000  -33.0000  -33.0000  -33.0000
20.0   -7.4572   -7.4518   -6.8038   -6.0928   -5.9806
40.0   -6.9547   -6.9765   -6.6322   -5.7934   -5.4823
   etc</p>
<p>Where 1000 corresponds to the number of wavelengths, 198 corresponds to the number of temperatures
and 75 is the first temperature. If this structure changes, we will need to restructure this top
level __init__ function that reads it in the original opacity file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>original_file</strong> (<em>str</em>)  Filepath that points to original opacity file (see description above)</p></li>
<li><p><strong>colnames</strong> (<em>list</em>)  defines the sources of opacity in the original file. For the example file above,
colnames would be [wno,H2H2,H2He,H2H,H2CH4,H2N2]</p></li>
<li><p><strong>new_db</strong> (<em>str</em>)  New database name</p></li>
<li><p><strong>overwrite</strong> (<em>bool</em>)  Default is set to False as to not overwrite any existing files. This parameter controls overwriting
cia database</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.opacity_factory.get_wvno_grid">
<span class="sig-prename descclassname"><span class="pre">picaso.opacity_factory.</span></span><span class="sig-name descname"><span class="pre">get_wvno_grid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_wavelength</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_wavelength</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">R</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.get_wvno_grid" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>str</em>)  File name with wavenumber and delta wavenumber in two columns</p></li>
<li><p><strong>min_wavelength</strong> (<em>float</em>)  (optional) minimum wavelength in database in units of micron</p></li>
<li><p><strong>max_wavelength</strong> (<em>float</em>)  (optional) maximum wavelength in database in units of micron</p></li>
<li><p><strong>R</strong> (<em>float</em>)  (optional) resolution if inputing a min_max_wavelength</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.opacity_factory.h2h2_overtone">
<span class="sig-prename descclassname"><span class="pre">picaso.opacity_factory.</span></span><span class="sig-name descname"><span class="pre">h2h2_overtone</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wno</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.h2h2_overtone" title="Link to this definition"></a></dt>
<dd><p>Add in special CIA h2h2 band at 0.8 microns</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> (<em>float</em>)  Temperature</p></li>
<li><p><strong>wno</strong> (<em>numpy.array</em>)  wave number</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>H2-H2 absorption in cm-1 amagat-2</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.opacity_factory.insert">
<span class="sig-prename descclassname"><span class="pre">picaso.opacity_factory.</span></span><span class="sig-name descname"><span class="pre">insert</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cur</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opacity</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.insert" title="Link to this definition"></a></dt>
<dd><p>Insert into</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.opacity_factory.insert_hitran_cia">
<span class="sig-prename descclassname"><span class="pre">picaso.opacity_factory.</span></span><span class="sig-name descname"><span class="pre">insert_hitran_cia</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">original_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">molname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_db</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_wno</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.insert_hitran_cia" title="Link to this definition"></a></dt>
<dd><p>This continuum function takes a HTIRAN CIA file and adds it as an extra
source of opacity</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>original_file</strong> (<em>str</em>)  Filepath that points to HITRAN file (e.g. H2-CH4_eq_2011.cia)</p></li>
<li><p><strong>molname</strong> (<em>str</em>)  Name of molecule (e.g. N2N2)</p></li>
<li><p><strong>new_db</strong> (<em>str</em>)  New database name</p></li>
<li><p><strong>new_wno</strong> (<em>array</em><em>, </em><em>list</em>)  wavenumber grid to interpolate onto (units of inverse cm)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.opacity_factory.insert_molecular_1060">
<span class="sig-prename descclassname"><span class="pre">picaso.opacity_factory.</span></span><span class="sig-name descname"><span class="pre">insert_molecular_1060</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_wavelength</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_wavelength</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_R</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">og_directory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_db</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dir_kark_ch4</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dir_optical_o3</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.insert_molecular_1060" title="Link to this definition"></a></dt>
<dd><p>Function to resample 1060 grid data onto lower resolution grid. The general procedure
in this function is to interpolate original 1060 data onto very high resolution
grid (R=1e6). Then, determine number of bins to take given input new_R. The final
opacity grid will be : original_opacity[::BINS]</p>
<p>NOTE: From several tests new_R should be at least 100x higher than the ultimate
planet spectrum you want to bin down to.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>molecule</strong> (<em>str</em>)  Name of molecule (should match a directory with 1060 files)</p></li>
<li><p><strong>min_wavelength</strong> (<em>float</em>)  Minimum wavelength in database in units of micron</p></li>
<li><p><strong>max_wavelength</strong> (<em>float</em>)  Maximum wavelength in database in units of micron</p></li>
<li><p><strong>new_R</strong> (<em>float</em>)  New R to regrid to. If new_R=None, it will retain the original 1e6 million resolution
of the lbl grid.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.opacity_factory.insert_molecular_1460">
<span class="sig-prename descclassname"><span class="pre">picaso.opacity_factory.</span></span><span class="sig-name descname"><span class="pre">insert_molecular_1460</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_wavelength</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_wavelength</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">og_directory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_db</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_R</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_dwno</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">old_R</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">old_dwno</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0035</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alkali_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'alkalis'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dir_kark_ch4</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dir_optical_o3</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">insert_direct</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.insert_molecular_1460" title="Link to this definition"></a></dt>
<dd><p>DEVELOPER USE ONLY.
Function to resample 1060 grid data onto lower resolution grid. The general procedure
in this function is to interpolate original 1060 data onto very high resolution
grid (R=1e6). Then, determine number of bins to take given input new_R. The final
opacity grid will be : original_opacity[::BINS]</p>
<p>NOTE: From several tests new_R should be at least 100x higher than the ultimate
planet spectrum you want to bin down to.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>molecule</strong> (<em>str</em>)  Name of molecule (should match a directory with 1060 files)</p></li>
<li><p><strong>min_wavelength</strong> (<em>float</em>)  Minimum wavelength in database in units of micron</p></li>
<li><p><strong>max_wavelength</strong> (<em>float</em>)  Maximum wavelength in database in units of micron</p></li>
<li><p><strong>new_R</strong> (<em>int</em><em>,</em><em>float</em><em> , </em><em>optional</em>)  Optional, new R to regrid to. This will create a new wavelength solution that is
constant in R. The other option (new_dwno is to do constant wavenumber bin)
This must be smaller than old_R, which is default to 1e6.</p></li>
<li><p><strong>old_R</strong> (<em>int</em><em>,</em><em>float</em><em>, </em><em>optional</em>)  This is set to match the approximate cross sections that are computed LBL. If you do not
want any resampling, then you need to set new_R=old_R</p></li>
<li><p><strong>new_dwno</strong> (<em>float</em><em>, </em><em>optional</em>)  Optional, new constant wavenumber bin to create wavelength solution. This must be bigger
than old_dwno.</p></li>
<li><p><strong>old_dwno</strong> (<em>float</em><em>, </em><em>optional</em>)  This is set to 0.0035 to match the smallest wavenumber than we compute in our grid.
If you do not want any resampling, then you need to set new_dwno=old_dwno</p></li>
<li><p><strong>og_directory</strong> (<em>str</em>)  Directory of all the cross sections that include folders e.g. H2O, CH4</p></li>
<li><p><strong>alkali_dir</strong> (<em>str</em>)  Alakalis directory</p></li>
<li><p><strong>new_db</strong> (<em>str</em>)  New database name</p></li>
<li><p><strong>dir_kark_ch4</strong> (<em>str</em>)  Karkoschka methane to hack in</p></li>
<li><p><strong>dir_optical_o3</strong> (<em>str</em>)  optical ozone to hack in</p></li>
<li><p><strong>insert_direct</strong> (<em>bool</em>)  this ignores all other inputs except min and max wavelength and
inserts opacities into the database diretly as is</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.opacity_factory.insert_wno_grid">
<span class="sig-prename descclassname"><span class="pre">picaso.opacity_factory.</span></span><span class="sig-name descname"><span class="pre">insert_wno_grid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wno_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cur</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">con</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.insert_wno_grid" title="Link to this definition"></a></dt>
<dd><p>Inserts basics into the header file. This puts all the units to the database.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wno_grid</strong> (<em>array</em>)  Wavenumber grid in units of cm-1</p></li>
<li><p><strong>cur</strong> (<em>sqlite3.Cursor</em>)  Cursor object to the database</p></li>
<li><p><strong>con</strong> (<em>sqlite3.Connection</em>)  Connection object to the database</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.opacity_factory.listdir">
<span class="sig-prename descclassname"><span class="pre">picaso.opacity_factory.</span></span><span class="sig-name descname"><span class="pre">listdir</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.listdir" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.opacity_factory.molecular_avail">
<span class="sig-prename descclassname"><span class="pre">picaso.opacity_factory.</span></span><span class="sig-name descname"><span class="pre">molecular_avail</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">db_file</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.molecular_avail" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.opacity_factory.open_local">
<span class="sig-prename descclassname"><span class="pre">picaso.opacity_factory.</span></span><span class="sig-name descname"><span class="pre">open_local</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">db_f</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.open_local" title="Link to this definition"></a></dt>
<dd><p>Code needed to open up local database, interpret arrays from bytes and return cursor</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.opacity_factory.regrid">
<span class="sig-prename descclassname"><span class="pre">picaso.opacity_factory.</span></span><span class="sig-name descname"><span class="pre">regrid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">newx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">R</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">statistic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mean'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.regrid" title="Link to this definition"></a></dt>
<dd><p>Rebin the spectrum at a minimum R or on a fixed grid</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>array</em>)  Wavenumbers</p></li>
<li><p><strong>y</strong> (<em>array</em>)  Anything (e.g. albedo, flux)</p></li>
<li><p><strong>newx</strong> (<em>array</em>)  (optional) new array to regrid on.</p></li>
<li><p><strong>R</strong> (<em>float</em>)  (optional) create grid with constant R</p></li>
<li><p><strong>statistic</strong> (<em>str</em>)  (optional) statistic to use for binning.
Default is mean, but can also be median or std</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>final x, and final y</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.opacity_factory.restruct_continuum">
<span class="sig-prename descclassname"><span class="pre">picaso.opacity_factory.</span></span><span class="sig-name descname"><span class="pre">restruct_continuum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">original_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colnames</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_wno</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_db</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.restruct_continuum" title="Link to this definition"></a></dt>
<dd><p>The continuum factory takes the CIA opacity file and adds in extra sources of
opacity from other references to fill in empty bands. It assumes that the original file is
structured as following,with the first column wavenumber and the rest molecules:
1000 198
75.
0.0  -33.0000  -33.0000  -33.0000  -33.0000  -33.0000
20.0   -7.4572   -7.4518   -6.8038   -6.0928   -5.9806
40.0   -6.9547   -6.9765   -6.6322   -5.7934   -5.4823
   etc</p>
<p>Where 1000 corresponds to the number of wavelengths, 198 corresponds to the number of temperatures
and 75 is the first temperature. If this structure changes, we will need to restructure this top
level __init__ function that reads it in the original opacity file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>original_file</strong> (<em>str</em>)  Filepath that points to original opacity file (see description above)</p></li>
<li><p><strong>colnames</strong> (<em>list</em>)  defines the sources of opacity in the original file. For the example file above,
colnames would be [wno,H2H2,H2He,H2H,H2CH4,H2N2]</p></li>
<li><p><strong>new_wno</strong> (<em>numpy.ndarray</em><em>, </em><em>list</em>)  wavenumber grid to interpolate onto (units of inverse cm)</p></li>
<li><p><strong>new_db</strong> (<em>str</em>)  New database name</p></li>
<li><p><strong>overwrite</strong> (<em>bool</em>)  Default is set to False as to not overwrite any existing files. This parameter controls overwriting
cia database</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.opacity_factory.restructure_opacity">
<span class="sig-prename descclassname"><span class="pre">picaso.opacity_factory.</span></span><span class="sig-name descname"><span class="pre">restructure_opacity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">new_db</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ntemp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperatures</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">molecules</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">og_opacity</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">old_wno</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_wno</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.restructure_opacity" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>new_db</strong> (<em>str</em>)  str of new database name</p></li>
<li><p><strong>ntemp</strong> (<em>int</em>)  int of number of temperatures</p></li>
<li><p><strong>temperatures</strong> (<em>array</em>)  array of temperatures</p></li>
<li><p><strong>molecules</strong> (<em>list</em>)  list of molecules to put in database</p></li>
<li><p><strong>og_opacity</strong> (<em>pandas dataframe</em>)  pandas dataframe of original opacity</p></li>
<li><p><strong>old_wno</strong> (<em>array</em>)  array of original wavenumbers</p></li>
<li><p><strong>new_wno</strong> (<em>array</em>)  array of new wavenumbers to interpolate onto</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.opacity_factory.vectorize_rebin_mean">
<span class="sig-prename descclassname"><span class="pre">picaso.opacity_factory.</span></span><span class="sig-name descname"><span class="pre">vectorize_rebin_mean</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bins</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Fp</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.vectorize_rebin_mean" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.opacity_factory.vectorize_rebin_median">
<span class="sig-prename descclassname"><span class="pre">picaso.opacity_factory.</span></span><span class="sig-name descname"><span class="pre">vectorize_rebin_median</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bins</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Fp</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.vectorize_rebin_median" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.opacity_factory.vresample_and_insert_molecular">
<span class="sig-prename descclassname"><span class="pre">picaso.opacity_factory.</span></span><span class="sig-name descname"><span class="pre">vresample_and_insert_molecular</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_wavelength</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_wavelength</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_R</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">og_directory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_db</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.vresample_and_insert_molecular" title="Link to this definition"></a></dt>
<dd><p>This function is identical to resample_and_insert_molecular but it was
written to determine if taking the median was better than taking every BINth
data point. It uses a special  vectorize function to speed up the median.
Results are about the same but this is much slower to run.
So dont bother using this unless there is something specific to try.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>molecule</strong> (<em>str</em>)  Name of molecule</p></li>
<li><p><strong>min_wavelength</strong> (<em>float</em>)  Minimum wavelength in database in units of micron</p></li>
<li><p><strong>max_wavelength</strong> (<em>float</em>)  Maximum wavelength in database in units of micron</p></li>
<li><p><strong>new_R</strong> (<em>float</em>)  New R to regrid to</p></li>
<li><p><strong>og_directory</strong> (<em>str</em>)  Directory of all the cross sections that include folders e.g. H2O, CH4</p></li>
<li><p><strong>new_db</strong> (<em>str</em>)  New database name</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-picaso.optics">
<span id="picaso-optics-module"></span><h2>picaso.optics module<a class="headerlink" href="#module-picaso.optics" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="picaso.optics.RetrieveCKs">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">picaso.optics.</span></span><span class="sig-name descname"><span class="pre">RetrieveCKs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ck_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">continuum_db</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'preweighted'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preload_gases</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wave_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.RetrieveCKs" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>This will be the class to retrieve correlated-k tables from the database.
Right now this is in beta mode and is retrieving the direct heritage
196 grid files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ck_dir</strong> (<em>str</em>)  Directory of the pre-mixed correlated k table data. Check that you are pointing to a
directory with the files ascii_data and full_abunds.</p></li>
<li><p><strong>cont_dir</strong> (<em>str</em>)  This should be in the references directory on Github. This has all the continuum opacity
that you need (e.g. H2H2). It also has some extra cross sections that you may want to add
in like Karkoschka methane and the optical ozone band.</p></li>
<li><p><strong>wave_range</strong> (<em>list</em>)  NOT FUNCTIONAL YET.
Wavelength range to compuate in the format [min micron, max micron]</p></li>
<li><p><strong>deq</strong> (<em>bool</em>)  Either runs disequilibrium chemistry or not</p></li>
<li><p><strong>on_fly</strong> (<em>bool</em><em>, </em><em>deprecated</em>)  deprecated, used to turn on and off the old method of doing diseq with</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="picaso.optics.RetrieveCKs.adapt_array">
<span class="sig-name descname"><span class="pre">adapt_array</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.RetrieveCKs.adapt_array" title="Link to this definition"></a></dt>
<dd><p>needed to interpret bytes to array</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="picaso.optics.RetrieveCKs.convert_array">
<span class="sig-name descname"><span class="pre">convert_array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.RetrieveCKs.convert_array" title="Link to this definition"></a></dt>
<dd><p>needed to interpret bytes to array</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="picaso.optics.RetrieveCKs.get_available_continuum">
<span class="sig-name descname"><span class="pre">get_available_continuum</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.RetrieveCKs.get_available_continuum" title="Link to this definition"></a></dt>
<dd><p>Get the pressures and temperatures that are available for the continuum and molecules</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="picaso.optics.RetrieveCKs.get_available_rayleigh">
<span class="sig-name descname"><span class="pre">get_available_rayleigh</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.RetrieveCKs.get_available_rayleigh" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="picaso.optics.RetrieveCKs.get_continuum">
<span class="sig-name descname"><span class="pre">get_continuum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atmosphere</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.RetrieveCKs.get_continuum" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="picaso.optics.RetrieveCKs.get_gauss_pts_661_1460_deprecate">
<span class="sig-name descname"><span class="pre">get_gauss_pts_661_1460_deprecate</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.RetrieveCKs.get_gauss_pts_661_1460_deprecate" title="Link to this definition"></a></dt>
<dd><p>NOT needed anymore, should be replaced with 1460 function
Function to read the legacy data of the 1060 grid computed by Roxana Lupu.
.. note:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">This</span> <span class="n">function</span> <span class="ow">is</span> <span class="o">**</span><span class="n">highly</span><span class="o">**</span> <span class="n">sensitive</span> <span class="n">to</span> <span class="n">the</span> <span class="n">file</span> <span class="nb">format</span><span class="o">.</span> <span class="n">You</span> <span class="n">cannot</span> <span class="n">edit</span> <span class="n">the</span> <span class="n">ascii</span> <span class="n">file</span> <span class="ow">and</span> <span class="n">then</span>
<span class="n">run</span> <span class="n">this</span> <span class="n">function</span><span class="o">.</span> <span class="n">Each</span> <span class="n">specific</span> <span class="n">line</span> <span class="ow">is</span> <span class="n">accounted</span> <span class="k">for</span><span class="o">.</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="picaso.optics.RetrieveCKs.get_h5_data">
<span class="sig-name descname"><span class="pre">get_h5_data</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.RetrieveCKs.get_h5_data" title="Link to this definition"></a></dt>
<dd><p>Reads in new h5py formatted data</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="picaso.optics.RetrieveCKs.get_legacy_data_1060">
<span class="sig-name descname"><span class="pre">get_legacy_data_1060</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wave_range</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.RetrieveCKs.get_legacy_data_1060" title="Link to this definition"></a></dt>
<dd><p>Function to read the legacy data of the 1060 grid computed by Roxana Lupu.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function is <strong>highly</strong> sensitive to the file format. You cannot edit the ascii file and then
run this function. Each specific line is accounted for.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="picaso.optics.RetrieveCKs.get_legacy_data_1460">
<span class="sig-name descname"><span class="pre">get_legacy_data_1460</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.RetrieveCKs.get_legacy_data_1460" title="Link to this definition"></a></dt>
<dd><p>Function to read the legacy data of the 1060 grid computed by Roxana Lupu.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function is <strong>highly</strong> sensitive to the file format. You cannot edit the ascii file and then
run this function. Each specific line is accounted for.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="picaso.optics.RetrieveCKs.get_mixing_indices">
<span class="sig-name descname"><span class="pre">get_mixing_indices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atmosphere</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.RetrieveCKs.get_mixing_indices" title="Link to this definition"></a></dt>
<dd><p>Takes in atmosphere profile and returns an array which is
nlayer by ngauss by nwno</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="picaso.optics.RetrieveCKs.get_new_wvno_grid_661">
<span class="sig-name descname"><span class="pre">get_new_wvno_grid_661</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.RetrieveCKs.get_new_wvno_grid_661" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="picaso.optics.RetrieveCKs.get_opacities_deq_deprecate">
<span class="sig-name descname"><span class="pre">get_opacities_deq_deprecate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atmosphere</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.RetrieveCKs.get_opacities_deq_deprecate" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="picaso.optics.RetrieveCKs.get_opacities_deq_onfly">
<span class="sig-name descname"><span class="pre">get_opacities_deq_onfly</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atmosphere</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude_mol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.RetrieveCKs.get_opacities_deq_onfly" title="Link to this definition"></a></dt>
<dd><p>Gets opacities from the individual gas CK tables and mixes them
accordingly</p>
<dl class="simple">
<dt>atmosphere<span class="classifier">class</span></dt><dd><p>picaso atmosphere class</p>
</dd>
<dt>exclude_mol<span class="classifier">int</span></dt><dd><p>Not yet functional for CK option since they are premixed. For individual
CK molecules, this will ignore the optical contribution from one molecule.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="picaso.optics.RetrieveCKs.get_opacities_preweighted">
<span class="sig-name descname"><span class="pre">get_opacities_preweighted</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atmosphere</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude_mol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.RetrieveCKs.get_opacities_preweighted" title="Link to this definition"></a></dt>
<dd><p>Gets opacities from the premixed tables only</p>
<dl class="simple">
<dt>atmosphere<span class="classifier">class</span></dt><dd><p>picaso atmosphere class</p>
</dd>
<dt>exclude_mol<span class="classifier">int</span></dt><dd><p>Not yet functional for CK option since they are premixed. For individual
CK molecules, this will ignore the optical contribution from one molecule.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="picaso.optics.RetrieveCKs.get_pre_mix_ck">
<span class="sig-name descname"><span class="pre">get_pre_mix_ck</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atmosphere</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.RetrieveCKs.get_pre_mix_ck" title="Link to this definition"></a></dt>
<dd><p>Takes in atmosphere profile and returns an array which is
nlayer by ngauss by nwno</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="picaso.optics.RetrieveCKs.get_pre_mix_ck_nearest">
<span class="sig-name descname"><span class="pre">get_pre_mix_ck_nearest</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atmosphere</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.RetrieveCKs.get_pre_mix_ck_nearest" title="Link to this definition"></a></dt>
<dd><p>Takes in atmosphere profile and returns an array which is
nlayer by ngauss by nwno</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="picaso.optics.RetrieveCKs.load_kcoeff_arrays_deprecate">
<span class="sig-name descname"><span class="pre">load_kcoeff_arrays_deprecate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.RetrieveCKs.load_kcoeff_arrays_deprecate" title="Link to this definition"></a></dt>
<dd><p>This loads and returns the kappa tables from Theodoras bin_mol files
will have this very hardcoded.
use this func only once before run begins</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="picaso.optics.RetrieveCKs.load_kcoeff_arrays_first">
<span class="sig-name descname"><span class="pre">load_kcoeff_arrays_first</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.RetrieveCKs.load_kcoeff_arrays_first" title="Link to this definition"></a></dt>
<dd><p>This loads and returns the kappa tables from
opacity_factory.compute_ck_molecular()
Currently we have a single file for each molecule</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> (<em>str</em>)  Path to the individual ck files</p></li>
<li><p><strong>gases_fly</strong> (<em>bool</em>)  Specifies what gasses to mix on the fly</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="picaso.optics.RetrieveCKs.mix_my_opacities_deprecate">
<span class="sig-name descname"><span class="pre">mix_my_opacities_deprecate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atmosphere</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.RetrieveCKs.mix_my_opacities_deprecate" title="Link to this definition"></a></dt>
<dd><p>Top Function to perform on-the-fly mixing and then interpolating of 5 opacity sources from Amundsen et al. (2017)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="picaso.optics.RetrieveCKs.mix_my_opacities_gasesfly">
<span class="sig-name descname"><span class="pre">mix_my_opacities_gasesfly</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atmosphere</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude_mol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.RetrieveCKs.mix_my_opacities_gasesfly" title="Link to this definition"></a></dt>
<dd><p>Top Function to perform on-the-fly mixing and then interpolating of 5 opacity sources from Amundsen et al. (2017)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="picaso.optics.RetrieveCKs.open_local">
<span class="sig-name descname"><span class="pre">open_local</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.RetrieveCKs.open_local" title="Link to this definition"></a></dt>
<dd><p>Code needed to open up local database, interpret arrays from bytes and return cursor</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="picaso.optics.RetrieveCKs.run_cia_spline_661_deprecate">
<span class="sig-name descname"><span class="pre">run_cia_spline_661_deprecate</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.RetrieveCKs.run_cia_spline_661_deprecate" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="picaso.optics.RetrieveCKs.run_cia_spline_deprecate">
<span class="sig-name descname"><span class="pre">run_cia_spline_deprecate</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.RetrieveCKs.run_cia_spline_deprecate" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="picaso.optics.RetrieveOpacities">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">picaso.optics.</span></span><span class="sig-name descname"><span class="pre">RetrieveOpacities</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">db_filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">raman_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wave_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">location</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'local'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resample</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">query_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'nearest'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.RetrieveOpacities" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>This will be the class that will retrieve the opacities from the sqlite3 database. Right
now we are just employing nearest neighbors to grab the respective opacities.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>db_filename</strong> (<em>str</em>)  Opacity file name</p></li>
<li><p><strong>raman_data</strong> (<em>str</em>)  file name of the raman cross section data</p></li>
<li><p><strong>wave_range</strong> (<em>list</em><em> of </em><em>float</em>)  Wavelength range (in microns) to run.
Default None grabs all the full wavelength range available</p></li>
<li><p><strong>location</strong> (<em>str</em>)  Default = local. This is the only option currently available since
we dont have AWS or other services enabled.</p></li>
<li><p><strong>resample</strong> (<em>int</em>)  Default =1 (no resampling)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="picaso.optics.RetrieveOpacities.raman_db">
<span class="sig-name descname"><span class="pre">raman_db</span></span><a class="headerlink" href="#picaso.optics.RetrieveOpacities.raman_db" title="Link to this definition"></a></dt>
<dd><p>Database of Raman cross sections</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="picaso.optics.RetrieveOpacities.wno">
<span class="sig-name descname"><span class="pre">wno</span></span><a class="headerlink" href="#picaso.optics.RetrieveOpacities.wno" title="Link to this definition"></a></dt>
<dd><p>Wavenumber grid from opacity database (CGS cm-1)</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="picaso.optics.RetrieveOpacities.wave">
<span class="sig-name descname"><span class="pre">wave</span></span><a class="headerlink" href="#picaso.optics.RetrieveOpacities.wave" title="Link to this definition"></a></dt>
<dd><p>Wavelength grid from opacity database (micron)</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="picaso.optics.RetrieveOpacities.nwno">
<span class="sig-name descname"><span class="pre">nwno</span></span><a class="headerlink" href="#picaso.optics.RetrieveOpacities.nwno" title="Link to this definition"></a></dt>
<dd><p>Number of wavenumber points in the grid</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="picaso.optics.RetrieveOpacities.cia_temps">
<span class="sig-name descname"><span class="pre">cia_temps</span></span><a class="headerlink" href="#picaso.optics.RetrieveOpacities.cia_temps" title="Link to this definition"></a></dt>
<dd><p>CIA temps available from database</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="picaso.optics.RetrieveOpacities.molecules">
<span class="sig-name descname"><span class="pre">molecules</span></span><a class="headerlink" href="#picaso.optics.RetrieveOpacities.molecules" title="Link to this definition"></a></dt>
<dd><p>Molecules availalbe from database</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="picaso.optics.RetrieveOpacities.pt_pairs">
<span class="sig-name descname"><span class="pre">pt_pairs</span></span><a class="headerlink" href="#picaso.optics.RetrieveOpacities.pt_pairs" title="Link to this definition"></a></dt>
<dd><p>pressure-temperature pairs available from grid (our grid is usually
computed on a fixed 1060 PT grid)</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="picaso.optics.RetrieveOpacities.molecular_opa">
<span class="sig-name descname"><span class="pre">molecular_opa</span></span><a class="headerlink" href="#picaso.optics.RetrieveOpacities.molecular_opa" title="Link to this definition"></a></dt>
<dd><p>Molecular Opacity dictionary that contains all the queried information necessary
to do calculation</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="picaso.optics.RetrieveOpacities.continuum_opa">
<span class="sig-name descname"><span class="pre">continuum_opa</span></span><a class="headerlink" href="#picaso.optics.RetrieveOpacities.continuum_opa" title="Link to this definition"></a></dt>
<dd><p>Continuum opacity dictionary that contains all the queried information
necessary for the calculation</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="picaso.optics.RetrieveOpacities.rayleigh_opa">
<span class="sig-name descname"><span class="pre">rayleigh_opa</span></span><a class="headerlink" href="#picaso.optics.RetrieveOpacities.rayleigh_opa" title="Link to this definition"></a></dt>
<dd><p>Rayleigh opacity dictionary for all the sources we have. This is computed as
cm^2/species when the users runs <cite>opannection</cite>. We technically could just
store this in the DB as well. However, because its so fast, it doesnt take
a lot of time, and because its non-temperature dependent, we only have to do
it once.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="picaso.optics.RetrieveOpacities.query_method">
<span class="sig-name descname"><span class="pre">query_method</span></span><a class="headerlink" href="#picaso.optics.RetrieveOpacities.query_method" title="Link to this definition"></a></dt>
<dd><p>Default = nearest can also choose linear for interpolation</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="picaso.optics.RetrieveOpacities.db_connect">
<span class="sig-name descname"><span class="pre">db_connect</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.RetrieveOpacities.db_connect" title="Link to this definition"></a></dt>
<dd><p>Inherents functionality of <cite>open_local</cite>. Eventually it will
inherent functionality of open_non_locals (e.g. cloud or other sources)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="picaso.optics.RetrieveOpacities.open_local">
<span class="sig-name descname"><span class="pre">open_local</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.RetrieveOpacities.open_local" title="Link to this definition"></a></dt>
<dd><p>Opens sqlite3 connection and enables array interpretation from bytes</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="picaso.optics.RetrieveOpacities.get_available_data">
<span class="sig-name descname"><span class="pre">get_available_data</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.RetrieveOpacities.get_available_data" title="Link to this definition"></a></dt>
<dd><p>Gets opacity database attributes such as available T-Ps , availalbe molecules. etc.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="picaso.optics.RetrieveOpacities.get_available_rayleigh">
<span class="sig-name descname"><span class="pre">get_available_rayleigh</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.RetrieveOpacities.get_available_rayleigh" title="Link to this definition"></a></dt>
<dd><p>Gets rayleigh cross sections when opannection is opened.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="picaso.optics.RetrieveOpacities.get_opacities">
<span class="sig-name descname"><span class="pre">get_opacities</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.RetrieveOpacities.get_opacities" title="Link to this definition"></a></dt>
<dd><p>Gets opacities after user specifies atmospheric profile (e.g. full PT and Composition)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="picaso.optics.RetrieveOpacities.adapt_array">
<span class="sig-name descname"><span class="pre">adapt_array</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.RetrieveOpacities.adapt_array" title="Link to this definition"></a></dt>
<dd><p>needed to interpret bytes to array</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="picaso.optics.RetrieveOpacities.compute_stellar_shits">
<span class="sig-name descname"><span class="pre">compute_stellar_shits</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wno_star</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flux_star</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.RetrieveOpacities.compute_stellar_shits" title="Link to this definition"></a></dt>
<dd><p>Takes the hires stellar spectrum and computes Raman shifts</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wno_star</strong> (<em>array</em>)  hires wavelength grid of the star in wave number</p></li>
<li><p><strong>flux_star</strong> (<em>array</em>)  Flux of the star in whatever units. Doesnt matter for this since its returning a ratio</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>array of the shifted stellar spec divided by the unshifted stellar spec on the model wave
number grid</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>matrix</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="picaso.optics.RetrieveOpacities.convert_array">
<span class="sig-name descname"><span class="pre">convert_array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.RetrieveOpacities.convert_array" title="Link to this definition"></a></dt>
<dd><p>needed to interpret bytes to array</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="picaso.optics.RetrieveOpacities.find_needed_pts">
<span class="sig-name descname"><span class="pre">find_needed_pts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tlayer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">player</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.RetrieveOpacities.find_needed_pts" title="Link to this definition"></a></dt>
<dd><p>Function to identify the PT pairs needed given a set of temperature and pressures.
When the opacity connection is established the PT pairs are read in and added to the
class.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id20">
<span class="sig-name descname"><span class="pre">get_available_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wave_range</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resample</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#id20" title="Link to this definition"></a></dt>
<dd><p>Get the pressures and temperatures that are available for the continuum and molecules</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id21">
<span class="sig-name descname"><span class="pre">get_available_rayleigh</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#id21" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id22">
<span class="sig-name descname"><span class="pre">get_opacities</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atmosphere</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude_mol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#id22" title="Link to this definition"></a></dt>
<dd><p>Gets opacities using the atmosphere class using interpolation for molecular, but not
continuum. Continuum opacity is grabbed via nearest neighbor methodology.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="picaso.optics.RetrieveOpacities.get_opacities_nearest">
<span class="sig-name descname"><span class="pre">get_opacities_nearest</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atmosphere</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude_mol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.RetrieveOpacities.get_opacities_nearest" title="Link to this definition"></a></dt>
<dd><p>Gets opacities using the atmosphere class</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id23">
<span class="sig-name descname"><span class="pre">open_local</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#id23" title="Link to this definition"></a></dt>
<dd><p>Code needed to open up local database, interpret arrays from bytes and return cursor</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="picaso.optics.RetrieveOpacities.preload_opacities">
<span class="sig-name descname"><span class="pre">preload_opacities</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecules</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_range</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_range</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.RetrieveOpacities.preload_opacities" title="Link to this definition"></a></dt>
<dd><p>Function that pre-loads opacities for certain molecules and p-t range</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>molecules</strong> (<em>list</em>)  list of molecule names</p></li>
<li><p><strong>p_range</strong> (<em>list</em>)  list of floats in bars e.g [1e-2,1]</p></li>
<li><p><strong>t_range</strong> (<em>list</em>)  List of floats in kelvin e.g [300,1000]</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.optics.adapt_array">
<span class="sig-prename descclassname"><span class="pre">picaso.optics.</span></span><span class="sig-name descname"><span class="pre">adapt_array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.adapt_array" title="Link to this definition"></a></dt>
<dd><p>needed to interpret bytes to array</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.optics.bin_star">
<span class="sig-prename descclassname"><span class="pre">picaso.optics.</span></span><span class="sig-name descname"><span class="pre">bin_star</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wno_new</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wno_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Fp</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.bin_star" title="Link to this definition"></a></dt>
<dd><p>Takes average of group of points using uniform tophat</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wno_new</strong> (<em>numpy.array</em>)  inverse cm grid to bin to (cm-1)</p></li>
<li><p><strong>wno_old</strong> (<em>numpy.array</em>)  inverse cm grid (old grid)</p></li>
<li><p><strong>Fp</strong> (<em>numpy.array</em>)  transmission spectra, which is on wno grid</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.optics.compute_opacity">
<span class="sig-prename descclassname"><span class="pre">picaso.optics.</span></span><span class="sig-name descname"><span class="pre">compute_opacity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atmosphere</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opacityclass</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ngauss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stream</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta_eddington</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">raman</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_opacity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">full_output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fthin_cld</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_holes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.compute_opacity" title="Link to this definition"></a></dt>
<dd><p>Returns total optical depth per slab layer including molecular opacity, continuum opacity.
It should automatically select the molecules needed</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atmosphere</strong> (<em>class ATMSETUP</em>)  This inherets the class from atmsetup.py</p></li>
<li><p><strong>opacityclass</strong> (<em>class opacity</em>)  This inherets the class from optics.py. It is done this way so that the opacity db doesnt have
to be reloaded in a retrieval</p></li>
<li><p><strong>ngauss</strong> (<em>int</em>)  Number of gauss angles if using correlated-k. If using monochromatic opacites,
ngauss should one.</p></li>
<li><p><strong>stream</strong> (<em>int</em>)  Number of streams (only affects detal eddington approximation)</p></li>
<li><p><strong>delta_eddington</strong> (<em>bool</em>)  (Optional) Default=True, With Delta-eddington on, it incorporates the forward peak
contribution by adjusting optical properties such that the fraction of scattered energy
in the forward direction is removed from the scattering parameters</p></li>
<li><p><strong>raman</strong> (<em>int</em>)  (Optional) Default =0 which corresponds to oklopcic+2018 raman scattering cross sections.
Other options include 1 for original pollack approximation for a 6000K blackbody.
And 2 for nothing.</p></li>
<li><p><strong>test_mode</strong> (<em>bool</em>)  (Optional) Default = False to run as normal. This will overwrite the opacities and fix the
delta tau at 0.5.</p></li>
<li><p><strong>full_output</strong> (<em>bool</em>)  (Optional) Default = False. If true, This will add taugas, taucld, tauray to the atmosphere class.
This is done so that the users can debug, plot, etc.</p></li>
<li><p><strong>plot_opacity</strong> (<em>bool</em>)  (Optional) Default = False. If true, Will create a pop up plot of the weighted of each absorber
at the middle layer</p></li>
<li><p><strong>return_mode</strong> (<em>bool</em>)  (Optional) Default = False, If true, will only return matrices for all the weighted opacity
contributions</p></li>
<li><p><strong>do_holes</strong> (<em>bool</em>)  (Optional) Default = False, If true, will calculate clearsky</p></li>
<li><p><strong>fthin_cld</strong> (<em>float</em>)  Fraction of thin clouds in patchy cloud column (from 0 to 1.0), default 0 for clear sky column</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>DTAU</strong> (<em>ndarray</em>)  This is a matrix with # layer by # wavelength. It is the opacity contained within a layer
including the continuum, scattering, cloud (if specified), and molecular opacity
<strong>If requested, this is corrected for with Delta-Eddington.</strong></p></li>
<li><p><strong>TAU</strong> (<em>ndarray</em>)  This is a matrix with # level by # wavelength. It is the cumsum of opacity contained
including the continuum, scattering, cloud (if specified), and molecular opacity
<strong>If requested, this is corrected for with Delta-Eddington.</strong></p></li>
<li><p><strong>WBAR</strong> (<em>ndarray</em>)  This is the single scattering albedo that includes rayleigh, raman and user input scattering sources.
It has dimensions: # layer by # wavelength
<strong>If requested, this is corrected for with Delta-Eddington.</strong></p></li>
<li><p><strong>COSB</strong> (<em>ndarray</em>)  This is the asymettry factor which accounts for rayleigh and user specified values
It has dimensions: # layer by # wavelength
<strong>If requested, this is corrected for with Delta-Eddington.</strong></p></li>
<li><p><strong>ftau_cld</strong> (<em>ndarray</em>)  This is the fraction of cloud opacity relative to the total TAUCLD/(TAUCLD + TAURAY)</p></li>
<li><p><strong>ftau_ray</strong> (<em>ndarray</em>)  This is the fraction of rayleigh opacity relative to the total TAURAY/(TAUCLD + TAURAY)</p></li>
<li><p><strong>GCOS2</strong> (<em>ndarray</em>)  This is used for Cahoy+2010 methodology for accounting for rayleigh scattering. It
replaces the use of the actual rayleigh phase function by just multiplying ftau_ray by 2</p></li>
<li><p><strong>DTAU</strong> (<em>ndarray</em>)  This is a matrix with # layer by # wavelength. It is the opacity contained within a layer
including the continuum, scattering, cloud (if specified), and molecular opacity
<strong>If requested, this is corrected for with Delta-Eddington.</strong></p></li>
<li><p><strong>TAU</strong> (<em>ndarray</em>)  This is a matrix with # level by # wavelength. It is the cumsum of opacity contained
including the continuum, scattering, cloud (if specified), and molecular opacity
<strong>Original, never corrected for with Delta-Eddington.</strong></p></li>
<li><p><strong>WBAR</strong> (<em>ndarray</em>)  This is the single scattering albedo that includes rayleigh, raman and user input scattering sources.
It has dimensions: # layer by # wavelength
<strong>Original, never corrected for with Delta-Eddington.</strong></p></li>
<li><p><strong>COSB</strong> (<em>ndarray</em>)  This is the asymettry factor which accounts for rayleigh and user specified values
It has dimensions: # layer by # wavelength
<strong>Original, never corrected for with Delta-Eddington.</strong></p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This was baselined against jupiter with the old fortran code. It matches 100% for all cases
except for hotter cases where Na &amp; K are present. This differences is not a product of the code
but a product of the different opacities (1060 grid versus old 736 grid)</p>
<div class="admonition-todo admonition" id="id24">
<p class="admonition-title">Todo</p>
<p>Add a better approximation than delta-scale (e.g. M.Marley suggests a paper by Cuzzi that has
a better methodology)</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.optics.compute_raman">
<span class="sig-prename descclassname"><span class="pre">picaso.optics.</span></span><span class="sig-name descname"><span class="pre">compute_raman</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nwno</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nlayer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wno</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stellar_shifts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tlayer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cross_sections</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j_initial</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deltanu</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.compute_raman" title="Link to this definition"></a></dt>
<dd><p>The Ramam scattering will alter the rayleigh scattering. The returned value is
modified single scattering albedo.
Cross sectiosn from:
<a class="reference external" href="http://iopscience.iop.org/0004-637X/832/1/30/suppdata/apjaa3ec7t2_mrt.txt">http://iopscience.iop.org/0004-637X/832/1/30/suppdata/apjaa3ec7t2_mrt.txt</a>
This method is described in Pollack+1986. Albeit not the best method. Sromovsky+2005
pointed out the inconsistencies in this method. You can see from his comparisons
that the Pollack approximations dont accurately capture the depths of the line centers.
Since then, OKLOPCIC+2016 recomputed cross sections for J&lt;=9. We are using those cross
sections here with a different star. Huge improvement over what we had before.
Number of J levels is hard coded to 10 !
Will be added to the rayleigh scattering as : TAURAY*RAMAN
:param nwno: Number of wave points
:type nwno: int
:param nlayer: Number of layers
:type nlayer: int
:param wno: Array of output grid of wavenumbers
:type wno: array
:param stellar_shifts: Array of floats that has dimensions (n wave pts x n J levels: 0-9)
:type stellar_shifts: ndarray
:param tlayer: Array of floats that has dimensions nlayer
:type tlayer: array
:param cross_sections: The row of Cs from Antonijas table.
:type cross_sections: ndarray
:param j_initial: The row of initial rotational energy states from Antonijas table
:type j_initial: ndarray
:param deltanu: The row of delta nus from Antonias table
:type deltanu: ndarray</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.optics.convert_array">
<span class="sig-prename descclassname"><span class="pre">picaso.optics.</span></span><span class="sig-name descname"><span class="pre">convert_array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">clas</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">text</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.convert_array" title="Link to this definition"></a></dt>
<dd><p>needed to interpret bytes to array</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.optics.find_nearest">
<span class="sig-prename descclassname"><span class="pre">picaso.optics.</span></span><span class="sig-name descname"><span class="pre">find_nearest</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.find_nearest" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.optics.interp_matrix">
<span class="sig-prename descclassname"><span class="pre">picaso.optics.</span></span><span class="sig-name descname"><span class="pre">interp_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_interp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_interp</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.interp_matrix" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.optics.j_fraction">
<span class="sig-prename descclassname"><span class="pre">picaso.optics.</span></span><span class="sig-name descname"><span class="pre">j_fraction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">j</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.j_fraction" title="Link to this definition"></a></dt>
<dd><p>This computes the fraction of molecules at each J level.
:param j: The initial rotational levels ranging from J=0 to 9 for hydrogen only
:type j: int</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>f_J in eqn. 3 https</strong></p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>//arxiv.org/pdf/1605.07185.pdf</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.optics.numba_cumsum">
<span class="sig-prename descclassname"><span class="pre">picaso.optics.</span></span><span class="sig-name descname"><span class="pre">numba_cumsum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mat</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.numba_cumsum" title="Link to this definition"></a></dt>
<dd><p>Function to compute cumsum along axis=0 to bypass numba not allowing kwargs in
cumsum</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.optics.partition_function">
<span class="sig-prename descclassname"><span class="pre">picaso.optics.</span></span><span class="sig-name descname"><span class="pre">partition_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">j</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.partition_function" title="Link to this definition"></a></dt>
<dd><p>Given j and T computes partition function for ro-vibrational levels of H2.
This is the exponential and the statistical weight g_J in
Eqn 3 in <a class="reference external" href="https://arxiv.org/pdf/1605.07185.pdf">https://arxiv.org/pdf/1605.07185.pdf</a>
It is also used to compute the partition sum Z.
:param j: Energy level
:type j: int
:param T: Temperature at each atmospheric layer in the atmosphere
:type T: array float</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Returns partition function</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.optics.partition_sum">
<span class="sig-prename descclassname"><span class="pre">picaso.optics.</span></span><span class="sig-name descname"><span class="pre">partition_sum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">T</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.partition_sum" title="Link to this definition"></a></dt>
<dd><p>This is the total partition sum. I am truncating it at 20 since it seems to approach 1 around then.
This is also pretty fast to compute so 20 is fine for now.
:param T: Array of temperatures for each layer
:type T: array</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Z, the partition sum</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.optics.raman_pollack">
<span class="sig-prename descclassname"><span class="pre">picaso.optics.</span></span><span class="sig-name descname"><span class="pre">raman_pollack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nlayer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wave</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.raman_pollack" title="Link to this definition"></a></dt>
<dd><p>Mystery raman scattering. Couldnt figure out where it came from.. so discontinuing.
Currently function doesnt totally work. In half fortran-half python. Legacy from
fortran albedo code.
This method is described in Pollack+1986. Albeit not the best method. Sromovsky+2005
pointed out the inconsistencies in this method. You can see from his comparisons
that the Pollack approximations dont accurately capture the depths of the line centers.
Since then, OKLOPCIC+2016 did a much
better model of raman scattring (with ghost lines). Might be worth it to consider a more
sophisticated version of Raman scattering.
Will be added to the rayleigh scattering as : TAURAY*RAMAN</p>
<p>#OLD FORTRAN CODE
#constants
h = 6.6252e-27
c = 2.9978e10
bohrd = 5.2917e-9
hmass = 1.6734e-24
rmu = .5 * hmass
#set wavelength shift of the ramam scatterer
shift_v0 = 4161.0
facip = h * c / ( 1.e-4 * 27.2 * 1.602e-12 )
facray = 1.e16 * bohrd ** 3 * 128. * np.pi ** 5 * bohrd ** 3 / 9.
facv = 2.08 / 2.38 * facray / bohrd ** 2 / ( 8. * np.pi * np.pi * rmu * c * shift_v0 ) * h
#cross section of the unshifted rayleigh and the vibrationally shifted rayleigh
gli = np.zeros(5)
wli = np.zeros(5)
gri = np.zeros(5)
wri = np.zeros(5)
gli[:] = [1.296, .247, .297,  .157,  .003]
wli[:] = [.507, .628, .733, 1.175, 2.526]
gri[:] = [.913, .239, .440,  .344,  .064]
wri[:] = [.537, .639, .789, 1.304, 3.263]
alp = np.zeros(7)
arp = np.zeros(7)
alp[:] = [6.84, 6.96, 7.33, 8.02, 9.18, 11.1, 14.5 ]
arp[:] = [3.66, 3.71, 3.88, 4.19, 4.70, 5.52, 6.88 ]
omega = facip / wavelength
#first compute extinction cross section for unshifted component
#e.g. rayleigh
alpha_l=0
alpha_r=0
for i in range(5):</p>
<blockquote>
<div><p>alpha_l += gli[i] / ( wli[i] ** 2 - omega ** 2 )
alpha_r += gri[i] / ( wri[i] ** 2 - omega ** 2 )</p>
</div></blockquote>
<p>alpha2 = (( 2. * alpha_r + alpha_l ) / 3. ) ** 2
gamma2 = ( alpha_l - alpha_r ) ** 2
qray = facray * ( 3. * alpha2 + 2./3. * gamma2 ) / wavelength ** 4
#next, compute the extinction cross section for vibrationally
#shifted component
ip = np.zeros(2)
ip[:] = [int(omega/0.05), 5.0]
ip = np.min(ip) + 1
f = omega / 0.05 - float(ip-1)
alpha_pl = ( 1. - f ) * alp[ip] + f * alp[ip+1]
alpha_pr = ( 1. - f ) * arp[ip] + f * arp[ip+1]
alpha_p2 = (( 2. * alpha_pr + alpha_pl ) / 3. ) ** 2
gamma_p2 = ( alpha_pl - alpha_pr ) ** 2
qv = facv / SHIFT( WAVEL, -SHIFTV0 ) ** 4 * ( 3. * alpha_p2 + 2./3. * gamma_p2 )</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.optics.rayleigh_old">
<span class="sig-prename descclassname"><span class="pre">picaso.optics.</span></span><span class="sig-name descname"><span class="pre">rayleigh_old</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">colden</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gasmixing</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wave</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xmu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amu</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.rayleigh_old" title="Link to this definition"></a></dt>
<dd><p>DISCONTINUED
Rayleigh function taken from old albedo code. Keeping this modular, as we may want
to swap out different methods to calculate rayleigh opacity
:param colden: Column Density in CGS units
:type colden: array of float
:param mixingratios: Mixing ratio as function of altitude for [H2  He CH4 ]
:type mixingratios: array of float
:param wave: wavelength (microns) of grid. This should be in DECENDING order to comply with</p>
<blockquote>
<div><p>everything else being in wave numberes</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xmu</strong> (<em>array</em><em> of </em><em>float</em>)  mean molecular weight of atmosphere in amu</p></li>
<li><p><strong>amu</strong> (<em>float</em>)  amu constant in grams</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.optics.spline">
<span class="sig-prename descclassname"><span class="pre">picaso.optics.</span></span><span class="sig-name descname"><span class="pre">spline</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yp0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ypn</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.spline" title="Link to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="picaso-test-module">
<h2>picaso.test module<a class="headerlink" href="#picaso-test-module" title="Link to this heading"></a></h2>
</section>
<section id="module-picaso.wavelength">
<span id="picaso-wavelength-module"></span><h2>picaso.wavelength module<a class="headerlink" href="#module-picaso.wavelength" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="picaso.wavelength.get_cld_input_grid">
<span class="sig-prename descclassname"><span class="pre">picaso.wavelength.</span></span><span class="sig-name descname"><span class="pre">get_cld_input_grid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename_or_grid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'wave_EGP.dat'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid661</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.wavelength.get_cld_input_grid" title="Link to this definition"></a></dt>
<dd><p>The albedo code relies on the cloud code input, which is traditionally on a 196 wavelength grid.
This method is to retrieve that grid. This file should be kept in the package reference data. Alternatively,
it might be useful to add it directly to the input.cld file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>filename_or_grid</strong> (<em>str</em><em> or </em><em>ndarray</em>)  filename of the input grid OR a numpy array of wavenumber corresponding to cloud
input</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>array of wave numbers in increasing order</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="picaso.wavelength.regrid">
<span class="sig-prename descclassname"><span class="pre">picaso.wavelength.</span></span><span class="sig-name descname"><span class="pre">regrid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">old_wno</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_wno</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.wavelength.regrid" title="Link to this definition"></a></dt>
<dd><p>This takes in a matrix that is (number of something versus number of wavelength points) and regrids
to a new wave grid.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>matrix</strong> (<em>ndarray</em>)  matrix that is (number of something versus number of wavelength points)</p></li>
<li><p><strong>old_wno</strong> (<em>array</em>)  array that represents the old wavelength grid of the matrix</p></li>
<li><p><strong>new_wno</strong> (<em>array</em>)  array that represents the desired wavelength grid</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>matrix that has been reinterpolated to new wave number grid</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>matrix</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-picaso">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-picaso" title="Link to this heading"></a></h2>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="notebooks/References.html" class="btn btn-neutral float-left" title="What do I reference?" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="contribution.html" class="btn btn-neutral float-right" title="Contributing to PICASO" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright .</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>